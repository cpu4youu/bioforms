import{s as n,S,R as C,_ as T,u as L,r as y,j as e,Q as l}from"./index-0a7d9506.js";import{u as P}from"./index-8941c2d9.js";import{u as z,s as $}from"./index-a273f995.js";import{u as M,e as I}from"./index-707dbcd4.js";import{s as d}from"./sleep-da79c358.js";import{o as m}from"./fighters-query-0c9e1245.js";import{m as A}from"./markers-21ad5773.js";import{u as D}from"./use-transaction-9d0d6f50.js";import"./useQuery-9ccc590b.js";import"./toast-options-feb3eaf9.js";const R=n("div",{display:"flex",h:"175px",w:"100%",maxW:"375px",gap:"5px",padding:"5px",position:"relative",">img":{zIndex:"1",position:"absolute",top:"0",left:"0",w:"100%",h:"100%"}}),E=n("div",{display:"flex",gap:"5px",zIndex:"2"}),W=n("div",{display:"flex",bg:"#282828",br:"3px 3px 5px",w:"12px",h:"100%",div:{display:"flex",br:"3px 3px 5px",w:"100%",mt:"auto",background:"green"}}),B=n("div",{w:"55px",h:"157px",overflow:"hidden",br:"10px",img:{w:"55px",h:"157px",objectPosition:"top",objectFit:"cover"}}),U=n("div",{display:"flex",direction:"column",zIndex:"2",w:"210px",br:"3px",bg:"rgba(0, 0, 0, 0.3)",padding:"10px",p:{ff:"$heading",fs:"10px",textShadow:"1px 1px 3px #000",color:"white",">span":{color:"#FFB800"}}}),N=n("div",{display:"flex",alignItems:"center",gap:"2px",color:"white",textShadow:"1px 1px 3px #000",textTransform:"capitalize",fs:"16px",">img":{w:"17px",h:"17px",objectFit:"cover",objectPosition:"center","-webkit-filter":"drop-shadow(0px 0px 4px #000)",filter:"drop-shadow(0px 0px 4px #000)"}}),Q=n("div",{display:"flex",gap:"15px",mb:"3px",color:"white",fs:"10px",textShadow:"1px 1px 3px #000"}),q=n("div",{display:"flex",flexDirection:"column",mt:"7px"}),H=n("div",{display:"flex",justifyContent:"space-between",color:"white",textTransform:"capitalize",textShadow:"1px 1px 3px #000",fs:"10px",">strong":{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"," >img":{w:"12px",h:"12px",objectFit:"cover"}}}),O=n("div",{display:"grid",gridTemplateRows:"40px 40px auto",w:"70px",gap:"5px",zIndex:"2",">button":{borderWidth:"1px",br:"5px",color:"white",fs:"10px",padding:"0px 5px"}}),V=n("div",{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap",margin:"auto auto 10px auto",maxW:"55px",maxH:"33px",button:{zIndex:"2",w:"17px",h:"17px"},img:{w:"17px",h:"17px",objectFit:"cover",objectPosition:"center","-webkit-filter":"drop-shadow(0px 0px 4px #000)",filter:"drop-shadow(0px 0px 4px #000)"}});async function b(s,a){const{executeTransaction:c}=D(),o=X(s,a);return!!await c(o)}function X(s,{marker:a,fighter_id:c}){return{actions:[{account:S.battleAle,name:"setmarker",authorization:[{actor:s.name,permission:s.authorization.permission}],data:{wallet:s.name,fighter_id:c,marker:a}}]}}const v=C.lazy(()=>T(()=>import("./index-38328d25.js"),["assets/index-38328d25.js","assets/index-0a7d9506.js","assets/index-55fec1ff.css"])),re=({fighter:s})=>{const a=s.stats,{setSelectedFighter:c}=P(),{data:o}=M(),{data:p}=z(),i=L(t=>t.user),[u,h]=y.useState(!1),[g,f]=y.useState(!1);async function _(){const t=o==null?void 0:o.find(r=>r.level===s.stats.level);try{if(h(!0),!t){l.error("No level find on levels table");return}if(!await I(i,{cost_credits:t==null?void 0:t.unlock_cost_credits,cost_gems:t==null?void 0:t.unlock_cost_gem,fighter_ids:[s.fighter_id]}))return;await d(2e3),m(i.name),l.success("Fighter leveled up!")}catch(r){console.error(r)}finally{h(!1)}}async function j(t){try{if(f(!0),t==="cancel"){if(!await b(i,{marker:"",fighter_id:s.fighter_id}))return;await d(2e3),m(i.name),l.success("Fighter marker removed!");return}if(!await b(i,{marker:t,fighter_id:s.fighter_id}))return;await d(2e3),m(i.name),l.success("Fighter marked!")}catch(r){console.error(r)}finally{f(!1)}}const k=Math.floor((Date.now()-new Date(s.creation_date).getTime())/(1e3*60*60*24)),F=((p==null?void 0:p.age_penaly_percent_day)??0)/100||0,w=Math.floor(k*F);return e.jsxs(R,{onClick:()=>c({...s,...s.stats,agePenalty:w}),children:[e.jsxs(E,{children:[e.jsx(W,{children:e.jsx("div",{style:{height:"100%"}})}),e.jsx(B,{children:e.jsx("img",{src:`/assets/fighter/full_${s.racename}_${s.classname}_${s.element}.jpeg`,alt:"",loading:"lazy"})})]}),e.jsxs(U,{children:[e.jsxs(N,{children:[s.racename," ",s.classname,e.jsx("img",{src:`/assets/markers/${s.marker}.png`,alt:s.marker})]}),e.jsxs(Q,{children:[e.jsxs("span",{children:["Level: ",a.level]}),e.jsxs("span",{children:["XP: ",s.stats.experience,"/",s.stats.required_experience]})]}),e.jsxs("p",{children:["Element: ",s.element]}),e.jsxs("p",{children:["Age Penalty: ",e.jsxs("span",{children:["-",w,"%"]})]}),e.jsx(q,{children:$.map(t=>{const r=(a==null?void 0:a[`${t}_min`])??0,x=(a==null?void 0:a[`${t}_max`])??0;return e.jsxs(H,{children:[e.jsxs("strong",{children:[e.jsx("img",{src:`/assets/icons/stats/${t}.png`,alt:t}),t]}),e.jsx("span",{children:e.jsxs("span",{children:[e.jsxs("span",{children:[Math.floor((r+x)/2)," "]}),e.jsxs("span",{children:[" (+-",Math.floor(Math.abs(x-r)/2),")"]})]})})]},t)})})]}),e.jsxs(O,{children:[e.jsx(v,{isLoading:u,disabled:u||s.stats.experience<s.stats.required_experience,onClick:_,children:"Level up"}),e.jsx(v,{children:"Pay"}),e.jsxs(V,{children:[A.map(t=>e.jsx("button",{disabled:g,onClick:()=>j(t),children:e.jsx("img",{src:`/assets/markers/${t}.png`,alt:t})},t)),e.jsx("button",{disabled:g,onClick:()=>j("cancel"),children:e.jsx("img",{src:"/assets/markers/cancel.png",alt:"cancel"})})]})]}),e.jsx("img",{src:`/assets/elements/${s.element}.jpeg`,alt:""})]})};export{re as default};
