import{s as r,k as we,M as be,S as y,T as le,Q as ce,u as $,i as _e,R as pe,_ as Ce,r as m,j as e,a as se}from"./index-af7d07b8.js";import{u as Ae}from"./index-ef3437d2.js";import{u as Te}from"./inventory-query-17aee9fd.js";import{u as xe}from"./useQuery-12f917d1.js";import{u as de}from"./use-transaction-d76458d1.js";import{s as Le}from"./sleep-da79c358.js";import"./constants-06470205.js";import"./atomic-api-ee4b80bb.js";import"./toast-options-e4b151ee.js";const ze=r("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",w:"100%"}),Fe=r("div",{d:"flex",align:"flex-end",justify:"flex-end",gap:"10px",position:"relative",w:"100%",button:{d:"flex",align:"center",justify:"center",maxW:"188px",h:"70px",svg:{fill:"#00BAFF"},span:{d:"flex",align:"center",justify:"center",gap:"5px",color:"#828282"},img:{maxW:"35px",maxH:"30px"}},"@sm":{button:{justify:"center",gap:"2px",padding:"0",maxW:"33%",h:"45px",fs:"12px",span:{gap:"0px"},svg:{display:"none"}}}}),Ie=r("div",{d:"flex",align:"flex-start",justify:"center",gap:"10px",w:"100%",">img":{mt:"10px",h:"calc(100vh - 160px)",br:"15px"}}),Re=r("div",{d:"grid",gridTemplateAreas:`
    "title title title"
    "objectivesLeft content objectivesRight"
    "objectivesLeft inventory objectivesRight"
    "objectivesLeft inventory objectivesRight"
    "objectivesLeft inventory objectivesRight"
  `,gridTemplateColumns:"1fr 5fr 1fr",gap:"20px",mt:"10px",padding:"15px 10px",bg:"#141423",br:"15px",w:"100%",minH:"calc(100vh - 160px)","@sm":{gridTemplateAreas:`
    "title title title"
    "content content content"
    "objectivesLeft objectivesLeft objectivesLeft"
    "objectivesRight objectivesRight objectivesRight"
    "inventory inventory inventory"
  `},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),ke=r("h2",{gridArea:"title",w:"100%",textAlign:"center",textTransform:"capitalize",fs:"24px",color:"#fff"}),ae=r("div",{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"5px",mb:"auto",w:"100%","&.left":{gridArea:"objectivesLeft"},"&.right":{gridArea:"objectivesRight"},"@sm":{flexDirection:"row"}}),ie=r("div",{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",w:"100%",maxW:"82px",h:"85px",padding:"5px 0px 0px",bg:"#358CAC",br:"3px",span:{color:"#fff",ff:"$heading",fs:"12px","&:first-child":{color:"#07445A",mb:"12px"}},variants:{disabled:{true:{filter:"grayscale(100%)"}}}}),re=r("div",{display:"flex",alignItems:"center",gap:"5px",mt:"auto",padding:"5px 10px",color:"#fff",ff:"$heading",fs:"14px",br:"3px",bg:"#17566D",w:"100%"}),$e=r("div",{gridArea:"content",display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"35px",w:"100%",">img":{w:"135px",h:"195px",br:"10px",objectFit:"cover"},"@sm":{gap:"10px",img:{maxW:"85px"}},"@xsm":{gap:"5px",img:{maxW:"65px"}}}),Se=r("div",{gridArea:"content",img:{"&:hover":{transform:"scale(1.05)",zIndex:"4","-webkit-filter":"drop-shadow(0px 0px 8px #00BAFF)",filter:"drop-shadow(0px 0px 5px #00BAFF)"},"&:nth-of-type(1)":{transform:"translate(30px,20px) rotate(-20deg)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(30px,20px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"translate(-30px,20px) rotate(20deg)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(-30px,20px) rotate(20deg)",zIndex:"4"}},"@sm":{"&:nth-of-type(1)":{transform:"translate(20px,9px) rotate(-20deg)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(20px,9px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"translate(-20px,9px) rotate(20deg)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(-20px,9px) rotate(20deg)",zIndex:"4"}}}},variants:{cardSelected:{0:{img:{"&:nth-of-type(1)":{zIndex:"3"},"&:nth-of-type(2)":{opacity:"0.2"},"&:nth-of-type(3)":{opacity:"0.2"}}},1:{img:{"&:nth-of-type(1)":{opacity:"0.2"},"&:nth-of-type(2)":{},"&:nth-of-type(3)":{opacity:"0.2"}}},2:{img:{"&:nth-of-type(1)":{opacity:"0.2"},"&:nth-of-type(2)":{opacity:"0.2"},"&:nth-of-type(3)":{}}}}}}),C=r("img",{cursor:"pointer",transition:"all 0.2s ease-in-out",w:"120px",h:"170px",zIndex:"2","@lg":{w:"100px",h:"150px"},"@sm":{width:"80px",height:"initial"},"@xsm":{width:"70px",height:"initial"}}),He=r("div",{gridArea:"inventory",display:"flex",direction:"column",w:"100%",span:{ff:"$heading",fs:"16px",fw:"bold",color:"#fff",textAlign:"center"},"@sm":{mt:"0px"}}),De=r("div",{d:"flex",align:"center",justify:"center",gap:"20px",mb:"20px","@sm":{m:"0px 0 20px",gap:"10px"}}),A=r("button",{d:"flex",align:"center",justify:"center",fs:"20px",ff:"$heading",fw:"$bold",color:"$white500",variants:{isSelected:{true:{textUnderlineOffset:"0.5em",textDecoration:"underline"}}},"@sm":{fs:"14px"}}),Ee=r("div",{d:"flex",flexWrap:"wrap",gap:"10px",overflow:"auto",w:"100%",maxH:"calc(100vh - 520px)"}),We=we({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Me=r("div",{w:"120px",h:"170px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.25) ,rgba(255, 255, 255, 0.15))",br:"10px",backgroundSize:"400% 400%",animation:`${We} 1.2s ease-in-out infinite`,"@sm":{width:"70px",height:"100px"}}),Be=r("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",position:"relative",padding:"40px 40px",gap:"10px",w:"50%",mt:"10px",bg:"#141423",br:"15px",minH:"calc(-160px + 100vh)","@lgxx":{w:"30%"},"@md":{w:"50%"},"@sm":{w:"100%"},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),Ne=r("button",{display:"none",align:"flex-start",justify:"center",color:"#fff",fs:"30px",w:"50px",h:"50px",top:"0px",right:"0px",position:"absolute","@sm":{d:"flex"}}),Pe=r("div",{d:"flex",align:"flex-start",justify:"center",gap:"30px",w:"100%"}),Oe=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",position:"relative"}),Qe=r("div",{w:"150px",h:"150px",overflow:"hidden",br:"10px",img:{w:"150px",h:"150px",scale:"4",translate:"0 60px",objectFit:"contain"},"@lgxx":{w:"100px",h:"100px",img:{w:"100px",h:"100px",translate:"0 30px"}}}),Ue=r("div",{d:"flex",align:"center",justify:"center",gap:"10px",w:"40px",h:"40px",br:"50%",bg:"#252525",border:"1px solid #fff",color:"#fff",fontWeight:"bold",ff:"$heading",fs:"20px",zIndex:"1",position:"absolute",top:"-10px",right:"-10px"}),Ve=r("div",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%",bg:"#222222",div:{bg:"#00ff00",h:"10px"}}),qe=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"5px",w:"100%"}),Ge=r("h3",{color:"#fff",textTransform:"capitalize",w:"100%",mb:"5px"}),T=r("span",{color:"#fff",textTransform:"capitalize",ff:"$heading",w:"100%","@lgxx":{fs:"12px"}}),Ke=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",w:"100%",mt:"30px",hr:{my:"30px",h:"3px",w:"100%",bg:"#00BAFF",border:"none"}}),oe=r("div",{d:"flex",align:"center",justify:"space-between",w:"100%",span:{color:"#fff",ff:"$heading",fs:"20px",textAlign:"center",textTransform:"capitalize","&:first-child":{fw:"bold"}},"@lgxx":{span:{fs:"12px"}}}),Ye=async()=>{var j,u;let i=!1,n;const s=[];for(;!i;){const h=await be.get_table_rows({code:y.ADVENTURE_MC,index_position:1,limit:"10000",scope:y.ADVENTURE_MC,table:le.ADV_TEMPLATES,show_payer:!1,json:!0,lower_bound:n});i=!h.more,s.push(...h.rows.slice(0,-1)),n=((u=(j=h.rows)==null?void 0:j[h.rows.length-1])==null?void 0:u.templateid)??""}return s},Je=()=>xe({queryKey:[ce.tavernDataState],queryFn:()=>Xe(),staleTime:1e3*60*60,enabled:!!$.getState().user});async function Xe(){try{const i=await Ye();return i?Ze(i):null}catch(i){return console.log(i),null}}function Ze(i){return i.map(n=>({...n,"nft.mp":n.nft_mp,"tlm.mp":n.tlm_mp}))}const et=async()=>await _e({options:{code:y.tavernAle,index_position:1,limit:"1000",scope:y.tavernAle,table:le.CONFIG}}),tt=()=>xe({queryKey:[ce.tavernConfigState],queryFn:()=>nt(),staleTime:1e3*60*60,enabled:!!$.getState().user});async function nt(){try{const i=await et();return i||null}catch(i){return console.log(i),null}}async function st(i,n){const{executeTransaction:s}=de(),j=at(i,n);return!!await s(j)}function at(i,n){return{actions:[{account:y.tavernAle,name:"reveal",authorization:[{actor:i.name,permission:i.authorization.permission}],data:{wallet:i.name,use_gems:n}}]}}async function it(i){const{executeTransaction:n}=de(),s=rt(i);return!!await n(s)}function rt(i){return{actions:[{account:y.tavernAle,name:"travel",authorization:[{actor:i.name,permission:i.authorization.permission}],data:{wallet:i.name}}]}}const ot=["health","damage","attackspeed","initiative","taunt"],lt=[{value:"res_gem",displayname:"Gem Resistance"},{value:"res_metal",displayname:"Metal Resistance"},{value:"res_air",displayname:"Air Resistance"},{value:"res_fire",displayname:"Fire Resistance"},{value:"res_nature",displayname:"Nature Resistance"},{value:"res_neutral",displayname:"Neutral Resistance"}],k=pe.lazy(()=>Ce(()=>import("./index-38eda442.js"),["assets/index-38eda442.js","assets/index-af7d07b8.js","assets/index-55fec1ff.css"])),ct=()=>{var U,V,q,G,K,Y,J,X,Z,ee,te,ne;const{setAreaSelected:i,areaSelected:n}=Ae(),{user:s,updatePlayerData:j}=$(),[u,h]=m.useState("level.worlds"),[w,b]=m.useState(0),[v,fe]=m.useState({}),[f,S]=m.useState([void 0,void 0,void 0]),[H,D]=m.useState(!1),[E,W]=m.useState(!1),[M,B]=m.useState(!1),[L,ge]=m.useState(!1),{data:z,isLoading:ue}=Te(u),{data:F}=Je(),{data:c}=tt();function he(){i(null)}function me(t){return f.some(a=>(a==null?void 0:a.asset_id)!==t.asset_id)}function I(t){if(t===w){b(-1);return}b(t)}function N(t){if(!t){const l=f.map((o,d)=>{if(d!==w)return o});P(l),b(-1),S(l);return}if(f.some(l=>(l==null?void 0:l.asset_id)===(t==null?void 0:t.asset_id))){b(-1);return}const a=f.map((l,o)=>o===w?t:l);P(a),b(-1),S(a)}function P(t){let a={};t.forEach(l=>{const o=F==null?void 0:F.find(g=>(g==null?void 0:g.templateid)===Number(l==null?void 0:l.template.template_id));if(!o||!(n!=null&&n.objectives))return;const d=n.objectives.reduce((g,x,R)=>{if(x.objective_value!==99999&&x.objective_value===(o==null?void 0:o[x.objective_type])){const _=x==null?void 0:x.mod_value;return g[R]=_,g}if(x.objective_type==="element"&&(x.objective_string.toLocaleLowerCase()===(o==null?void 0:o.element.toLocaleLowerCase())||x.objective_string.toLocaleLowerCase()===(o==null?void 0:o.weaponclass.toLocaleLowerCase()))){const _=x==null?void 0:x.mod_value;return g[R]=_,g}if(x.objective_string!=="-"&&x.objective_string.toLocaleLowerCase()===String(o==null?void 0:o[x.objective_type]).toLocaleLowerCase()){const _=x==null?void 0:x.mod_value;return g[R]=_,g}return g},{});a={...a,...d}}),fe(a)}function O(){var t,a,l,o,d,g;return!c||!s?null:((t=s==null?void 0:s.activestats)==null?void 0:t.gems)>=((a=c==null?void 0:c[0])==null?void 0:a.cost_reveal_gem)?(l=c==null?void 0:c[0])==null?void 0:l.cost_reveal_gem:((o=s==null?void 0:s.activestats)==null?void 0:o.credits)>=((d=c==null?void 0:c[0])==null?void 0:d.cost_reveal_credits)?(g=c==null?void 0:c[0])==null?void 0:g.cost_reveal_credits:null}async function ve(t){if(p){ge(!L);return}if(s){D(!0);try{await st(s,t)&&(await Le(2e3),await j(),se.success("Reveal success"))}catch{}finally{D(!1)}}}async function je(){if(s){W(!0);try{await it(s)&&se.success("Hire success")}catch{}finally{W(!1)}}}function ye(){var a;const t=new Array(10).fill(0).map((l,o)=>o).reduce((l,o,d)=>v[d]?l+=v[d]:l,0);return(((a=c==null?void 0:c[0])==null?void 0:a.cost_hire_ap)||0)-t}const Q=m.useMemo(()=>{var t;return(t=s==null?void 0:s.active_taverns)==null?void 0:t.some(a=>a.x===(n==null?void 0:n.x)&&a.y===(n==null?void 0:n.y))},[s,n]),p=m.useMemo(()=>{var t,a;if(((t=s==null?void 0:s.last_tavern)==null?void 0:t.x)===(n==null?void 0:n.x)&&((a=s==null?void 0:s.last_tavern)==null?void 0:a.y)===(n==null?void 0:n.y))return s==null?void 0:s.last_tavern_fighter},[s,n]);return e.jsxs(ze,{children:[e.jsxs(Fe,{children:[!Q&&e.jsxs(k,{disabled:E,isLoading:E,color:"black",onClick:je,children:["Hire",e.jsxs("span",{children:[ye(),e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]}),e.jsx(k,{color:"black",isLoading:H,onClick:()=>{var t,a;return ve((((t=s==null?void 0:s.activestats)==null?void 0:t.gems)||0)>=(((a=c==null?void 0:c[0])==null?void 0:a.cost_reveal_gem)||0))},disabled:O()===null||H,children:Q||p?"Details":e.jsxs(e.Fragment,{children:["Reveal",e.jsxs("span",{children:[O(),e.jsx("img",{loading:"lazy",src:"/assets/icons/dust.png",alt:""})]})]})}),e.jsx(k,{color:"black",onClick:he,children:"Back"})]}),e.jsxs(Ie,{children:[e.jsxs(Re,{isHidden:M,children:[e.jsx(ke,{children:p?`${p.racename} ${p.classname}`:"Unknown Fighter"}),e.jsx(ae,{className:"left",children:(U=n==null?void 0:n.objectives)==null?void 0:U.slice(0,5).map(({objective_string:t,objective_type:a,objective_value:l,mod_value:o},d)=>e.jsxs(ie,{disabled:!(v!=null&&v[d]),children:[e.jsx("span",{children:a}),e.jsx("span",{children:t==="-"?l:t}),e.jsxs(re,{children:[o,e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]},d))}),e.jsxs($e,{children:[p?e.jsx("img",{onClick:()=>B(!0),src:`/assets/tavern/${p.racename}_${p.classname}.jpeg`,alt:"",loading:"lazy"}):e.jsx("img",{loading:"lazy",src:"/assets/tavern/default-avatar.jpg",alt:""}),e.jsxs(Se,{cardSelected:w,children:[e.jsx(C,{onClick:()=>I(0),loading:"lazy",src:f[0]?`/assets/aw-nft-images/${(V=f[0])==null?void 0:V.template.template_id}.webp`:"/assets/default-card.png",alt:(G=(q=f[0])==null?void 0:q.data)==null?void 0:G.name}),e.jsx(C,{onClick:()=>I(1),loading:"lazy",src:f[1]?`/assets/aw-nft-images/${(K=f[1])==null?void 0:K.template.template_id}.webp`:"/assets/default-card.png",alt:(J=(Y=f[1])==null?void 0:Y.data)==null?void 0:J.name}),e.jsx(C,{onClick:()=>I(2),loading:"lazy",src:f[2]?`/assets/aw-nft-images/${(X=f[2])==null?void 0:X.template.template_id}.webp`:"/assets/default-card.png",alt:(ee=(Z=f[2])==null?void 0:Z.data)==null?void 0:ee.name})]})]}),e.jsx(He,{children:f.length!==0&&w===-1?e.jsx("span",{children:"Select a card"}):e.jsxs(e.Fragment,{children:[e.jsxs(De,{children:[e.jsx(A,{isSelected:u==="crew.worlds",onClick:()=>h("crew.worlds"),children:"Minions"}),e.jsx(A,{isSelected:u==="arms.worlds",onClick:()=>h("arms.worlds"),children:"Weapons"}),e.jsx(A,{isSelected:u==="tool.worlds",onClick:()=>h("tool.worlds"),children:"Tools"}),e.jsx(A,{isSelected:u==="level.worlds",onClick:()=>h("level.worlds"),children:"Levels"}),e.jsx(A,{isSelected:u==="faces.worlds",onClick:()=>h("faces.worlds"),children:"Avatars"})]}),e.jsx(Ee,{children:ue?new Array(10).fill(0).map((t,a)=>e.jsx(Me,{},a)):e.jsxs(e.Fragment,{children:[e.jsx(C,{onClick:()=>N(void 0),src:"/assets/default-card.png",alt:"default card"}),(te=z==null?void 0:z.filter(me))==null?void 0:te.map(t=>{var a;return e.jsx(C,{onClick:()=>N(t),loading:"lazy",src:`/assets/aw-nft-images/${t==null?void 0:t.template.template_id}.webp`,alt:(a=t==null?void 0:t.data)==null?void 0:a.name},t==null?void 0:t.asset_id)})]})})]})}),e.jsx(ae,{className:"right",children:(ne=n==null?void 0:n.objectives)==null?void 0:ne.slice(5,10).map(({objective_string:t,objective_type:a,objective_value:l,mod_value:o},d)=>e.jsxs(ie,{disabled:!(v!=null&&v[d+5]),children:[e.jsx("span",{children:a}),e.jsx("span",{children:t==="-"?l:t}),e.jsxs(re,{children:[o,e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]},d))})]}),L&&p?e.jsxs(Be,{isHidden:!M,children:[e.jsx(Ne,{onClick:()=>B(!1),children:"x"}),e.jsxs(Pe,{children:[e.jsxs(Oe,{children:[e.jsx(Ue,{children:"2"}),e.jsx(Qe,{children:e.jsx("img",{src:`/assets/tavern/${p.racename}_${p.classname}.jpeg`,alt:"",loading:"lazy"})}),e.jsx(Ve,{children:e.jsx("div",{style:{width:"50%"}})})]}),e.jsxs(qe,{children:[e.jsxs(Ge,{children:[p.racename," ",p.classname]}),e.jsx(T,{children:"Element: Gem"}),e.jsx(T,{children:"Level: 7"}),e.jsx(T,{children:"Age Penalty: - 22%"}),e.jsx(T,{children:"Origin: Magor"})]})]}),e.jsxs(Ke,{children:[ot.map(t=>e.jsxs(oe,{children:[e.jsxs("span",{children:[t,":"]}),e.jsxs("span",{children:[p[`${t}_min`]," - ",p[`${t}_max`]]})]},t)),e.jsx("hr",{}),lt.map(t=>e.jsxs(oe,{children:[e.jsxs("span",{children:[t.displayname,":"]}),e.jsx("span",{children:p[t.value]})]},t.value))]})]}):!L&&p?e.jsx("img",{src:`/assets/tavern/${p.racename}_${p.classname}.jpeg`,alt:"",loading:"lazy"}):e.jsx("img",{src:"/assets/tavern/unknown-fighter.jpeg",alt:"",loading:"lazy"})]})]})},jt=pe.memo(ct);export{jt as default};
