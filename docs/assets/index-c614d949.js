import{s as n,S as j,R as o,_ as d,u as v,a as T,r as p,j as s,Q as E}from"./index-33cae2a8.js";import R from"./index-6edcb1ed.js";import{u as C}from"./use-transaction-16bf7102.js";import{s as D}from"./sleep-da79c358.js";import{o as S}from"./activequests-query-feeedcd8.js";import{c as k,a as z}from"./calculateTImeLeft-7c0113ed.js";import"./index-469ceee9.js";import"./toast-options-d5a495c1.js";import"./useQuery-a96762a8.js";const A=n("div",{display:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"10px",padding:"5px",h:"540px",w:"100%",maxW:"425px",bg:"#6E6E6E",border:"2px solid #C8C8C8",position:"relative"}),I=n("div",{display:"flex",w:"100%",position:"relative",img:{w:"100%",objectFit:"cover",h:"225px"},span:{fw:"bold",ff:"$heading",fs:"18px",color:"white",zIndex:"2",textShadow:"2px 2px 2px rgba(0, 0, 0)",position:"absolute",bottom:"10px",right:"10px"}}),F=n("h2",{display:"flex",align:"center",justify:"center",w:"100%",h:"115px",zIndex:"2",fw:"normal",ff:"$heading",fs:"18px",color:"white",bg:"#4D4D4D"}),L=n("span",{display:"flex",align:"center",justify:"center",gap:"10px",w:"100%",h:"80px",zIndex:"2",fw:"bold",ff:"$heading",fs:"18px",color:"white",bg:"#4D4D4D"}),q=n("div",{display:"flex",direction:"column",position:"relative",height:"30px",w:"100%",br:"5px",bg:"#282828",border:"1px solid #121212",">span":{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","-webkit-text-stroke":".5px rgba(0, 0, 0, 0.36)",fw:"bold",ff:"$heading",fs:"18px",color:"white"},div:{br:"5px",height:"100%"}}),P=n(R,{display:"flex",align:"center",justify:"center",zIndex:"3",w:"100%",h:"40px",fw:"bold",br:"2px !important",bg:"#9E475D !important",borderWidth:"1px",img:{w:"25px",h:"25px",objectFit:"contain"},variants:{isCompleted:{true:{bg:"#6750A4 !important"}}}});async function Q(e,i,a){const{executeTransaction:l}=C(),u=$(e,i,a);return!!await l(u)}function $(e,i,a){return{actions:[{account:j.questAle,name:"reroll",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,scope:i,quest_name:a}}]}}const B=o.lazy(()=>d(()=>import("./shards-ac83e4b5.js"),["assets/shards-ac83e4b5.js","assets/index-33cae2a8.js","assets/index-55fec1ff.css"])),O=o.lazy(()=>d(()=>import("./tlm-fda1ae0d.js"),["assets/tlm-fda1ae0d.js","assets/index-33cae2a8.js","assets/index-55fec1ff.css"])),M=o.lazy(()=>d(()=>import("./index-73898b28.js"),["assets/index-73898b28.js","assets/index-33cae2a8.js","assets/index-55fec1ff.css"])),V=o.lazy(()=>d(()=>import("./index-e292a5c5.js"),["assets/index-e292a5c5.js","assets/index-33cae2a8.js","assets/index-55fec1ff.css"])),W=({item:e,isItemLoading:i})=>{const a=v(T(t=>t.user)),[l,u]=o.useState(""),[x,g]=o.useState(!1),[m,h]=o.useState(!1);async function y(){if(!m){h(!0);return}g(!0);try{if(!await Q(a,e.quest_scope,e.quest_name)){console.log("Failed to reroll quest");return}await D(3e3),await S(),E.success("Quest rerolled successfully!")}catch(t){console.log(t)}finally{g(!1)}}const f=p.useCallback(()=>{const t=k(new Date(e.expiry_date));if(t){const r=z(t,"days");u(r)}},[e.expiry_date]),c=p.useMemo(()=>{const t=a.permstats.find(b=>b.first===e.task_type),r=((t==null?void 0:t.second)||0)-e.task_start_value;return r>=0?r:0},[a,e]),w=p.useMemo(()=>{const t=c/e.task_end_value*100;let r="linear-gradient(90deg, #C2253F 0%, #f1546e92 100%)";return t>=50&&t<100?r="linear-gradient(90deg, #F7A600 0%, #FFD86B 100%)":t>=100&&(r="linear-gradient(90deg, #6CC000 0%, #ADDE6F 100%)"),{width:t+"%",background:r}},[c,e]);p.useEffect(()=>{f();const t=setTimeout(()=>{f()},1e3*60);return()=>{clearTimeout(t)}},[f]);const _=c>=e.task_end_value;return i?s.jsx(V,{}):l===""?s.jsx(M,{}):s.jsxs(A,{children:[s.jsxs(I,{children:[s.jsx("img",{loading:"lazy",src:`/assets/quests/${e.task_type}_${e.quest_scope}.jpeg`,alt:""}),s.jsx("span",{children:l})]}),s.jsx(F,{children:e.quest_description.replace("[amount]",String(e.task_end_value))}),s.jsxs(L,{children:[e.reward_type==="shards"?s.jsx(B,{}):s.jsx(O,{}),e.reward_amount]}),s.jsxs(q,{children:[s.jsxs("span",{children:[c," / ",e.task_end_value]}),s.jsx("div",{style:w})]}),s.jsx(P,{isCompleted:_,isLoading:x,disabled:x,onClick:y,children:_?"Complete Quest":s.jsxs(s.Fragment,{children:[m?"Confirm Rerolling":"Reroll"," -10"," ",s.jsx("img",{loading:"lazy",src:"/assets/icons/credits.png",alt:""})]})})]})},ee=o.memo(W);export{ee as default};
