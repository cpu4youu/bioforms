import{s as c,g as h,S as p,e as y,u as m,R as f,_ as b,j as o,r as j,Q as i}from"./index-7e6a3882.js";import{u as w}from"./index-4211651c.js";import T from"./index-68d01384.js";import{u as S}from"./useQuery-8fd5cf9f.js";import{u as d}from"./use-transaction-219d82fb.js";import{v as _}from"./v4-4a60fe23.js";import"./toast-options-a7b9182d.js";const C=c("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",padding:"40px 40px",gap:"10px",mt:"10px",bg:"#141423",br:"15px",w:"100%",maxW:"510px",button:{justify:"center",h:"50px",fw:"bold"},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),v=c("div",{d:"flex",fw:"bold",ff:"$heading",fs:"16px",color:"white",mb:"50px"}),u=c("div",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"16px",color:"white",strong:{display:"flex",align:"center",justify:"center",gap:"10px"},img:{w:"25px",h:"25px",objectFit:"contain"},"&:last-of-type":{my:"50px"}}),z=c("button",{display:"none",align:"flex-start",justify:"center",color:"#fff",fs:"30px",w:"50px",h:"50px",top:"0px",right:"0px",position:"absolute","@xmd":{d:"flex"}}),Y=async n=>{const e=await h({options:{code:p.eosioToken,index_position:1,key_type:"i64",limit:"1000",scope:n,table:"accounts"}});return(e==null?void 0:e[0])||null},A=()=>S({queryKey:[y.WaxCoinsState],queryFn:()=>E(),staleTime:1e3*60*60,enabled:!!m.getState().user});async function E(){const n=m.getState().user;if(!n)return null;try{const e=await Y(n.name);return e?{balance:parseFloat(e.balance),currency:e.balance.split(" ")[1]}:null}catch(e){return console.log(e),null}}async function F(n,e){const{executeTransaction:t}=d(),s=R(n,e);return!!await t(s)}function R(n,e){return{actions:[{account:p.shopAle,name:"buyshopitem",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{wallet:n.name,item:e}}]}}async function W(n,e,t){const{executeTransaction:s}=d(),a=G(n,e,t);return!!await s(a)}function G(n,e,t){return{actions:[{account:p.eosioToken,name:"transfer",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{from:n.name,to:"shop.ale",memo:`purchase,${e}`,quantity:t}}]}}const I=f.lazy(()=>b(()=>import("./index-d616254f.js"),["assets/index-d616254f.js","assets/index-7e6a3882.js","assets/index-55fec1ff.css","assets/index-4211651c.js","assets/useQuery-8fd5cf9f.js"])),L=f.memo(({list:n})=>(console.log(n),o.jsx(o.Fragment,{children:n==null?void 0:n.map(e=>o.jsx(I,{...e},_()))}))),$=f.memo(()=>{const{user:n,updatePlayerData:e}=m(),{selectedPack:t,setSelectedPack:s}=w(),{data:a}=A(),[l,x]=j.useState(!1);async function g(){if(!n)return i.error("You need to be logged in to buy items");if(!t)return i.error("You need to select a pack to buy items");x(!0);try{let r=!1;(t==null?void 0:t.cost_gem)>0?r=await F(n,t.item):r=await W(n,t.item,t.cost_wax),r&&(await e(),i.success("Item bought successfully"))}catch{i.error("Error buying item")}finally{x(!1),s(null)}}return o.jsxs(C,{children:[o.jsx(z,{onClick:()=>s(null),children:"x"}),o.jsx(v,{children:o.jsxs("span",{children:["Your selection: ",t==null?void 0:t.offer_name]})}),o.jsxs(u,{children:[o.jsx("span",{children:"You will receive: "}),o.jsxs("strong",{children:[o.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageGain}.png`,alt:""}),t==null?void 0:t.gain]})]}),o.jsxs(u,{children:[o.jsx("span",{children:"You will pay:"}),o.jsxs("strong",{children:[o.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageCost}.png`,alt:""}),t==null?void 0:t.cost]})]}),o.jsxs(u,{children:[o.jsx("span",{children:"Your current WAX balance:"}),o.jsxs("strong",{children:[o.jsx("img",{loading:"lazy",src:"/assets/icons/wax-coin.png",alt:""}),a==null?void 0:a.balance.toLocaleString("en-US",{maximumFractionDigits:2})]})]}),o.jsx(T,{isLoading:l,disabled:l,onClick:g,color:"blue",children:"Purchase now"})]})});L.displayName="GemList";$.displayName="GemSelection";export{L as GemList,$ as GemSelection};
