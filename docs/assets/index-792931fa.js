import{s as x,S as W,c as z,Q as _,R as F,_ as j,a as E,u as R,r as w,j as e}from"./index-f70c91ac.js";import{u as D}from"./index-4a88cc41.js";import{F as L}from"./index-438443f3.js";import{u as M}from"./use-media-48576873.js";import{s as N}from"./sleep-da79c358.js";import{u as O}from"./use-transaction-36d8df1a.js";const P=x("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"auto 1fr",gap:"10px",br:"15px",w:"100%",h:"100%",variants:{isFighterSelected:{true:{"@lg":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@lgxxx":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lgxxx":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),H=x("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}},"&:nth-child(1)":{display:"none"},"&:nth-child(2)":{display:"none"}},"@lgxxx":{button:{"&:nth-child(1)":{display:"flex"},"&:nth-child(2)":{display:"flex"}}},"@md":{button:{"&:nth-child(1)":{display:"none"},"&:nth-child(2)":{display:"none"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),V=x("div",{gridArea:"main",d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-center",justifyContent:"flex-center",gap:"10px",flexWrap:"wrap",h:"calc(100vh - 235px)",minH:"calc(100vh - 160px)",overflowY:"auto",padding:"10px",br:"15px",bg:"#141423",variants:{isFighterSelected:{true:{"@lg":{display:"none"},"@xmd":{display:"none"}}}}}),k=x("div",{gridArea:"main",d:"flex",justify:"space-between",gap:"5px",w:"100%",px:"20px",">span":{mt:"55px",color:"#fff",fw:"bold",ff:"$heading",fs:"12px"},"@xlg":{justify:"center",flexWrap:"wrap",">span":{my:"25px"}},variants:{isFighterSelected:{true:{justify:"center",flexWrap:"wrap",">span":{my:"25px"}}}}}),$=x("h3",{textAlign:"center",w:"100%",fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@sm":{fontSize:"14px"}}),q=x("span",{textAlign:"center",w:"100%",fontSize:"16px",ff:"$heading",color:"#C9C9C9","@sm":{h:"initial",fontSize:"14px"}}),B=x("div",{display:"flex",flexDirection:"column",gridArea:"side",padding:"0px 18px",br:"15px",bg:"#141423",overflowY:"auto",maxH:"calc(100vh - 160px)",minW:"500px",variants:{isFighterSelected:{false:{"@lgxxx":{display:"none"}}}},"@lgxxx":{minW:"initial"},"@sm":{mt:"5px"}}),Y=x("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"});async function G(n,t,u,i,l,r,o,d,s,c,p){const{executeTransaction:g}=O(),m=Q(n,t,u,i,l,r,o,d,s,c,p);return!!await g(m)}function Q(n,t,u,i,l,r,o,d,s,c,p){return{actions:[{account:W.dungeonsAle,name:"playdungeon",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{wallet:n.name,planet:t,land_id:u,crew_asset_id:i,weapon_asset_id:l,fighter_ids:r,difficulty:o,use_gems:d,history_id:s,x:c,y:p}}]}}const J=z(n=>({myTeam:[null,null,null,null,null],setMyTeam:t=>n({myTeam:t}),selectedCards:[void 0,void 0],setSelectedCards:t=>n({selectedCards:t})}));function K({user:n,areaSelected:t,myTeam:u,selectedCards:i,selectedLevel:l}){var o,d,s,c,p,g,m,f;const r=u.reduce((h,y)=>y?[...h,y.fighter_id]:h,[]);return!n||!(t!=null&&t.landId)||!r.length||!((o=i[0])!=null&&o.asset_id)||!((d=i[1])!=null&&d.asset_id)?(r.length||_.error("No Warrior selected"),(s=i[0])!=null&&s.asset_id||_.error("No Crew selected (First spot on cards)"),(c=i[1])!=null&&c.asset_id||_.error("No Weapon selected (Second spot on cards)"),console.error("Can not find data",{user:n,areaSelected:t,crew_asset_id:Number((p=i[0])==null?void 0:p.asset_id),weapon_asset_id:Number((g=i[1])==null?void 0:g.asset_id),fighter_ids:r,selectedLevel:l})):{user:n,planet:n.planet,landId:t.landId,x:t.x,y:t.y,card1:Number((m=i[0])==null?void 0:m.asset_id),card2:Number((f=i[1])==null?void 0:f.asset_id),teamFiltered:r,level:l.level}}const T=F.lazy(()=>j(()=>import("./index-7a3cf66d.js"),["assets/index-7a3cf66d.js","assets/index-f70c91ac.js","assets/index-55fec1ff.css"])),U=F.lazy(()=>j(()=>import("./index-f90ea459.js"),["assets/index-f90ea459.js","assets/index-f70c91ac.js","assets/index-55fec1ff.css","assets/useQuery-f6c9f54a.js","assets/v4-4a60fe23.js"])),X=F.lazy(()=>j(()=>import("./index-73683c00.js"),["assets/index-73683c00.js","assets/index-f70c91ac.js","assets/index-55fec1ff.css","assets/fighters-query-c15615e5.js","assets/useQuery-f6c9f54a.js","assets/index-4a88cc41.js","assets/index-7a3cf66d.js","assets/use-media-48576873.js","assets/inventory-query-6481a922.js","assets/atomic-api-dcda2060.js","assets/toast-options-f60b6ad2.js","assets/v4-4a60fe23.js","assets/index-438443f3.js","assets/sleep-da79c358.js","assets/use-transaction-36d8df1a.js"])),Z=F.lazy(()=>j(()=>import("./index-4ed9641f.js"),["assets/index-4ed9641f.js","assets/index-f70c91ac.js","assets/index-55fec1ff.css","assets/useQuery-f6c9f54a.js","assets/fighters-query-c15615e5.js","assets/index-4a88cc41.js","assets/v4-4a60fe23.js"])),ee=()=>{const{selectedCards:n,myTeam:t,setMyTeam:u,setSelectedCards:i}=J(),{areaSelected:l,setAreaSelected:r}=E(),o=R(a=>a.user),{selectedLevel:d,selectedFighter:s,setSelectedFighter:c}=D(),{isSuperLarge:p}=M(),[g,m]=w.useState(!1),[f,h]=w.useState("");async function y(){try{m(!0);const a=K({areaSelected:l,myTeam:t,selectedCards:n,selectedLevel:d,user:o});if(!a)return;const S=(()=>{const C="abcdefghijklmnopqrstuvwxyz12345";let v="";for(let b=0;b<12;b++){const I=Math.round(Math.random()*12+1);v+=C[I]}return v})();if(!await G(o,o.planet,a.landId,a.card1,a.card2,a.teamFiltered,a.level,!0,S,a.x,a.y))return;await N(2e3),h(S),_.success("Fight Started !")}catch(a){console.error(a)}finally{m(!1)}}function A(){i([void 0,void 0]),u([null,null,null,null,null]),r(null)}return f?e.jsx(U,{historyId:f}):e.jsxs(P,{isFighterSelected:!!s,children:[e.jsxs(H,{children:[e.jsx("button",{}),e.jsx("button",{}),e.jsx(T,{onClick:A,children:"Back"}),e.jsxs(T,{isLoading:g,onClick:y,children:["Start Fight",e.jsxs("div",{children:["-32",e.jsx("img",{src:"/assets/icons/potion.png",alt:"Potion"})]})]})]}),e.jsxs(V,{isFighterSelected:!!s,children:[e.jsx($,{children:"Weather"}),e.jsx(q,{children:"+20% Gem Damage"}),e.jsxs(k,{isFighterSelected:p&&!!s,children:[e.jsx(X,{}),e.jsx("span",{children:"VS"}),e.jsx(Z,{})]})]}),e.jsx(B,{isFighterSelected:!!s,children:s?e.jsx(L,{selectedFighter:s,onCloseFighterDetail:c}):e.jsx(e.Fragment,{children:e.jsx(Y,{children:"Select a Fighter"})})})]})},ce=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ce as i,J as u};
