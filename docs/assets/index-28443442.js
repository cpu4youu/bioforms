import{s as i,S as y,R as a,_ as f,u as b,a as j,r as d,j as s,Q as v}from"./index-4bc6c69d.js";import T from"./index-0f4db7c7.js";import{u as R}from"./use-transaction-db9a89b5.js";import{s as C}from"./sleep-da79c358.js";import{o as E}from"./activequests-query-19c29189.js";import{c as D,a as S}from"./calculateTImeLeft-b770b02f.js";import"./index-8793c9bd.js";import"./toast-options-8b7fe99e.js";import"./useQuery-c71f9407.js";const k=i("div",{display:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"10px",padding:"5px",h:"540px",w:"100%",maxW:"425px",bg:"#6E6E6E",border:"2px solid #C8C8C8",position:"relative"}),z=i("div",{display:"flex",w:"100%",position:"relative",img:{w:"100%",objectFit:"cover",h:"225px"},span:{fw:"bold",ff:"$heading",fs:"18px",color:"white",zIndex:"2",textShadow:"2px 2px 2px rgba(0, 0, 0)",position:"absolute",bottom:"10px",right:"10px"}}),A=i("h2",{display:"flex",align:"center",justify:"center",w:"100%",h:"115px",zIndex:"2",fw:"normal",ff:"$heading",fs:"18px",color:"white",bg:"#4D4D4D"}),F=i("span",{display:"flex",align:"center",justify:"center",gap:"10px",w:"100%",h:"80px",zIndex:"2",fw:"bold",ff:"$heading",fs:"18px",color:"white",bg:"#4D4D4D"}),I=i("div",{display:"flex",direction:"column",position:"relative",height:"30px",w:"100%",br:"5px",bg:"#282828",border:"1px solid #121212",">span":{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","-webkit-text-stroke":".5px rgba(0, 0, 0, 0.36)",fw:"bold",ff:"$heading",fs:"18px",color:"white"},div:{br:"5px",height:"100%"}}),q=i(T,{display:"flex",align:"center",justify:"center",zIndex:"3",w:"100%",h:"40px",fw:"bold",br:"2px !important",bg:"#9E475D !important",borderWidth:"1px",img:{w:"25px",h:"25px",objectFit:"contain"},variants:{isCompleted:{true:{bg:"#6750A4 !important"}}}});async function L(e,r,n){const{executeTransaction:l}=R(),c=P(e,r,n);return!!await l(c)}function P(e,r,n){return{actions:[{account:y.questAle,name:"reroll",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,scope:r,quest_name:n}}]}}const $=a.lazy(()=>f(()=>import("./shards-b8ec4734.js"),["assets/shards-b8ec4734.js","assets/index-4bc6c69d.js","assets/index-55fec1ff.css"])),B=a.lazy(()=>f(()=>import("./tlm-5047ef4f.js"),["assets/tlm-5047ef4f.js","assets/index-4bc6c69d.js","assets/index-55fec1ff.css"])),Q=a.lazy(()=>f(()=>import("./index-c75a523a.js"),["assets/index-c75a523a.js","assets/index-4bc6c69d.js","assets/index-55fec1ff.css"])),M=e=>{const r=b(j(t=>t.user)),[n,l]=a.useState(""),[c,u]=a.useState(!1),[g,h]=a.useState(!1);async function _(){if(!g){h(!0);return}u(!0);try{if(!await L(r,e.quest_scope,e.quest_name)){console.log("Failed to reroll quest");return}await C(3e3),await E(),v.success("Quest rerolled successfully!")}catch(t){console.log(t)}finally{u(!1)}}const x=d.useCallback(()=>{const t=D(new Date(e.expiry_date));if(t){const o=S(t,"days");l(o)}},[e.expiry_date]),p=d.useMemo(()=>{var t;return((t=r.permstats.find(o=>o.first===e.task_type))==null?void 0:t.second)||0},[r,e]),w=d.useMemo(()=>{const t=p/e.task_end_value*100;let o="linear-gradient(90deg, #C2253F 0%, #f1546e92 100%)";return t>=50&&t<100?o="linear-gradient(90deg, #F7A600 0%, #FFD86B 100%)":t>=100&&(o="linear-gradient(90deg, #6CC000 0%, #ADDE6F 100%)"),{width:t+"%",background:o}},[p,e]);d.useEffect(()=>{x();const t=setTimeout(()=>{x()},1e3*60);return()=>{clearTimeout(t)}},[x]);const m=p>=e.task_end_value;return n===""?s.jsx(Q,{}):s.jsxs(k,{children:[s.jsxs(z,{children:[s.jsx("img",{loading:"lazy",src:`/assets/quests/${e.task_type}_${e.quest_scope}.jpeg`,alt:""}),s.jsx("span",{children:n})]}),s.jsx(A,{children:e.quest_description.replace("[amount]",String(e.task_end_value))}),s.jsxs(F,{children:[e.reward_type==="shards"?s.jsx($,{}):s.jsx(B,{}),e.reward_amount]}),s.jsxs(I,{children:[s.jsxs("span",{children:[p," / ",e.task_end_value]}),s.jsx("div",{style:w})]}),s.jsx(q,{isCompleted:m,isLoading:c,disabled:c,onClick:_,children:m?"Complete Quest":s.jsxs(s.Fragment,{children:[g?"Confirm Rerolling":"Reroll"," -10"," ",s.jsx("img",{loading:"lazy",src:"/assets/icons/credits.png",alt:""})]})})]})},X=a.memo(M);export{X as default};
