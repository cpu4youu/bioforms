import{s,S as R,R as v,_ as M,u as N,a as P,r as U,j as t,Q as C}from"./index-0cd9fab8.js";import V from"./index-182918b8.js";import{u as k,o as O}from"./land-config-e48a6537.js";import{u as Y}from"./index-da62a361.js";import{u as Q}from"./use-transaction-45cc1e39.js";import{s as W}from"./sleep-da79c358.js";import"./index-84a7b8cf.js";import"./useQuery-7ffc4c85.js";import"./atomic-api-a8db6d1b.js";import"./toast-options-5fb0ea54.js";import"./constants-b95c644e.js";const q=s("div",{d:"flex",w:"100%",direction:"column",">img":{my:"20px",objectFit:"contain",w:"100%"},h3:{d:"flex",alignItems:"center",gap:"10px",fs:"16px",color:"#FFFFFF",mb:"15px"},"@sm":{pb:"20px",">img":{d:"none"}}}),G=s("div",{zIndex:2,w:"100%",h:"7px",bg:"red","@sm":{h:"3px"}}),H=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative",w:"100%",h:"180px",">img":{br:"0 0 15px 15px",zIndex:1,objectFit:"cover",w:"100%",h:"100%"},span:{position:"absolute",top:"0px",textAlign:"center",w:"100%",zIndex:2,textTransform:"capitalize",bg:"#5DC3E8",padding:"15px 0px",fs:"18px",ff:"$heading",fw:"bold",color:"#000"},"@sm":{">img":{h:"60px","&:first-child":{left:"-3px"}}}}),J=s("div",{ff:"$heading",fs:"16px",color:"#FFFFFF",padding:"10px",br:"3px",bg:"#201D2C",mb:"10px",mt:"10px",span:{color:"#FFB800"},"@sm":{fs:"12px"}}),K=s("div",{d:"flex",direction:"column",mt:"30px"}),X=s("h3",{color:"#FFFFFF","@sm":{fs:"12px"}}),Z=s("p",{color:"#FFFFFF",ff:"$heading",fs:"16px",mt:"5px",padding:"5px 10px",br:"3px",bg:"#201D2C","@sm":{fs:"10px"}}),tt=s("div",{d:"flex",direction:"column",mt:"20px","@sm":{div:{top:"20px",left:"5px",fs:"10px"}}}),et=s("div",{d:"flex",gap:"5px",mt:"30px"}),u=s("div",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",direction:"column",span:{d:"flex",alignItems:"center",justifyContent:"center",padding:"5px 10px",w:"100%",br:"5px 5px 0 0 ",color:"#FFFFFF",ff:"$heading",fs:"10px",fw:"$thin",bg:"#201D2C"}}),f=s("div",{d:"flex",alignItems:"center",justifyContent:"center",gap:"5px",padding:"5px",br:"0 0 5px 5px",w:"100%",color:"#FFFFFF",ff:"$heading",fs:"12px",fw:"normal",bg:"#1C1A26",img:{objectFit:"contain",w:"20px",my:"0px"}}),nt=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",gap:"15px",mt:"20px",w:"100%"}),st=s("div",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",color:"#FFFFFF",ff:"$heading",fs:"20px",fw:"bold"}),ot=s("span",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",textAlign:"center",color:"#C7C7C7",ff:"$heading",fs:"15px",fw:"normal"}),it=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",w:"100%"}),rt=s("span",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",mt:"25px",textAlign:"center",color:"#C7C7C7",ff:"$heading",fs:"15px",fw:"bold"}),at=s("span",{d:"flex",alignItems:"center",justifyContent:"center",mt:"5px",mb:"25px",w:"100%",bg:"#212130",br:"10px",padding:"20px 0px",textAlign:"center",color:"#fff",ff:"$heading",fs:"15px",fw:"bold",img:{objectFit:"contain",w:"25px",ml:"10px"}}),ct=s(V,{display:"inline-flex",align:"center",justify:"center",gap:"5px",zIndex:"3",padding:"30px 0px",w:"100%",h:"40px",br:"2px !important",bg:"#9E475D !important",border:"1px solid #36B9EA !important",fw:"bold !important",ff:"$heading",fs:"14px",color:"white"});async function lt(o,e){const{executeTransaction:a}=Q(),x=dt(o,e);return!!await a(x)}function dt(o,e){return{actions:[{account:R.landsAle,name:"delbuilding",authorization:[{actor:o.name,permission:o.authorization.permission}],data:{wallet:o.name,player:e.player,x:e.x,y:e.y,planet:e.planet,building:e.building,cost:e.cost}}]}}const pt=v.lazy(()=>M(()=>import("./index-8bdb8b60.js"),["assets/index-8bdb8b60.js","assets/index-0cd9fab8.js","assets/index-55fec1ff.css","assets/index-93ab3e59.js"])),xt=()=>{var F,w,j,_;const o=N(P(r=>r.user)),{data:e}=k(),{buildingBoost:a,setBuildingBoost:x,selectedBuild:n,isDestroying:D,selectedLand:i,setSelectedLand:S}=Y(),[h,b]=U.useState(!1);async function I(){b(!0);try{if(!i||!i.planet||!i.x||!i.y)return C.error("Error on getting land data, please try again later.");const r={player:o.name,planet:i.planet,x:i.x,y:i.y,building:n.building_name.toLowerCase(),cost:(e==null?void 0:e[0].delete_building_gems_cost)||0};await lt(o,r)&&(await W(3e3),await O(),S(null),C.success("Building destroyed successfully!"))}catch(r){console.error("Error destroying building:",r)}finally{b(!1)}}function A(r){const[p]=r,g=((n==null?void 0:n.boost_score)||0)/1e4;let m=p;p<c&&g<c?m=c:p<g&&(m=g),x([m])}const T=((F=e==null?void 0:e[0])==null?void 0:F.boost_base_cost)||0,B=((w=e==null?void 0:e[0])==null?void 0:w.boost_cost_first_percent)||0,L=(n==null?void 0:n.boost_score)||0,d=Number(((j=e==null?void 0:e[0])==null?void 0:j.boost_cost_mod)||0),$=(1-Math.pow(d,a[0]+1))/(1-d),z=(1-Math.pow(d,L/1e4+1))/(1-d),E=T+B*($-z),c=(((_=e==null?void 0:e[0])==null?void 0:_.start_boost_score)||0)/1e4,y=E,l=((n==null?void 0:n.boost_score)||0)/1e4;return t.jsxs(q,{children:[t.jsx(G,{style:{width:`${l}%`,backgroundColor:l>80?"green":l>50?"yellow":"red"}}),t.jsxs(H,{children:[t.jsx("img",{loading:"lazy",src:`/assets/buildings/${n==null?void 0:n.img}.png`,alt:n==null?void 0:n.building_name,title:n==null?void 0:n.building_name,className:"build-image"}),t.jsx("span",{children:n==null?void 0:n.building_name})]}),D?t.jsxs(nt,{children:[t.jsx(st,{children:"Confirm Destruction"}),t.jsx(ot,{children:"You are about to destroy one of your buildings. This cannot be reversed. You will lose the building as well as the buildings current rating. Only proceed if you are sure about your decision!"}),t.jsxs(it,{children:[t.jsx(rt,{children:"You will spend"}),t.jsxs(at,{children:[e==null?void 0:e[0].delete_building_gems_cost.toLocaleString("en-US"),t.jsx("img",{src:"/assets/icons/gems.png",alt:"gems",loading:"lazy"})]})]}),t.jsx(ct,{onClick:I,isLoading:h,disabled:h,children:"Pay and destroy now"})]}):t.jsxs(t.Fragment,{children:[t.jsxs(J,{children:[n.img==="tavern"&&`Allows players to recruit fighters on your land - and you earn for every fighter recruited
        on your land. A higher tavern rating means your tavern is suggested to players more often.`,t.jsx("br",{}),n.img==="dungeon"&&`Allows players to fight in the dungeon on your land - and you earn whenever a player wins
        this battle. A higher dungeon rating means higher rewards.`,t.jsx("br",{}),n.img==="arena"&&`Allows players to fight in the arena on your land - and you earn whenever a player wins this
        battle. A higher arena rating means higher rewards.`]}),t.jsxs(K,{children:[t.jsx(X,{children:"Building Boost"}),t.jsx(Z,{children:"Boosting a building raises its perks, but usage and time reduce boost levels. If boost drops below 1%, the building becomes unusable."}),t.jsx(tt,{children:t.jsx(pt,{onValueChange:A,value:a})})]}),t.jsxs(et,{children:[t.jsxs(u,{children:[t.jsx("span",{children:"Total Cost"}),t.jsxs(f,{children:[y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),t.jsx("img",{loading:"lazy",src:"/assets/icons/credits.png",alt:""})]})]}),t.jsxs(u,{children:[t.jsx("span",{children:"Cost per 1%"}),t.jsxs(f,{children:[(y/(a[0]-c||1)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),t.jsx("img",{loading:"lazy",src:"/assets/icons/credits.png",alt:""})]})]}),t.jsxs(u,{children:[t.jsx("span",{children:"Start Score"}),t.jsxs(f,{children:[l<c?c:l,"%"]})]})]})]})]})},Ct=v.memo(xt);export{Ct as default};
