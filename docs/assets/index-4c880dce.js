import{s as n,S as E,R as M,_ as L,u as b,a as y,r as j,j as o,Q as A}from"./index-6ffa1e5c.js";import $ from"./index-b04e074c.js";import{u as D}from"./use-transaction-32dcef0f.js";import{s as P}from"./sleep-da79c358.js";import"./index-a8b49a12.js";import"./toast-options-bfab8171.js";const F=n("div",{d:"flex",justify:"center",align:"center",direction:"column",w:"100%",my:"auto",padding:"20px",">img":{height:235,width:235,objectFit:"contain"}});n("div",{d:"flex",justify:"center",align:"center",gap:"20px",">span":{fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#fff"}});const S=n("div",{textAlign:"center",textTransform:"uppercase",position:"absolute",top:"150px",w:"100%",fontSize:"250px",fontWeight:"bold",ff:"$heading",color:"rgba(255, 109, 141, 0.31)",variants:{isVictory:{true:{color:"rgba(225, 202, 255, 0.31)"}}}}),T=n("div",{d:"flex",align:"center",justify:"center",gap:"5px",mt:"30px",w:"100%"});n("div",{d:"flex",w:"100%",maxW:"250px",position:"relative",">div:first-child":{d:"flex",justify:"space-between",gap:"5px",h:"400px",w:"100%",position:"relative",".unknown":{h:"auto",width:"100%",position:"absolute",top:"30px"},">img":{h:"auto",width:"100%",position:"absolute",top:"0"}}});n("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"250px",h:"150px",maxH:"150px",padding:"10px",position:"absolute",top:"65%",transform:"translateY(-50%)",zIndex:"2",bg:"rgba(20, 20, 35, 0.89)",borderTop:"3px solid rgba(255, 255, 255, 0.57)","&::before":{content:'""',position:"absolute",top:"-13px",left:"50%",transform:"translateX(-50%)",width:"0",height:"0",borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderBottom:"10px solid rgba(255, 255, 255, 0.57)"}});n("span",{d:"flex",textTransform:"uppercase",ff:"$heading",fontSize:"16px",fontWeight:"bold",color:"#868686"});n("span",{d:"flex",textTransform:"uppercase",ff:"$heading",fontSize:"16px",fontWeight:"bold",color:"#fff"});n("div",{d:"flex",align:"center",justify:"center",direction:"column",mt:"auto",width:"100%"});n("div",{d:"flex",align:"center",justify:"space-between",width:"100%",">span":{fontSize:"12px",fontWeight:"bold",ff:"$heading",color:"#8F8D8D"}});n("div",{d:"flex",align:"center",gap:"6px",img:{filter:"grayscale(100%)"},">span":{fontSize:"12px",fontWeight:"bold",ff:"$heading",color:"#fff"}});const B=n("div",{d:"flex",justify:"center",align:"center",direction:"column",zIndex:"2",w:"100%",maxW:"550px"}),_=n("div",{d:"flex",justify:"center",align:"center",w:"90%",h:"30px",position:"relative",padding:"0 20px",bg:"#1D1B20",border:"1px solid #C3C3C3",span:{fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#FFFFFF",textTransform:"uppercase",zIndex:"2","-webkit-text-stroke":"1px rgba(20, 20, 35, 0.4)","&:last-child":{position:"absolute",right:"-50px"}}}),I=n("div",{opacity:"0.6",position:"absolute",top:"0",left:"0",bg:"linear-gradient(90deg, #CE73E0 0%, #ED92FF 100%)",h:"100%"}),k=n("div",{opacity:"0.6",position:"absolute",top:"0",left:"0",bg:"linear-gradient(90deg, #E1AE2C 0%, #FFFE32 100%)",h:"100%"}),V=n($,{d:"flex",justify:"center",align:"center",w:"90%",h:"55px",padding:"0 20px",my:"20px",bg:"#6750A4 !important",border:"1px solid #C3C3C3",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#FFFFFF",textTransform:"uppercase"}),O=n("span",{d:"flex",justify:"center",align:"center",w:"100%",maxW:"375px",textAlign:"center",color:"#FFFFFF",ff:"$heading",fontSize:"12px",fontWeight:"bold"});async function Y(e,r,s){const{executeTransaction:l}=D(),i=q(e,r,s);return!!await l(i)}function q(e,r,s){return{actions:r.map(i=>({account:E.poolsAle,name:"claimpreward",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,pool:i,history_id:s}}))}}const v=M.lazy(()=>L(()=>import("./index-47399e52.js"),["assets/index-47399e52.js","assets/index-6ffa1e5c.js","assets/index-55fec1ff.css"])),H=({data:e,historyId:r})=>{var x,h,u,g;const s=b(y(t=>t.user)),l=b(y(t=>t.updatePlayerData)),[i,a]=j.useState(!1),[p,c]=j.useState(!1);async function C(){a(!0);try{const t=(e==null?void 0:e.reward_power_added.reduce((m,w)=>(w.power>0&&m.push(w.pool),m),[]))||[];if(!await Y(s,t,r)){console.error("Failed to mine reward");return}await P(3e3),await l(),A.success("Successfully mined reward!"),c(!0)}catch(t){console.error("Error mining reward:",t)}finally{c(!1),a(!1)}}const z=e==null?void 0:e.log.includes("Team 1"),R=((x=e==null?void 0:e.reward_power_added.find(t=>t.type==="tlm"))==null?void 0:x.power)||0,W=((h=e==null?void 0:e.reward_power_added.find(t=>t.type==="shards"))==null?void 0:h.power)||0,d=((u=e==null?void 0:e.reward_power_total.find(t=>t.pool==="tlmdung"))==null?void 0:u.power)||0,f=((g=e==null?void 0:e.reward_power_total.find(t=>t.pool==="shrddung"))==null?void 0:g.power)||0;return z?o.jsxs(F,{children:[o.jsx(S,{isVictory:!0,children:"VICTORY"}),o.jsx(T,{children:e==null?void 0:e.team1_end_fighters.map(t=>o.jsx(v,{fighter:t,highlights:e.highlightedStats},t.fighter_id))}),o.jsxs(B,{children:[o.jsxs(_,{children:[o.jsxs("span",{children:[d.toLocaleString()," TLM Minepower"]}),o.jsx(k,{style:{width:`${d*100/1e4}%`}}),o.jsxs("span",{children:["+ ",R.toLocaleString()]})]}),o.jsxs(_,{children:[o.jsxs("span",{children:[f.toLocaleString()," Shard Minepower"]}),o.jsx(I,{style:{width:`${f*100/1e4}%`}}),o.jsxs("span",{children:["+ ",W.toLocaleString()]})]}),o.jsx(V,{isLoading:i,disabled:i||p,onClick:C,children:p?"Mined":"Mine"}),o.jsx(O,{children:"Equip better tools for higher Minepower Rewards Mine once you have reached at least 10,000 Minepower"})]})]}):o.jsxs(F,{children:[o.jsx(S,{children:"DEFEAT"}),o.jsx(T,{children:e==null?void 0:e.team1_end_fighters.map(t=>o.jsx(v,{fighter:t,highlights:e.highlightedStats},t.fighter_id))})]})},Z=M.memo(H);export{Z as default};
