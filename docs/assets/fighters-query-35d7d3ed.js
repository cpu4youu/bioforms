import{g as m,S as i,M as _,q as u,e as o,u as d}from"./index-9ffa47e4.js";import{u as h}from"./useQuery-ae057b23.js";const p=async t=>await m({options:{code:i.battleAle,index_position:2,key_type:"i64",limit:"1000",scope:i.battleAle,table:"fighters",lower_bound:t,upper_bound:t}});function S(t){return t.map(e=>{const a=w(e),n=_({...e,stats:a}),s=new Date().getTime(),r=new Date(e.next_payday).getTime();return{...e,stats:{...e.stats,...n},is_disabled:s>r}})}function w(t){const e=u.getQueryData(o.BattleConfigState),a=Math.floor((Date.now()-new Date(t.creation_date).getTime())/(1e3*60*60*24));let n=1;e!=null&&e.age_penaly_percent_day&&(n=e==null?void 0:e.age_penaly_percent_day);const s=n/100,r=a*s,y=["health_max","health_min","damage_max","damage_min"],l={...t.stats};return y.forEach(c=>{const g=Math.max(0,100-r);l[c]=t.stats[c]*Math.pow(1.1,t.stats.level)*g/100}),{...t.stats,...l}}const f=t=>h({queryKey:[o.fightersState,t],queryFn:()=>F(t),staleTime:1e3*60*60,enabled:!!d.getState().user});async function x(t){return await u.invalidateQueries([o.fightersState,t])}async function F(t){try{const e=await p(t);return e?S(e):null}catch(e){return console.log(e),null}}export{x as o,f as u};
