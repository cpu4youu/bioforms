import{s as i,g as w,S as C,e as S,u as l,R as a,_ as T,a as _,j as e,r as p,Q as s}from"./index-fa47d130.js";import E from"./index-7798b245.js";import{u as v}from"./index-b05e2f0d.js";import{u as F}from"./useQuery-bee0c5b2.js";import{e as L,a as A}from"./execute-transfer-wax-to-shop copy-7d5dd563.js";import{s as R}from"./sleep-da79c358.js";import{c as D,a as I}from"./calculateTImeLeft-3fbd33a3.js";import{v as W}from"./v4-4a60fe23.js";import"./index-24d29243.js";import"./use-transaction-c0718893.js";import"./toast-options-f964d8bf.js";const B=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",padding:"40px 40px",gap:"13px",mt:"10px",bg:"#141423",br:"15px",w:"100%",maxW:"500px",button:{justify:"center",h:"50px",fw:"bold"},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),G=i("div",{d:"flex",align:"center",justify:"center",w:"100%",fw:"bold",ff:"$heading",fs:"20px",color:"white",mb:"50px"}),m=i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",w:"100%",ff:"$heading",fs:"16px",color:"#C7C7C7",strong:{display:"flex",align:"center",justify:"center",gap:"10px",padding:"10px",w:"100%",color:"white",bg:"#212130",br:"10px"},img:{w:"25px",h:"25px",objectFit:"contain"}}),Y=i("button",{display:"none",align:"flex-start",justify:"center",color:"#fff",fs:"30px",w:"50px",h:"50px",top:"0px",right:"0px",position:"absolute","@xmd":{d:"flex"}}),z=i(E,{display:"inline-flex",align:"center",justify:"center",gap:"5px",zIndex:"3",mt:"60px",w:"100%",h:"40px",br:"2px !important",bg:"#6750A4 !important",border:"1px solid #36B9EA !important",fw:"bold",ff:"$heading",fs:"14px",color:"white"}),$=async o=>{const n=await w({options:{code:C.eosioToken,index_position:1,key_type:"i64",limit:"1000",scope:o,table:"accounts"}});return(n==null?void 0:n[0])||null},Q=()=>F({queryKey:[S.WaxCoinsState],queryFn:()=>N(),staleTime:1e3*60*60,enabled:!!l.getState().user});async function N(){const o=l.getState().user;if(!o)return null;try{const n=await $(o.name);return n?{balance:parseFloat(n.balance),currency:n.balance.split(" ")[1]}:null}catch(n){return console.log(n),null}}const U=a.lazy(()=>T(()=>import("./index-914545b8.js"),["assets/index-914545b8.js","assets/index-fa47d130.js","assets/index-55fec1ff.css","assets/index-b05e2f0d.js","assets/calculateTImeLeft-3fbd33a3.js"])),q=a.memo(({list:o})=>{const n=l(_(t=>t.user));return e.jsx(e.Fragment,{children:o==null?void 0:o.map(t=>{if(!(t.trial_availability===0&&n.isLegendExpired))return e.jsx(U,{...t},W())})})}),K=a.memo(()=>{var h;const{user:o,updatePlayerData:n}=l(),{selectedPack:t,setSelectedPack:x}=v(),{data:c}=Q(),[f,g]=a.useState(""),[d,y]=p.useState(!1);async function j(){if(!o)return s.error("You need to be logged in to buy items");if(!t)return s.error("You need to select a pack to buy items");y(!0);let r=!1;try{(t==null?void 0:t.category)==="credits"||(t==null?void 0:t.category)==="flasks"||(t==null?void 0:t.category)==="account"?r=await L(o,t.item):r=await A(o,t.item,t.cost_wax),r&&(await R(3e3),await n(),s.success("Item bought successfully"))}catch{s.error("Error buying item")}finally{y(!1),x(null)}}const u=p.useCallback(()=>{if(!(t!=null&&t.itemCD))return g("");const r=D(new Date(t==null?void 0:t.itemCD)),b=I(r,"weeks");g(b)},[t]);return p.useEffect(()=>{u();const r=setTimeout(()=>{u()},1e3*60);return()=>{clearTimeout(r)}},[u]),e.jsxs(B,{children:[e.jsx(Y,{onClick:()=>x(null),children:"x"}),e.jsx(G,{children:"Confirm Selection"}),e.jsxs(m,{children:[e.jsx("span",{children:"You are about to exchange the following"}),t!=null&&t.cost?e.jsxs("strong",{children:[(h=t==null?void 0:t.cost)==null?void 0:h.toLocaleString("en-US"),e.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageCost}`,alt:""})]}):e.jsx("strong",{children:"FREE"})]}),e.jsxs(m,{children:[e.jsx("span",{children:"and receive"}),e.jsxs("strong",{children:[t==null?void 0:t.offer_name,e.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageGain}`,alt:""})]})]}),e.jsx(z,{isLoading:d,disabled:d,onClick:j,color:"blue",children:f||"Confirm exchange"}),(t==null?void 0:t.imageCost)==="wax-coin.png"&&e.jsx(m,{children:e.jsxs("strong",{children:[e.jsx("span",{children:"Your current WAX balance:"}),e.jsx("img",{loading:"lazy",src:"/assets/icons/wax-coin.png",alt:""}),(c==null?void 0:c.balance.toLocaleString("en-US",{maximumFractionDigits:2}))??0]})})]})});q.displayName="GemList";K.displayName="GemSelection";export{q as GemList,K as GemSelection};
