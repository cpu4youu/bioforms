import{s as i,S as R,R as f,_ as C,u as $,j as e}from"./index-9ffa47e4.js";import{u as M,b as W,o as B,a as E}from"./all-buildings-b2e812b0.js";import{f as _}from"./constants-9b21425a.js";import{u as O}from"./index-de9f82e4.js";import{u as P}from"./use-transaction-e766b405.js";import{s as N}from"./sleep-da79c358.js";import{u as F}from"./land-config-0f9a4138.js";import"./useQuery-ae057b23.js";import"./atomic-api-5575eef9.js";import"./toast-options-2ddb76e0.js";const V=i("div",{mt:"20px","@sm":{mt:"5px"}}),k=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),Q=i("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),H=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),U=i("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}}}),Y=i("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),y=i("div",{d:"flex",w:"49%",h:"100%",gap:"2px","img, svg":{px:"5px",objectFit:"contain",minW:"54px",maxW:"54px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto","img, svg":{minW:"34px",maxW:"34px"},span:{fontSize:"10px"}}}),q=i("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),D=i("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),G=i("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function J(c,r){const{executeTransaction:d}=P(),m=K(c,r);return!!await d(m)}function K(c,r){return{actions:[{account:R.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const X=f.lazy(()=>C(()=>import("./index-b5fda84e.js"),["assets/index-b5fda84e.js","assets/index-9ffa47e4.js","assets/index-55fec1ff.css","assets/index-bd4e0ab4.js"])),Z=f.lazy(()=>C(()=>import("./shards-3146af5f.js"),["assets/shards-3146af5f.js","assets/index-9ffa47e4.js","assets/index-55fec1ff.css"])),ee=f.lazy(()=>C(()=>import("./tlm-e533d6ce.js"),["assets/tlm-e533d6ce.js","assets/index-9ffa47e4.js","assets/index-55fec1ff.css"])),te=()=>{const c=$(s=>s.user),{data:r}=M(),{data:d}=W(),{data:m}=F(),{selectedLand:g,setBuildingBoost:v,setSelectedBuild:S,setSelectedLand:T,setIsBuildMenuOpen:L}=O(),[j,w]=f.useState(null);function I(s,t){var h,x,o,l;T(t);let a={..._[0]};if(t.buildings){a={...(h=t.buildings)==null?void 0:h[0],img:(o=(x=t.buildings)==null?void 0:x[0])==null?void 0:o.building_name};const u=((a==null?void 0:a.boost_score)||0)/1e4,n=(((l=m==null?void 0:m[0])==null?void 0:l.start_boost_score)||0)/1e4;v([u<n?n:u])}S(a),L(!0)}async function z(s,t){s.stopPropagation();try{w(t.asset_id),await J(c,{planet:t.data.planetName,x:t.data.x,y:t.data.y})&&(await N(2e3),await B(),await E())}catch(a){console.error(a)}finally{w(null)}}return e.jsxs(V,{children:[e.jsxs(k,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(Q,{children:r==null?void 0:r.map(s=>{const t=d==null?void 0:d[s.data.planetName].find(n=>n.x===s.data.x&&n.y===s.data.y),a=t==null?void 0:t.buildings.reduce((n,p)=>({credits:n.credits+p.credits,gems:n.gems+p.gems,shards:n.shards+p.shards,tlm:n.tlm+p.tlm}),{credits:0,gems:0,shards:0,tlm:0}),x=_.find(n=>{var p;return(p=t==null?void 0:t.buildings)==null?void 0:p.some(A=>{var b;return A.building_name===((b=n==null?void 0:n.building_name)==null?void 0:b.toLowerCase())})})||_[0],o=t==null?void 0:t.buildings.find(n=>n.building_name===x.building_name.toLowerCase()),l=((o==null?void 0:o.boost_score)||0)/1e4,u=((a==null?void 0:a.tlm)??0)/1e4;return e.jsxs(H,{isSelected:s.asset_id===Number(g==null?void 0:g.asset_id),onClick:n=>I(n,{...s,...t}),children:[e.jsxs(U,{children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${s.data.planetName}_row-${s.data.y}-column-${s.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[s.data.name," (",s.data.x,":",s.data.y,")"]})]}),e.jsxs(Y,{children:[e.jsxs(y,{children:[e.jsx(Z,{}),e.jsx("span",{children:a==null?void 0:a.credits})]}),e.jsxs(y,{children:[e.jsx(ee,{}),e.jsx("span",{children:((a==null?void 0:a.tlm)??0)/1e3})]})]}),e.jsxs(q,{children:[e.jsxs(D,{disabled:!o,children:[e.jsx(G,{style:{width:`${l}%`,backgroundColor:l>80?"green":l>50?"yellow":"red"}}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${x.img}.png`,alt:o==null?void 0:o.building_name,title:o==null?void 0:o.building_name})]}),e.jsx(X,{disabled:u<=0||j===s.asset_id,isLoading:j===s.asset_id,color:"blue",onClick:n=>z(n,{...t,...s}),children:"Claim TLM"})]})]},s.asset_id)})})]})},me=f.memo(te);export{me as default};
