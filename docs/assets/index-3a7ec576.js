import{s,Q as b,u as p,g as ae,i as X,S as Z,T as ee,R as ne,_ as se,r as g,j as e}from"./index-7b5cda61.js";import{u as y}from"./useQuery-f852a306.js";import{A as oe}from"./atomic-api-f835b28e.js";import{f as u}from"./constants-06470205.js";import{F as K}from"./index.esm-44329a96.js";import"./toast-options-5d1fca6a.js";import"./iconBase-5ac6f144.js";const re=s("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"auto 1fr",gap:"10px",br:"15px",w:"100%",h:"100%",maxH:"calc(100vh - 160px)",variants:{isLandSelected:{true:{"@xmd":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@xmd":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lg":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),le=s("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),ce=s("div",{gridArea:"main",padding:"0px 18px",br:"15px",bg:"#141423",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}}}),_=s("div",{w:"100%",h:"45px",bg:"#201D2C",padding:"10px 20px",fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@sm":{h:"initial",fontSize:"14px"}}),de=s("div",{mt:"20px","@sm":{mt:"5px"}}),pe=s("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),xe=s("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),ge=s("button",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px"}}),me=s("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"69px",h:"69px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"100%",h:"auto"}}}),he=s("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"100%",mt:"10px","@sm":{}}),j=s("div",{d:"flex",w:"49%",h:"34px",gap:"2px",img:{objectFit:"contain",w:"34px",h:"34px",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@md":{w:"100%",span:{fontSize:"10px"}}}),O=s("div",{d:"flex",w:"100%",gap:"3px",mt:"6px",variants:{isSide:{true:{mt:"0px","@sm":{mt:"8px"}},false:{h:"100%"}}},"@sm":{gap:"3px",flexWrap:"wrap"}}),U=s("button",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"100%",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"45px"},variants:{isSide:{true:{justifyContent:"space-between",span:{position:"relative",top:"0px",left:"0px"},"&:first-child":{br:"0 0 0 15px",img:{br:"0 0 0 15px"}},"&:last-child":{br:"0 0 15px 0",img:{br:"0 0 15px 0"}},"@sm":{w:"24%"}}},disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),V=s("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}}),fe=s("div",{display:"flex",flexDirection:"column",gridArea:"side",padding:"0px 18px",br:"15px",bg:"#141423",overflowY:"auto",maxHeight:"calc(100vh - 160px)",minW:"500px",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}},"@lg":{minW:"initial"},"@sm":{mt:"5px"}}),ue=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",h:"45px",w:"100%",padding:"0px 18px",bg:"#242438",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{h:"initial",padding:"5px 10px",fs:"12px"}}),je=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",position:"relative",w:"100%",h:"125px",">img":{zIndex:1,objectFit:"contain",w:"80px","&:first-child":{w:"105%",h:"100%",objectFit:"cover",left:"-4px",top:"0px",position:"absolute"},"&:last-child":{br:"0 0 15px 0"}},span:{zIndex:2,textStroke:"2px #000",textShadow:"1px 1px 3px #000"},".question":{fs:"44px"},variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{">img":{h:"60px","&:first-child":{left:"-3px"}}}}),be=s("div",{d:"flex",w:"100%",direction:"column",img:{my:"20px",objectFit:"contain",w:"100%"},h3:{d:"flex",alignItems:"center",gap:"10px",fs:"16px",color:"#FFFFFF",mb:"15px"},"@sm":{pb:"20px",">img":{d:"none"}}}),G=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),C=s("div",{ff:"$heading",fs:"16px",color:"#FFFFFF",padding:"10px",br:"3px",bg:"#201D2C",mb:"10px",span:{color:"#FFB800"},"@sm":{fs:"12px"}}),ye=s("div",{d:"flex",gap:"3px",span:{w:"50%",ff:"$heading",fs:"13px",color:"#FFFFFF",padding:"5px 10px",br:"3px",bg:"#201D2C","&:last-child":{w:"100%"},"@sm":{fs:"10px"}}}),ve=s("div",{d:"flex",direction:"column",mt:"30px"}),Fe=s("h3",{color:"#FFFFFF","@sm":{fs:"12px"}}),we=s("p",{color:"#FFFFFF",ff:"$heading",fs:"16px",mt:"5px",padding:"5px 10px",br:"3px",bg:"#201D2C","@sm":{fs:"10px"}}),Se=s("div",{d:"flex",direction:"column",mt:"20px","@sm":{div:{top:"20px",left:"5px",fs:"10px"}}}),_e=s("div",{d:"flex",gap:"5px",mt:"30px"}),T=s("div",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",direction:"column",span:{d:"flex",alignItems:"center",justifyContent:"center",padding:"5px 10px",w:"100%",br:"5px 5px 0 0 ",color:"#FFFFFF",ff:"$heading",fs:"10px",fw:"$thin",bg:"#201D2C"}}),z=s("div",{d:"flex",alignItems:"center",justifyContent:"center",gap:"5px",padding:"5px",br:"0 0 5px 5px",w:"100%",color:"#FFFFFF",ff:"$heading",fs:"12px",fw:"normal",bg:"#1C1A26",img:{objectFit:"contain",w:"20px",my:"0px"}}),Ce=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),Te=s("div",{d:"flex",direction:"column",w:"100%",">p":{ff:"$heading",fs:"16px",color:"#FFFFFF",w:"100%",padding:"10px",br:"3px",bg:"#201D2C","@sm":{fs:"12px"}}}),ze=s("div",{d:"flex",gap:"10px",w:"100%"}),L=s("button",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative",w:"100%",h:"200px",span:{color:"#FFFFFF",ff:"$heading",fs:"16px",fw:"bold",zIndex:2},img:{objectFit:"contain",w:"80px",zIndex:2,"&:last-child":{zIndex:1,objectFit:"cover",w:"100%",h:"100%",my:"0px",top:0,left:0,position:"absolute"}}}),Le=s("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"}),Ie=()=>y({queryKey:[b.myLandsState],queryFn:()=>$e(),staleTime:1e3*60*60,enabled:!!p.getState().user});async function $e(){var r;try{const{getAssets:l}=new oe,t=await l({collection_name:"alien.worlds",schema_name:"land.worlds",owner:(r=p.getState().user)==null?void 0:r.name,page:1,limit:1e3,order:"desc",sort:"asset_id"});return Ae(t)}catch(l){return console.log(l),null}}function Ae(r){return r.map(l=>({...l,asset_id:Number(l.asset_id),data:{...l.data,planetName:l.data.name.split("on ")[1].toLowerCase()}}))}const I=["eyeke","kavian","veles","magor","neri","naron"],De=()=>y({queryKey:[b.allBuildingsState],queryFn:()=>Be(),staleTime:1e3*60*60,enabled:!!p.getState().user});async function Be(){try{const r={};for(let l=0;l<I.length;l++){const t=await ae(I[l]);if(t){const o=(t==null?void 0:t.filter(v=>{var n;return!!((n=v.buildings)!=null&&n.length)}))||[];r[I[l]]=o}}return r}catch(r){return console.log(r),null}}const Ne=async r=>await X({options:{code:Z.landsAle,index_position:1,limit:"1000",scope:r,table:ee.buildingcost}}),Ee=r=>y({queryFn:()=>qe(r),queryKey:[b.buildingConfigState],staleTime:1e3*60*60,enabled:!!p.getState().user});async function qe(r){try{return await Ne(r)}catch(l){return console.log(l),null}}const Me=async()=>await X({options:{code:Z.landsAle,index_position:1,limit:"1000",scope:"lands.ale",table:ee.CONFIG}}),Pe=()=>y({queryFn:()=>Re(),queryKey:[b.landConfigState],staleTime:1e3*60*60,enabled:!!p.getState().user});async function Re(){try{return await Me()}catch(r){return console.log(r),null}}const J=ne.lazy(()=>se(()=>import("./index-f0a7062b.js"),["assets/index-f0a7062b.js","assets/index-7b5cda61.js","assets/index-55fec1ff.css"])),We=ne.lazy(()=>se(()=>import("./index-22ab6768.js"),["assets/index-22ab6768.js","assets/index-7b5cda61.js","assets/index-55fec1ff.css","assets/index-420d12f0.js"])),Ve=()=>{var P,R,W,k,Q,Y,H;const{data:r}=Ie(),{data:l}=De(),{data:t}=Pe();p(i=>i.user);const[o,v]=g.useState(null),[n,$]=g.useState({...u[0],index:0}),{data:m}=Ee((n==null?void 0:n.img)||""),[F,A]=g.useState([0]);function te(i){var c,a;v(i),$({...(c=u)==null?void 0:c[0],...(a=i.buildings)==null?void 0:a[0],index:0})}const h=g.useMemo(()=>m==null?void 0:m.find(i=>i.building_name===n.img&&i.level===((n==null?void 0:n.level)||0)+1),[m,n]),ie=g.useMemo(()=>{var c,a;const i=((n==null?void 0:n.boost_score)||0)/1e4;return A([i]),(((c=t==null?void 0:t[0])==null?void 0:c.boost_base_cost)||0)+(((a=t==null?void 0:t[0])==null?void 0:a.boost_cost_first_percent)||0)*i},[t,n]),D=((P=t==null?void 0:t[0])==null?void 0:P.boost_base_cost)||0,B=((R=t==null?void 0:t[0])==null?void 0:R.boost_cost_first_percent)||0,N=(n==null?void 0:n.boost_score)||0,x=Number(((W=t==null?void 0:t[0])==null?void 0:W.boost_cost_mod)||0),E=(1-Math.pow(x,F[0]/1e4+1))/(1-x),q=(1-Math.pow(x,N/1e4+1))/(1-x),M=D+B*(E-q);return console.log({boost_base_cost:D,boost_cost_first_percent:B,current_boost:N,term1:E,term2:q,config_cost:x,sliderValue:F[0],credit_total_cost:M}),e.jsxs(re,{isLandSelected:!!o,children:[e.jsxs(le,{children:[o&&(n==null?void 0:n.building_name)&&e.jsxs(J,{children:["Boost"," ",e.jsxs("div",{children:[ie.toLocaleString("en-US")," ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})," "]})]}),o&&h&&e.jsxs(J,{children:["Build ",n.name,e.jsxs("div",{children:[(k=h==null?void 0:h.cost_gem)==null?void 0:k.toLocaleString("en-US")," ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})]})]})]}),e.jsxs(ce,{isLandSelected:!o,children:[e.jsx(_,{children:"My Lands"}),e.jsxs(de,{children:[e.jsxs(pe,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(xe,{children:r==null?void 0:r.map(i=>{const c=l==null?void 0:l[i.data.planetName].find(a=>a.x===i.data.x&&a.y===i.data.y);return e.jsxs(ge,{isSelected:i.asset_id===Number(o==null?void 0:o.asset_id),onClick:()=>te({...i,...c}),children:[e.jsxs(me,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),e.jsxs("span",{children:[i.data.name," (",i.data.x,":",i.data.y,")"]})]}),e.jsxs(he,{children:[e.jsxs(j,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/dust.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(j,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(j,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(j,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:"76.1253"})]})]}),e.jsx(O,{isSide:!1,children:u.map((a,w)=>{const d=c==null?void 0:c.buildings.find(S=>S.building_name===a.name.toLowerCase()),f=((d==null?void 0:d.boost_score)||0)/1e4;return e.jsxs(U,{disabled:!c||!d,children:[e.jsx(V,{style:{width:`${f}%`}}),e.jsx("span",{children:d==null?void 0:d.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${a.img}.png`,alt:a.name,title:a.name})]},w)})})]},i.asset_id)})})]})]}),e.jsx(fe,{isLandSelected:!!o,children:o?e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[(Q=o==null?void 0:o.data)==null?void 0:Q.name," (",o==null?void 0:o.data.x,":",o==null?void 0:o.data.y,")"]}),e.jsx(O,{isSide:!0,children:u.map((i,c)=>{var d,f;const a=(d=o==null?void 0:o.buildings)==null?void 0:d.find(S=>S.building_name===i.name.toLowerCase()),w=((a==null?void 0:a.boost_score)||0)/1e4;return e.jsxs(U,{isSide:!0,disabled:!a,onClick:()=>$({...i,...a,index:c}),children:[e.jsx(V,{style:{width:`${w}%`}}),e.jsx(ue,{isSelected:((f=n==null?void 0:n.name)==null?void 0:f.toLowerCase())===i.name.toLowerCase(),children:c===0&&!a?"Primary Building":i.name}),e.jsxs(je,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),c===0&&!a?e.jsx("span",{className:"question",children:"?"}):e.jsx("img",{loading:"lazy",src:`/assets/buildings/${i.img}.png`,alt:i.name,title:i.name}),e.jsxs("span",{children:[" ",(a==null?void 0:a.level)!==void 0?`Level ${a==null?void 0:a.level}`:""]})]})]},c)})}),e.jsx(be,{children:n!=null&&n.building_name?e.jsxs(e.Fragment,{children:[e.jsxs(G,{children:[e.jsx(C,{children:"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost."}),e.jsxs(ye,{children:[e.jsx("span",{children:"Next Level"}),e.jsx("span",{children:"Selection Frequency +20%"})]})]}),e.jsxs(ve,{children:[e.jsx(Fe,{children:"Building Boost"}),e.jsx(we,{children:"Boosting a building raises its perks, but usage and time reduce boost levels. If boost drops below 1%, the building becomes unusable."}),e.jsx(Se,{children:e.jsx(We,{onValueChange:A,value:F})})]}),e.jsxs(_e,{children:[e.jsxs(T,{children:[e.jsx("span",{children:"Total Cost"}),e.jsxs(z,{children:[M.toFixed(2),e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(T,{children:[e.jsx("span",{children:"Cost per 1%"}),e.jsxs(z,{children:[Number((Y=t==null?void 0:t[0])==null?void 0:Y.boost_cost_mod).toFixed(2)||0,e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(T,{children:[e.jsx("span",{children:"Start Score"}),e.jsxs(z,{children:[(((H=t==null?void 0:t[0])==null?void 0:H.start_boost_score)||0)/1e4,"%"]})]})]}),e.jsx("img",{loading:"lazy",src:"/assets/mock/building.png",alt:"Land"})]}):n.index==0?e.jsxs(Ce,{children:[e.jsx("h3",{children:"Select Primary Building"}),e.jsxs(Te,{children:[e.jsx("p",{children:"You can only have one primary building on your land"}),e.jsxs(ze,{children:[e.jsxs(L,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs(L,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs(L,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]})]})]}),e.jsxs(C,{children:[e.jsxs("h3",{children:[e.jsx(K,{size:30})," ",n==null?void 0:n.name," Information"]}),"In a ",n==null?void 0:n.name," players can recruit new fighters to their team. Landowners earn ",e.jsx("span",{children:"Shards"})," each time a trainer recruits a fighter on their land."]})]}):e.jsx(G,{children:e.jsxs(C,{children:[e.jsxs("h3",{children:[e.jsx(K,{size:30})," ",n==null?void 0:n.name," Information"]}),"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost.In an ",n==null?void 0:n.name," players can ascend their fighters for",e.jsx("span",{children:" credits"})," or ",e.jsx("span",{children:"gems"}),". You will receive a portion of the spent currency."]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{children:"Select a Land"}),e.jsx(Le,{children:"Select a Land"})]})})]})};export{Ve as default};
