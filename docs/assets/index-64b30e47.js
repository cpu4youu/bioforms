import{s as a,L as u,g as m,S as o,e as h,u as c,R as b,_ as j,r as v,j as e,Q as w}from"./index-2299b609.js";import{s as y}from"./shimmer-cc661684.js";import{s as C}from"./sleep-da79c358.js";import{u as T}from"./useQuery-7955553e.js";import{u as R}from"./use-transaction-ec97b431.js";import"./toast-options-02c06cad.js";const L=a("div",{d:"grid",gridTemplateAreas:`
    "empty header"
    "main main"
  `,gridTemplateRows:"68px 1fr",gridTemplateColumns:"3fr 1fr",gap:"10px",br:"15px",w:"100%",h:"100%"}),A=a("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}}}),_=a("div",{gridArea:"main",position:"relative",d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-center",justifyContent:"flex-center",w:"100%",minH:"calc(100vh - 160px)",maxH:"calc(100vh - 160px)",gap:"10px",padding:"10px",br:"0 15px 15px 15px",bg:"#141423","@md":{h:"calc(100vh - 175px)",direction:"column"}}),I=a("div",{d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-center",justifyContent:"flex-center",br:"15px 15px 0 0",bg:"#19192D",position:"absolute",top:"-35px",left:"0"}),S=a(u,{border:"1px solid rgba(0, 0, 0, 0.25)",padding:"10px 20px",color:"#fff",fs:"12px",ff:"$heading","&:last-child":{br:"15px 15px 0 0"}}),D=a("div",{d:"flex",direction:"column",w:"100%",padding:"24px 30px",minH:"calc(100vh - 175px)",maxH:"calc(100vh - 175px)",overflowY:"auto","@md":{padding:"14px 0px",h:"unset"}}),E=a("span",{d:"flex",justifyContent:"center",w:"100%",color:"#fff",fs:"16px",ff:"$heading"}),$=a("div",{d:"flex",gap:"5px",flexWrap:"wrap",mt:"20px",w:"100%"});a("div",{d:"flex",alignItems:"center",gap:"3px",w:"100%",span:{d:"flex",alignItems:"center",justifyContent:"center",h:"34px",bg:"rgba(255, 255, 255, 0.03)",color:"#fff",ff:"$heading",fs:"16px",fontWeight:500}});const x=a("div",{d:"grid",gridColumnStart:3,gridTemplateColumns:"32px 72px minmax(200px, .3fr) minmax(200px, 3fr)",alignItems:"center",gap:"3px",w:"100%",">span":{d:"flex",alignItems:"center",h:"34px",bg:"rgba(255, 255, 255, 0.03)",padding:"0 5px 0 5px",color:"#fff",ff:"$heading",fs:"16px",fontWeight:500,"&:first-of-type":{justifyContent:"center"}}}),k=a("div",{h:"72px",d:"flex",alignItems:"center",justifyContent:"center",bg:"rgba(255, 255, 255, 0.06)",color:"#fff",ff:"$heading",fs:"16px"}),H=a("div",{h:"72px",d:"flex",alignItems:"center",justifyContent:"center",bg:"rgba(255, 255, 255, 0.06)",color:"#fff",ff:"$heading",fs:"16px"}),W=a("div",{h:"72px",d:"flex",alignItems:"center",gap:"10px",bg:"rgba(255, 255, 255, 0.06)",padding:"2px 10px 2px 2px",color:"#fff",ff:"$heading",fs:"16px",img:{w:"68px",h:"68px"}}),z=a("div",{h:"72px",d:"flex",alignItems:"center",bg:"rgba(255, 255, 255, 0.06)",color:"#fff",ff:"$heading",fs:"16px",pl:"12px"}),F=a("div",{w:"96px",h:"96px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.25) ,rgba(255, 255, 255, 0.15))",br:"10px",backgroundSize:"400% 400%",animation:`${y} 1.2s ease-in-out infinite`,"@sm":{width:"70px",height:"100px"}}),O=async()=>await m({options:{code:o.dungeonsAle,index_position:1,limit:"1000",scope:o.dungeonsAle,table:"leaderboard"}}),P=()=>T({queryKey:[h.LeaderboardState],queryFn:()=>Q(),staleTime:1e3*60*20,enabled:!!c.getState().user});async function Q(){try{const n=await O();return n?n.toSorted((s,r)=>r.rating-s.rating):null}catch(n){return console.log(n),null}}async function G({user:n}){const{executeTransaction:s}=R(),r=M({user:n});return!!await s(r)}function M({user:n}){return{actions:[{account:o.dungeonsAle,name:"lbclaim",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{wallet:n.name}}]}}const N=b.lazy(()=>j(()=>import("./index-7180f1bc.js"),["assets/index-7180f1bc.js","assets/index-2299b609.js","assets/index-55fec1ff.css","assets/index-a0b3ce52.js"])),J=()=>{const n=c(({user:t})=>t),s=c(({updatePlayerData:t})=>t),{data:r,isLoading:d}=P(),[l,p]=v.useState(!1);async function f(){try{if(p(!0),!await G({user:n}))return;await C(3e3),await s(),w.success("Rewards claimed successfully!");return}catch(t){console.error(t)}finally{p(!1)}}return e.jsxs(L,{children:[e.jsx(A,{children:e.jsxs(N,{isLoading:l,disabled:l,onClick:f,children:[e.jsx("img",{src:"/assets/icons/chest.png",alt:"chest"}),"Claim Rewards"]})}),e.jsxs(_,{children:[e.jsx(I,{children:e.jsx(S,{to:"/home",children:"Dungeon"})}),e.jsxs(D,{children:[e.jsx(E,{children:"DUNGEON LEADERBOARD"}),e.jsx($,{children:d?new Array(3).fill(0).map((t,i)=>e.jsx(F,{},i)):e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsx("p",{}),e.jsx("span",{children:"Rank"}),e.jsx("span",{children:"Gamertag"}),e.jsx("span",{children:"Rating"})]}),r==null?void 0:r.map((t,i)=>e.jsxs(x,{children:[e.jsx(k,{children:i<3&&e.jsx("img",{src:"/assets/icons/chest.png",alt:"chest"})}),e.jsx(H,{children:i+1}),e.jsxs(W,{children:[e.jsx("img",{src:`/assets/avatar/avatar_${t.avatar}.jpeg`,alt:t.gamertag,onError:g=>{g.currentTarget.src="/assets/avatar/unknown.jpeg"}}),e.jsx("span",{children:t.gamertag})]}),e.jsx(z,{children:t.rating})]},t.gamertag)),"`"]})})]})]})]})};export{J as default};
