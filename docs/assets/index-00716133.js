import{s as c,S as w,c as T,a as y,R as F,_ as S,u as A,r as v,j as e}from"./index-52528459.js";import{u as C}from"./index-c5457dfc.js";import{F as E}from"./index-9eebd590.js";import{u as I}from"./use-media-5f094bbc.js";import{u as z}from"./index-d71fe0b6.js";import{s as D}from"./sleep-da79c358.js";import{u as W}from"./use-transaction-0199cffb.js";const R=c("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"auto 1fr",gap:"10px",br:"15px",w:"100%",h:"100%",variants:{isFighterSelected:{true:{"@lg":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@lgxxx":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lgxxx":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),M=c("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}},"&:nth-child(1)":{display:"none"},"&:nth-child(2)":{display:"none"}},"@lgxxx":{button:{"&:nth-child(1)":{display:"flex"},"&:nth-child(2)":{display:"flex"}}},"@md":{button:{"&:nth-child(1)":{display:"none"},"&:nth-child(2)":{display:"none"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),L=c("div",{gridArea:"main",d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-center",justifyContent:"flex-center",gap:"10px",flexWrap:"wrap",h:"calc(100vh - 235px)",minH:"calc(100vh - 160px)",overflowY:"auto",padding:"10px",br:"15px",bg:"#141423",variants:{isFighterSelected:{true:{"@lg":{display:"none"},"@xmd":{display:"none"}}}}}),N=c("div",{gridArea:"main",d:"flex",justify:"space-between",gap:"5px",w:"100%",px:"20px",">span":{mt:"55px",color:"#fff",fw:"bold",ff:"$heading",fs:"12px"},"@xlg":{justify:"center",flexWrap:"wrap",">span":{my:"25px"}},variants:{isFighterSelected:{true:{justify:"center",flexWrap:"wrap",">span":{my:"25px"}}}}}),O=c("h3",{textAlign:"center",w:"100%",fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@sm":{fontSize:"14px"}}),P=c("span",{textAlign:"center",w:"100%",fontSize:"16px",ff:"$heading",color:"#C9C9C9","@sm":{h:"initial",fontSize:"14px"}}),V=c("div",{display:"flex",flexDirection:"column",gridArea:"side",padding:"0px 18px",br:"15px",bg:"#141423",overflowY:"auto",maxH:"calc(100vh - 160px)",minW:"500px",variants:{isFighterSelected:{false:{"@lgxxx":{display:"none"}}}},"@lgxxx":{minW:"initial"},"@sm":{mt:"5px"}}),H=c("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"});async function $(t,n,p,i,l,s,a,d){const{executeTransaction:r}=W(),x=k(t,n,p,i,l,s,a,d);return!!await r(x)}function k(t,n,p,i,l,s,a,d){return{actions:[{account:w.dungeonsAle,name:"playdungeon",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,planet:n,land_id:p,crew_asset_id:i,weapon_asset_id:l,fighter_ids:s,difficulty:a,use_gems:d}}]}}const B=T(t=>({myTeam:[null,null,null,null,null],setMyTeam:n=>t({myTeam:n}),selectedCards:[void 0,void 0],setSelectedCards:n=>t({selectedCards:n})}));function Y({user:t,areaSelected:n,myTeam:p,selectedCards:i,selectedLevel:l}){var a,d,r,x,u,f,g,m;const s=p.reduce((h,_)=>_?[...h,_.fighter_id]:h,[]);return!t||!(n!=null&&n.landId)||!s.length||!((a=i[0])!=null&&a.asset_id)||!((d=i[1])!=null&&d.asset_id)?(s.length||y.error("No Warrior selected"),(r=i[0])!=null&&r.asset_id||y.error("No Crew selected (First spot on cards)"),(x=i[1])!=null&&x.asset_id||y.error("No Weapon selected (Second spot on cards)"),console.error("Can not find data",{user:t,areaSelected:n,crew_asset_id:Number((u=i[0])==null?void 0:u.asset_id),weapon_asset_id:Number((f=i[1])==null?void 0:f.asset_id),fighter_ids:s,selectedLevel:l})):{user:t,planet:t.planet,landId:n.landId,card1:Number((g=i[0])==null?void 0:g.asset_id),card2:Number((m=i[1])==null?void 0:m.asset_id),teamFiltered:s,level:l.level}}const b=F.lazy(()=>S(()=>import("./index-29423a27.js"),["assets/index-29423a27.js","assets/index-52528459.js","assets/index-55fec1ff.css"])),q=F.lazy(()=>S(()=>import("./index-b7a8a22d.js"),["assets/index-b7a8a22d.js","assets/index-52528459.js","assets/index-55fec1ff.css","assets/index-d71fe0b6.js","assets/fighters-query-bcf492a4.js","assets/useQuery-a77f3a69.js","assets/dungeons-query-59062da4.js","assets/v4-4a60fe23.js","assets/index-c5457dfc.js","assets/index-9eebd590.js","assets/use-media-5f094bbc.js","assets/sleep-da79c358.js","assets/use-transaction-0199cffb.js","assets/toast-options-a79bf299.js"])),G=F.lazy(()=>S(()=>import("./index-0adba0f0.js"),["assets/index-0adba0f0.js","assets/index-52528459.js","assets/index-55fec1ff.css","assets/fighters-query-bcf492a4.js","assets/useQuery-a77f3a69.js","assets/index-c5457dfc.js","assets/index-29423a27.js","assets/use-media-5f094bbc.js","assets/inventory-query-84e8e847.js","assets/atomic-api-a23fb87b.js","assets/toast-options-a79bf299.js","assets/v4-4a60fe23.js","assets/index-9eebd590.js","assets/index-d71fe0b6.js","assets/sleep-da79c358.js","assets/use-transaction-0199cffb.js"])),Q=F.lazy(()=>S(()=>import("./index-4414a696.js"),["assets/index-4414a696.js","assets/index-52528459.js","assets/index-55fec1ff.css","assets/dungeons-query-59062da4.js","assets/useQuery-a77f3a69.js","assets/index-d71fe0b6.js","assets/fighters-query-bcf492a4.js","assets/index-c5457dfc.js","assets/v4-4a60fe23.js"])),J=()=>{const{selectedCards:t,myTeam:n,setMyTeam:p,setSelectedCards:i}=B(),{areaSelected:l,setAreaSelected:s}=z(),a=A(o=>o.user),{selectedLevel:d,selectedFighter:r,setSelectedFighter:x}=C(),{isSuperLarge:u}=I(),[f,g]=v.useState(!1),[m,h]=v.useState(!1);async function _(){try{g(!0);const o=Y({areaSelected:l,myTeam:n,selectedCards:t,selectedLevel:d,user:a});if(!o||!await $(a,a.planet,o.landId,o.card1,o.card2,o.teamFiltered,o.level,!0))return;await D(2e3),h(!0),y.success("Fight Started !"),j()}catch(o){console.error(o)}finally{g(!1)}}function j(){i([void 0,void 0]),p([null,null,null,null,null]),s(null)}return m?e.jsx(q,{}):e.jsxs(R,{isFighterSelected:!!r,children:[e.jsxs(M,{children:[e.jsx("button",{}),e.jsx("button",{}),e.jsx(b,{onClick:j,children:"Back"}),e.jsxs(b,{isLoading:f,onClick:_,children:["Start Fight",e.jsxs("div",{children:["-32",e.jsx("img",{src:"/assets/icons/potion.png",alt:"Potion"})]})]})]}),e.jsxs(L,{isFighterSelected:!!r,children:[e.jsx(O,{children:"Weather"}),e.jsx(P,{children:"+20% Gem Damage"}),e.jsxs(N,{isFighterSelected:u&&!!r,children:[e.jsx(G,{}),e.jsx("span",{children:"VS"}),e.jsx(Q,{})]})]}),e.jsx(V,{isFighterSelected:!!r,children:r?e.jsx(E,{selectedFighter:r,onCloseFighterDetail:x}):e.jsx(e.Fragment,{children:e.jsx(H,{children:"Select a Fighter"})})})]})},re=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{re as i,B as u};
