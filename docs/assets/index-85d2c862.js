import{s as i,S as R,R as f,_ as C,u as B,j as e}from"./index-95badb9d.js";import{a as $,u as M,o as W}from"./land-config-7a4e9d0f.js";import{u as E,o as O}from"./all-buildings-fbefc695.js";import{f as j,n as P}from"./constants-b95c644e.js";import{u as N}from"./index-e608cf42.js";import{u as V}from"./use-transaction-24f280e0.js";import{s as k}from"./sleep-da79c358.js";import"./useQuery-f88ad52f.js";import"./atomic-api-b7d8ac78.js";import"./toast-options-be3620b7.js";const D=i("div",{mt:"20px","@sm":{mt:"5px"}}),Q=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),H=i("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),U=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),Y=i("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}},variants:{rarity:{common:{span:{color:"#C9C9C9"}},rare:{span:{color:"#4DCFFF"}},epic:{span:{color:"#B84FFF"}},legendary:{span:{color:"#FFD700"}}}}}),q=i("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),b=i("div",{d:"flex",w:"49%",h:"100%",gap:"2px","img, svg":{px:"5px",objectFit:"contain",minW:"54px",maxW:"54px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto","img, svg":{minW:"34px",maxW:"34px"},span:{fontSize:"10px"}}}),G=i("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),J=i("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),K=i("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function X(c,r){const{executeTransaction:l}=V(),m=Z(c,r);return!!await l(m)}function Z(c,r){return{actions:[{account:R.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const ee=f.lazy(()=>C(()=>import("./index-1d0508ce.js"),["assets/index-1d0508ce.js","assets/index-95badb9d.js","assets/index-55fec1ff.css","assets/index-3664244c.js"])),te=f.lazy(()=>C(()=>import("./shards-cf68d125.js"),["assets/shards-cf68d125.js","assets/index-95badb9d.js","assets/index-55fec1ff.css"])),se=f.lazy(()=>C(()=>import("./tlm-c0a361da.js"),["assets/tlm-c0a361da.js","assets/index-95badb9d.js","assets/index-55fec1ff.css"])),ne=()=>{const c=B(t=>t.user),{data:r}=$(),{data:l}=E(),{data:m}=M(),{selectedLand:g,setBuildingBoost:v,setSelectedBuild:L,setSelectedLand:S,setIsBuildMenuOpen:T,setIsDestroying:I}=N(),[_,y]=f.useState(null);function z(t,s){var h,x,o,d;S(s);let a={...j[0]};if(s.buildings){a={...(h=s.buildings)==null?void 0:h[0],img:(o=(x=s.buildings)==null?void 0:x[0])==null?void 0:o.building_name};const u=((a==null?void 0:a.boost_score)||0)/1e4,n=(((d=m==null?void 0:m[0])==null?void 0:d.start_boost_score)||0)/1e4;v([u<n?n:u])}L(a),I(!1),T(!0)}async function A(t,s){t.stopPropagation();try{y(s.asset_id),await X(c,{planet:s.data.planetName,x:s.data.x,y:s.data.y})&&(await k(2e3),await W(),await O())}catch(a){console.error(a)}finally{y(null)}}return e.jsxs(D,{children:[e.jsxs(Q,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(H,{children:r==null?void 0:r.map(t=>{const s=l==null?void 0:l[t.data.planetName].find(n=>n.x===t.data.x&&n.y===t.data.y),a=s==null?void 0:s.buildings.reduce((n,p)=>({credits:n.credits+p.credits,gems:n.gems+p.gems,shards:n.shards+p.shards,tlm:n.tlm+p.tlm}),{credits:0,gems:0,shards:0,tlm:0}),x=j.find(n=>{var p;return(p=s==null?void 0:s.buildings)==null?void 0:p.some(F=>{var w;return F.building_name===((w=n==null?void 0:n.building_name)==null?void 0:w.toLowerCase())})})||P,o=s==null?void 0:s.buildings.find(n=>n.building_name===x.building_name.toLowerCase()),d=((o==null?void 0:o.boost_score)||0)/1e4,u=((a==null?void 0:a.tlm)??0)/1e4;return e.jsxs(U,{isSelected:t.asset_id===Number(g==null?void 0:g.asset_id),onClick:n=>z(n,{...t,...s}),children:[e.jsxs(Y,{rarity:t.data.rarity.toLocaleLowerCase(),children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${t.data.planetName}_row-${t.data.y}-column-${t.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[t.data.name," (",t.data.x,":",t.data.y,")"]})]}),e.jsxs(q,{children:[e.jsxs(b,{children:[e.jsx(te,{}),e.jsx("span",{children:a==null?void 0:a.credits})]}),e.jsxs(b,{children:[e.jsx(se,{}),e.jsx("span",{children:((a==null?void 0:a.tlm)??0)/1e3})]})]}),e.jsxs(G,{children:[e.jsxs(J,{disabled:!o,children:[e.jsx(K,{style:{width:`${d}%`,backgroundColor:d>80?"green":d>50?"yellow":"red"}}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${x.img}.png`,alt:o==null?void 0:o.building_name,title:o==null?void 0:o.building_name})]}),e.jsx(ee,{disabled:u<=0||_===t.asset_id,isLoading:_===t.asset_id,color:"blue",onClick:n=>A(n,{...s,...t}),children:"Claim TLM"})]})]},t.asset_id)})})]})},fe=f.memo(ne);export{fe as default};
