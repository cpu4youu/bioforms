import{s as o,S as I,R as u,_ as A,u as $,j as e}from"./index-c378eb06.js";import{u as R,b as B,o as M,a as N}from"./all-buildings-354bd669.js";import{f as g}from"./constants-9b21425a.js";import{u as W}from"./index-bd414545.js";import{u as F}from"./use-transaction-3adaf42b.js";import{s as O}from"./sleep-da79c358.js";import"./useQuery-4887d7e5.js";import"./atomic-api-929dd3e6.js";import"./toast-options-38216f5d.js";const P=o("div",{mt:"20px","@sm":{mt:"5px"}}),E=o("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),k=o("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),Q=o("button",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),V=o("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}}}),H=o("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),b=o("div",{d:"flex",w:"49%",h:"100%",gap:"2px",img:{objectFit:"contain",w:"34px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto",span:{fontSize:"10px"}}}),U=o("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),Y=o("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),q=o("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function G(c,r){const{executeTransaction:p}=F(),d=J(c,r);return!!await p(d)}function J(c,r){return{actions:[{account:I.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const K=u.lazy(()=>A(()=>import("./index-b2bdc562.js"),["assets/index-b2bdc562.js","assets/index-c378eb06.js","assets/index-55fec1ff.css"])),X=()=>{const c=$(s=>s.user),{data:r}=R(),{data:p}=B(),{selectedLand:d,setBuildingBoost:h,setSelectedBuild:y,setSelectedLand:_,setIsBuildMenuOpen:v}=W(),[j,C]=u.useState(null);function S(s,t){var x,m,i;_(t);let n={...g[0]};if(t.buildings){n={...(x=t.buildings)==null?void 0:x[0],img:(i=(m=t.buildings)==null?void 0:m[0])==null?void 0:i.building_name};const f=((n==null?void 0:n.boost_score)||0)/1e4;h([f])}y(n),v(!0)}async function T(s,t){s.stopPropagation();try{C(t.asset_id),await G(c,{planet:t.data.planetName,x:t.data.x,y:t.data.y})&&(await O(2e3),await M(),await N())}catch(n){console.error(n)}finally{C(null)}}return e.jsxs(P,{children:[e.jsxs(E,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(k,{children:r==null?void 0:r.map(s=>{const t=p==null?void 0:p[s.data.planetName].find(a=>a.x===s.data.x&&a.y===s.data.y),n=t==null?void 0:t.buildings.reduce((a,l)=>({credits:a.credits+l.credits,gems:a.gems+l.gems,shards:a.shards+l.shards,tlm:a.tlm+l.tlm}),{credits:0,gems:0,shards:0,tlm:0}),m=g.find(a=>{var l;return(l=t==null?void 0:t.buildings)==null?void 0:l.some(z=>{var w;return z.building_name===((w=a==null?void 0:a.building_name)==null?void 0:w.toLowerCase())})})||g[0],i=t==null?void 0:t.buildings.find(a=>a.building_name===m.building_name.toLowerCase()),f=((i==null?void 0:i.boost_score)||0)/1e4,L=((n==null?void 0:n.tlm)??0)/1e4;return e.jsxs(Q,{isSelected:s.asset_id===Number(d==null?void 0:d.asset_id),onClick:a=>S(a,{...s,...t}),children:[e.jsxs(V,{children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${s.data.planetName}_row-${s.data.y}-column-${s.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[s.data.name," (",s.data.x,":",s.data.y,")"]})]}),e.jsxs(H,{children:[e.jsxs(b,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:n==null?void 0:n.credits})]}),e.jsxs(b,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:((n==null?void 0:n.tlm)??0)/1e3})]})]}),e.jsxs(U,{children:[e.jsxs(Y,{disabled:!i,children:[e.jsx(q,{style:{width:`${f}%`}}),e.jsx("span",{children:i==null?void 0:i.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${m.img}.png`,alt:i==null?void 0:i.building_name,title:i==null?void 0:i.building_name})]}),e.jsx(K,{disabled:L<=0||j===s.asset_id,isLoading:j===s.asset_id,color:"blue",onClick:a=>T(a,{...t,...s}),children:"Claim TLM"})]})]},s.asset_id)})})]})},re=u.memo(X);export{re as default};
