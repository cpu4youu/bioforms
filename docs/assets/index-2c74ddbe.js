import{s as a,g as v,S as d,q as w,d as b,u as h,R as S,_ as L,r as T,j as e,Q as u}from"./index-4034d623.js";import{u as A}from"./index-cce2017a.js";import{s as C}from"./index-585f9113.js";import{u as P,e as F}from"./index-b68e7270.js";import{s as R}from"./sleep-da79c358.js";import{o as E}from"./fighters-query-a752de7e.js";import{u as z}from"./useQuery-66878643.js";import"./use-transaction-c828b2ca.js";import"./toast-options-5544c8ed.js";const D=a("div",{display:"flex",h:"175px",w:"100%",maxW:"375px",gap:"8px",padding:"5px",position:"relative",">img":{zIndex:"1",position:"absolute",top:"0",left:"0",w:"100%",h:"100%"}}),$=a("div",{display:"flex",gap:"10px",zIndex:"2"}),B=a("div",{display:"flex",bg:"#282828",br:"3px 3px 5px",w:"12px",h:"100%",div:{display:"flex",br:"3px 3px 5px",w:"100%",mt:"auto",background:"green"}}),M=a("div",{w:"55px",h:"157px",overflow:"hidden",br:"10px",img:{w:"55px",h:"157px",objectPosition:"top",objectFit:"cover"}}),k=a("div",{display:"flex",direction:"column",zIndex:"2",w:"210px",br:"3px",bg:"rgba(0, 0, 0, 0.3)",padding:"10px",p:{fs:"10px",textShadow:"1px 1px 3px #000",color:"white"}}),q=a("div",{display:"flex",color:"white",textShadow:"1px 1px 3px #000",fs:"16px"}),I=a("div",{display:"flex",color:"white",fs:"10px",textShadow:"1px 1px 3px #000"}),Q=a("div",{display:"flex",justifyContent:"space-between",color:"white",textTransform:"capitalize",textShadow:"1px 1px 3px #000",fs:"10px"}),U=a("div",{display:"grid",gridTemplateRows:"repeat(3,1fr)",gap:"5px",zIndex:"2",button:{fs:"10px",padding:"5px 10px"}}),N=async()=>{const s=await v({options:{code:d.battleAle,index_position:1,limit:"1000",scope:d.battleAle,table:w.config}});return(s==null?void 0:s[0])||null},K=()=>z({queryKey:[b.BattleConfigState],queryFn:()=>O(),staleTime:1e3*60*60,enabled:!!h.getState().user});async function O(){try{return await N()}catch(s){return console.log(s),null}}const m=S.lazy(()=>L(()=>import("./index-8e185a16.js"),["assets/index-8e185a16.js","assets/index-4034d623.js","assets/index-55fec1ff.css"])),se=({fighter:s})=>{const n=s.stats,{setSelectedFighter:y}=A(),{data:r}=P(),{data:l}=K(),i=h(t=>t.user),[c,p]=T.useState(!1);async function g(){const t=r==null?void 0:r.find(o=>o.level===s.stats.level);try{if(p(!0),!t){u.error("No level find on levels table");return}if(!await F(i,{cost_credits:t==null?void 0:t.unlock_cost_credits,cost_gems:t==null?void 0:t.unlock_cost_gem,fighter_ids:[s.fighter_id]}))return;await R(2e3),E(i.name),u.success("Fighter leveled up!")}catch(o){console.error(o)}finally{p(!1)}}const j=Math.floor((Date.now()-new Date(s.creation_date).getTime())/(1e3*60*60*24)),_=((l==null?void 0:l.age_penaly_percent_day)??0)/100||0,f=Math.floor(j*_);return e.jsxs(D,{onClick:()=>y(s),children:[e.jsxs($,{children:[e.jsx(B,{children:e.jsx("div",{style:{height:"100%"}})}),e.jsx(M,{children:e.jsx("img",{src:`/assets/fighter/full_${s.racename}_${s.classname}_${s.element}.jpeg`,alt:"",loading:"lazy"})})]}),e.jsxs(k,{children:[e.jsxs(q,{children:[s.racename," ",s.classname]}),e.jsxs(I,{children:[e.jsxs("span",{children:["Level: ",n.level]}),e.jsxs("span",{children:["XP: ",s.stats.experience,"/",s.stats.required_experience]})]}),e.jsxs("p",{children:["Element: ",s.element]}),e.jsxs("p",{children:["Age Penalty: ",e.jsxs("span",{children:["-",f,"%"]})]}),C.map(t=>{const o=(n==null?void 0:n[`${t}_min`])??0,x=(n==null?void 0:n[`${t}_max`])??0;return e.jsxs(Q,{children:[e.jsxs("strong",{children:[t,":"]}),e.jsx("span",{children:e.jsxs("span",{children:[e.jsxs("span",{children:[Math.floor((o+x)/2)," "]}),e.jsxs("span",{children:[" (+-",Math.floor(Math.abs(x-o)/2),")"]})]})})]},t)})]}),e.jsxs(U,{children:[e.jsx(m,{isLoading:c,disabled:c||s.stats.experience<s.stats.required_experience,onClick:g,children:"Level up"}),e.jsx(m,{children:"Pay"})]}),e.jsx("img",{src:`/assets/elements/${s.element}.jpeg`,alt:""})]})};export{se as default};
