import{s as x,d as Y,r as b,S as z,g as B,e as $,u as V,R as m,_ as f,a as q,b as K,j as t,Q as A}from"./index-9a1d8aef.js";import{s as U,u as G}from"./fightersSort-bd534b61.js";import{u as J}from"./use-transaction-020c76e2.js";import{u as X,g as O,a as Z}from"./weather-query-be6bd8b8.js";import{u as ee}from"./useQuery-e3635f16.js";import{u as te}from"./landtranking-query-5c3d6c25.js";const re=x("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"65px 1fr",gridTemplateColumns:"1fr 1fr 500px",gap:"10px",overflowY:"hidden",br:"15px",w:"100%",h:"100%",variants:{isFighterSelected:{true:{"@lg":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@lgxxx":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lgxxx":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),ne=x("div",{gridArea:"header",d:"grid",justifyContent:"end",gridTemplateColumns:"200px 200px",gap:"10px",minHeight:"65px",button:{padding:"20px",height:"65px",w:"100%",maxW:"100%",span:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@lgxxx":{gridColumnStart:3,w:"100%"},"@md":{gridColumnStart:1,gridTemplateColumns:"1fr 1fr"},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),se=x("div",{display:"flex",flexDirection:"column",gridArea:"side",br:"15px",bg:"#141423",overflowY:"auto",minW:"500px",maxW:"500px",maxH:"calc(100vh - 160px)",minH:"calc(100vh - 160px)",variants:{isFighterSelected:{false:{"@lgxxx":{display:"none"}}}},"@lgxxx":{minW:"initial"},"@sm":{mt:"5px"}}),ae=x("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",padding:"0px 15px ",bg:"#141423",br:"15px",w:"100%",overflowY:"auto",position:"relative",">img":{position:"absolute",top:0,left:0,w:"100%",h:"100%",objectFit:"cover"},gridArea:"main",h:"calc(100vh - 235px)",minH:"calc(100vh - 160px)",maxH:"calc(100vh - 160px)",variants:{isFighterSelected:{true:{"@lg":{display:"none"},"@xmd":{display:"none"}}}},"@md":{minH:"calc(100vh - 185px)",mt:"30px"}}),ie=x("div",{d:"flex",align:"center",justify:"center",w:"100%",maxW:"350px",padding:"15px 10px",zIndex:"2",boxShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)",bg:"#1D1B20",color:"#E9E9E9",ff:"$heading",fs:"14px",fw:"bold"}),oe=x("div",{d:"flex",justify:"space-between",gridTemplateColumns:"1fr 2fr",gap:"10px",mt:"48px",pb:"10px",w:"100%",zIndex:"2",">span":{ff:"$heading",fs:"20px",fw:"bold",color:"#fff"},"@lg":{direction:"column",justify:"center",">span":{my:"10px",order:"-1"}}}),le=x("div",{w:"100%",h:"100%"}),de=x("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"}),k=Y((e,l)=>({arenaSelected:null,setArenaSelected:r=>e({arenaSelected:r}),myTeam:[null,null,null,null,null],setMyTeam:r=>e({myTeam:r}),selectedCards:[void 0,void 0],setSelectedCards:r=>e({selectedCards:r}),selectedFighterClassname:{label:"All",value:""},setSelectedFighterClassname:r=>e({selectedFighterClassname:r}),selectedSort:U[0],setSelectedSort:r=>e({selectedSort:r}),selectedElement:[],setSelectedElement:r=>e({selectedElement:r}),selectedMarkers:[],setSelectedMarkers:r=>e({selectedMarkers:r})}));function ce(){const{selectedCards:e,setSelectedCards:l,myTeam:r,setMyTeam:h}=k(),[y,_]=b.useState("fighter"),[g,d]=b.useState(0),[S,w]=b.useState("level.worlds"),[a,c]=b.useState(-1);function u(n){if(c(-1),_("fighter"),n===g){d(-1);return}d(n)}function I(n){if(d(-1),_("nft"),n===a){c(-1);return}c(n),w(n===0?"crew.worlds":n===1?"arms.worlds":"crew.worlds")}function P(n){if(!n){const o=e.map((F,j)=>{if(j!==a)return F}),i=a+1;if(c(i),l(o),w(i===0?"crew.worlds":i===1?"arms.worlds":"crew.worlds"),i>1){c(-1);return}return}if(e.some(o=>(o==null?void 0:o.asset_id)===(n==null?void 0:n.asset_id))){c(-1);return}const p=e.map((o,i)=>i===a?n:o),s=a+1;if(c(s),l(p),w(s===0?"crew.worlds":s===1?"arms.worlds":"crew.worlds"),s>1){c(-1);return}}function D(n){const p=r.map((o,i)=>i===g?n:o);h(p);const s=g+1;if(s===5){d(-1);return}d(s)}function v(n){return e.some(p=>(p==null?void 0:p.asset_id)!==n.asset_id)}return{inventoryPosition:a,fighterPosition:g,itemSelected:y,handleFighterPosition:u,handleInventoryPosition:I,handleSelectCard:P,handleAddFighter:D,filterInventoryCards:v,setFighterPosition:d,inventoryFilter:S}}async function ue(e,l){const{executeTransaction:r}=J(),h=pe(e,l);return!!await r(h)}function pe(e,{planet:l,land_id:r,crew_asset_id:h,weapon_asset_id:y,fighter_ids:_,history_id:g,x:d,y:S}){return{actions:[{account:z.arenaAle,name:"playarena",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,planet:l,land_id:r,crew_asset_id:h,weapon_asset_id:y,fighter_ids:_,history_id:g,x:d,y:S}}]}}const me=async()=>await B({options:{code:z.arenaAle,key_type:"i64",index_position:1,limit:"1000",scope:z.arenaAle,table:"config"}}),ge=()=>ee({queryKey:[$.ArenaConfigState],queryFn:()=>xe(),staleTime:1e3*60*60,enabled:!!V.getState().user});async function xe(){try{const e=await me();return e?e[0]:null}catch(e){return console.log(e),null}}const W=m.lazy(()=>f(()=>import("./index-e0aeaef3.js"),["assets/index-e0aeaef3.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/index-ea8a1aa6.js"])),fe=m.lazy(()=>f(()=>import("./travel-arrow-1687a006.js"),["assets/travel-arrow-1687a006.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css"])),he=m.lazy(()=>f(()=>import("./index-efa2320a.js"),["assets/index-efa2320a.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/weather-query-be6bd8b8.js","assets/useQuery-e3635f16.js","assets/sleep-da79c358.js","assets/landtranking-query-5c3d6c25.js"])),ye=m.lazy(()=>f(()=>import("./index-02b9935f.js"),["assets/index-02b9935f.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/config-query-4ffdd64a.js","assets/useQuery-e3635f16.js","assets/classtemps-query-56abce69.js","assets/resStats-2fa1b20e.js"])),_e=m.lazy(()=>f(()=>import("./index-93f8fa16.js"),["assets/index-93f8fa16.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/use-media-dac2e485.js","assets/fightersSort-bd534b61.js","assets/emptyTeam-57b35972.js","assets/v4-4a60fe23.js","assets/use-transaction-020c76e2.js","assets/toast-options-3550ec67.js","assets/weather-query-be6bd8b8.js","assets/useQuery-e3635f16.js","assets/sleep-da79c358.js","assets/landtranking-query-5c3d6c25.js"])),we=m.lazy(()=>f(()=>import("./index-61c337ac.js"),["assets/index-61c337ac.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/use-media-dac2e485.js","assets/fightersSort-bd534b61.js","assets/useQuery-e3635f16.js"])),ve=m.lazy(()=>f(()=>import("./index-be62100b.js"),["assets/index-be62100b.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/fightersSort-bd534b61.js","assets/use-media-dac2e485.js","assets/fighters-query-899b7e73.js","assets/useQuery-e3635f16.js","assets/fighterFilters-e6065055.js","assets/use-transaction-020c76e2.js","assets/toast-options-3550ec67.js","assets/weather-query-be6bd8b8.js","assets/sleep-da79c358.js","assets/landtranking-query-5c3d6c25.js"])),Se=m.lazy(()=>f(()=>import("./index-86d75aee.js"),["assets/index-86d75aee.js","assets/index-9a1d8aef.js","assets/index-55fec1ff.css","assets/inventory-query-9f535b90.js","assets/useQuery-e3635f16.js","assets/atomic-api-a8ace563.js","assets/toast-options-3550ec67.js","assets/fightersSort-bd534b61.js","assets/use-transaction-020c76e2.js","assets/weather-query-be6bd8b8.js","assets/sleep-da79c358.js","assets/landtranking-query-5c3d6c25.js"])),Fe=()=>{const{data:e}=ge(),{inventoryPosition:l,handleInventoryPosition:r,fighterPosition:h,inventoryFilter:y,itemSelected:_,handleAddFighter:g,handleFighterPosition:d,handleSelectCard:S,filterInventoryCards:w}=ce(),a=V(q(C=>C.user)),{selectedMap:c,areaSelected:u,setAreaSelected:I}=K(),{setArenaSelected:P,myTeam:D,selectedCards:v,setSelectedCards:n,setMyTeam:p}=k(),{selectedFighter:s,setSelectedFighter:o}=G(),{data:i}=te((a==null?void 0:a.planet)||"",(u==null?void 0:u.landId)||""),{data:F}=X(a.planet,(i==null?void 0:i.weather_id)||""),[j,L]=b.useState("");async function N(){var H,M;if(P(null),!u){A.error("Error on getting area selected.");return}if(!((H=v[0])!=null&&H.asset_id)){A.error("Please select a Crew card to start the fight.");return}if(!((M=v[1])!=null&&M.asset_id)){A.error("Please select a Weapon card to start the fight.");return}const C=D.filter(T=>T!==null);if(C.length<1){A.error("Please select a Fighter to start the fight.");return}const R=Z();try{const T={planet:c.value,land_id:u.landId,crew_asset_id:Number(v[0].asset_id),weapon_asset_id:Number(v[1].asset_id),history_id:R,fighter_ids:C.map(E=>E==null?void 0:E.fighter_id),x:u.x,y:u.y};if(await ue(a,T)){if(await O(R,L))return;A.warn("No history data found yet. Retrying..."),await O(R,L)}}catch(T){console.error("Error starting fight:",T)}}function Q(){n([void 0,void 0]),p([null,null,null,null,null]),I(null)}return j?t.jsx(he,{historyId:j}):t.jsxs(re,{isFighterSelected:!!s,children:[t.jsxs(ne,{children:[t.jsx(W,{color:"black",onClick:Q,icon:fe,children:"Leave Arena"}),t.jsxs(W,{color:"black",onClick:N,children:["Start Fight",t.jsxs("span",{children:["-",e==null?void 0:e.energy_cost,t.jsx("img",{loading:"lazy",src:"/assets/icons/energy.png",alt:""})]})]})]}),t.jsxs(ae,{isFighterSelected:!!s,children:[t.jsx(ie,{children:F==null?void 0:F.displayname}),t.jsxs(oe,{children:[t.jsx(_e,{inventoryPosition:l,handleInventoryPosition:r,fighterPosition:h,handleFighterPosition:d}),t.jsx("span",{children:"VS"}),t.jsx(we,{})]}),t.jsx(le,{children:_==="fighter"?t.jsx(ve,{handleAddFighter:g}):t.jsx(Se,{inventoryPosition:l,inventoryFilter:y,handleSelectCard:S,filterInventoryCards:w})}),t.jsx("img",{src:"/assets/background/bg-arena.png",alt:""})]}),t.jsx(se,{isFighterSelected:!!s,children:s?t.jsx(ye,{selectedFighter:{...s,...s.stats},onCloseFighterDetail:o}):t.jsx(t.Fragment,{children:t.jsx(de,{children:"Hover a Fighter"})})})]})},Te=m.memo(Fe),De=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"}));export{De as i,k as u};
