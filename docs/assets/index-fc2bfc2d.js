import{s,Q as F,u as p,g as ae,i as O,S as U,T as V,R as G,_ as J,r as g,j as e}from"./index-af7d07b8.js";import{u as w}from"./useQuery-12f917d1.js";import{A as oe}from"./atomic-api-ee4b80bb.js";import{f as y}from"./constants-06470205.js";import{F as W}from"./index.esm-734ef27f.js";import"./toast-options-e4b151ee.js";import"./iconBase-c5033e23.js";const re=s("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"auto 1fr",gap:"10px",br:"15px",w:"100%",h:"100%",maxH:"calc(100vh - 160px)",variants:{isLandSelected:{true:{"@xmd":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@xmd":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lg":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),le=s("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),ce=s("div",{gridArea:"main",padding:"0px 18px",br:"15px",bg:"#141423",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}}}),T=s("div",{w:"100%",h:"45px",bg:"#201D2C",padding:"10px 20px",fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@sm":{h:"initial",fontSize:"14px"}}),de=s("div",{mt:"20px","@sm":{mt:"5px"}}),pe=s("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),xe=s("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),ge=s("button",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px"}}),me=s("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"69px",h:"69px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"100%",h:"auto"}}}),he=s("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"100%",mt:"10px","@sm":{}}),v=s("div",{d:"flex",w:"49%",h:"34px",gap:"2px",img:{objectFit:"contain",w:"34px",h:"34px",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@md":{w:"100%",span:{fontSize:"10px"}}}),k=s("div",{d:"flex",w:"100%",gap:"3px",mt:"6px",variants:{isSide:{true:{mt:"0px","@sm":{mt:"8px"}},false:{h:"100%"}}},"@sm":{gap:"3px",flexWrap:"wrap"}}),Q=s("button",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"100%",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"45px"},variants:{isSide:{true:{justifyContent:"space-between",span:{position:"relative",top:"0px",left:"0px"},"&:first-child":{br:"0 0 0 15px",img:{br:"0 0 0 15px"}},"&:last-child":{br:"0 0 15px 0",img:{br:"0 0 15px 0"}},"@sm":{w:"24%"}}},disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),Y=s("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}}),fe=s("div",{display:"flex",flexDirection:"column",gridArea:"side",padding:"0px 18px",br:"15px",bg:"#141423",overflowY:"auto",maxHeight:"calc(100vh - 160px)",minW:"500px",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}},"@lg":{minW:"initial"},"@sm":{mt:"5px"}}),ue=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",h:"45px",w:"100%",padding:"0px 18px",bg:"#242438",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{h:"initial",padding:"5px 10px",fs:"12px"}}),je=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",position:"relative",w:"100%",h:"125px",">img":{zIndex:1,objectFit:"contain",w:"80px",h:"80px","&:first-child":{w:"100%",h:"100%",objectFit:"cover",left:"0px",top:"0px",position:"absolute"},"&:last-child":{br:"0 0 15px 0"}},span:{zIndex:2,textStroke:"2px #000",textShadow:"1px 1px 3px #000"},".question":{fs:"44px"},variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{">img":{h:"60px","&:first-child":{left:"-3px"}}}}),be=s("div",{d:"flex",w:"100%",direction:"column",img:{my:"20px",objectFit:"contain",w:"100%"},h3:{d:"flex",alignItems:"center",gap:"10px",fs:"16px",color:"#FFFFFF",mb:"15px"},"@sm":{pb:"20px",">img":{d:"none"}}}),H=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),z=s("div",{ff:"$heading",fs:"16px",color:"#FFFFFF",padding:"10px",br:"3px",bg:"#201D2C",mb:"10px",span:{color:"#FFB800"},"@sm":{fs:"12px"}}),ye=s("div",{d:"flex",gap:"3px",span:{w:"50%",ff:"$heading",fs:"13px",color:"#FFFFFF",padding:"5px 10px",br:"3px",bg:"#201D2C","&:last-child":{w:"100%"},"@sm":{fs:"10px"}}}),ve=s("div",{d:"flex",direction:"column",mt:"30px"}),Fe=s("h3",{color:"#FFFFFF","@sm":{fs:"12px"}}),we=s("p",{color:"#FFFFFF",ff:"$heading",fs:"16px",mt:"5px",padding:"5px 10px",br:"3px",bg:"#201D2C","@sm":{fs:"10px"}}),Se=s("div",{d:"flex",direction:"column",mt:"20px","@sm":{div:{top:"20px",left:"5px",fs:"10px"}}}),Ce=s("div",{d:"flex",gap:"5px",mt:"30px"}),L=s("div",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",direction:"column",span:{d:"flex",alignItems:"center",justifyContent:"center",padding:"5px 10px",w:"100%",br:"5px 5px 0 0 ",color:"#FFFFFF",ff:"$heading",fs:"10px",fw:"$thin",bg:"#201D2C"}}),I=s("div",{d:"flex",alignItems:"center",justifyContent:"center",gap:"5px",padding:"5px",br:"0 0 5px 5px",w:"100%",color:"#FFFFFF",ff:"$heading",fs:"12px",fw:"normal",bg:"#1C1A26",img:{objectFit:"contain",w:"20px",my:"0px"}}),_e=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),Te=s("div",{d:"flex",direction:"column",w:"100%",">p":{ff:"$heading",fs:"16px",color:"#FFFFFF",w:"100%",padding:"10px",br:"3px",bg:"#201D2C","@sm":{fs:"12px"}}}),ze=s("div",{d:"flex",gap:"10px",w:"100%"}),$=s("button",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative",w:"100%",h:"200px",span:{color:"#FFFFFF",ff:"$heading",fs:"16px",fw:"bold",zIndex:2},img:{objectFit:"contain",w:"80px",zIndex:2,"&:last-child":{zIndex:1,objectFit:"cover",w:"100%",h:"100%",my:"0px",top:0,left:0,position:"absolute"}}}),Le=s("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"}),Ie=()=>w({queryKey:[F.myLandsState],queryFn:()=>$e(),staleTime:1e3*60*60,enabled:!!p.getState().user});async function $e(){var r;try{const{getAssets:l}=new oe,a=await l({collection_name:"alien.worlds",schema_name:"land.worlds",owner:(r=p.getState().user)==null?void 0:r.name,page:1,limit:1e3,order:"desc",sort:"asset_id"});return Ae(a)}catch(l){return console.log(l),null}}function Ae(r){return r.map(l=>({...l,asset_id:Number(l.asset_id),data:{...l.data,planetName:l.data.name.split("on ")[1].toLowerCase()}}))}const A=["eyeke","kavian","veles","magor","neri","naron"],De=()=>w({queryKey:[F.allBuildingsState],queryFn:()=>Be(),staleTime:1e3*60*60,enabled:!!p.getState().user});async function Be(){try{const r={};for(let l=0;l<A.length;l++){const a=await ae(A[l]);if(a){const o=(a==null?void 0:a.filter(S=>{var n;return!!((n=S.buildings)!=null&&n.length)}))||[];r[A[l]]=o}}return r}catch(r){return console.log(r),null}}const Ne=async r=>await O({options:{code:U.landsAle,index_position:1,limit:"1000",scope:r,table:V.buildingcost}}),Ee=r=>w({queryFn:()=>qe(r),queryKey:[F.buildingConfigState],staleTime:1e3*60*60,enabled:!!p.getState().user});async function qe(r){try{return await Ne(r)}catch(l){return console.log(l),null}}const Me=async()=>await O({options:{code:U.landsAle,index_position:1,limit:"1000",scope:"lands.ale",table:V.CONFIG}}),Pe=()=>w({queryFn:()=>Re(),queryKey:[F.landConfigState],staleTime:1e3*60*60,enabled:!!p.getState().user});async function Re(){try{return await Me()}catch(r){return console.log(r),null}}const K=G.lazy(()=>J(()=>import("./index-38eda442.js"),["assets/index-38eda442.js","assets/index-af7d07b8.js","assets/index-55fec1ff.css"])),We=G.lazy(()=>J(()=>import("./index-33975f5d.js"),["assets/index-33975f5d.js","assets/index-af7d07b8.js","assets/index-55fec1ff.css","assets/index-34603b76.js"])),Ve=()=>{var N,E,q,M,P,R;const{data:r}=Ie(),{data:l}=De(),{data:a}=Pe();p(t=>t.user);const[o,S]=g.useState(null),[n,D]=g.useState({...y[0],index:0}),{data:m}=Ee((n==null?void 0:n.img)||""),[x,B]=g.useState([0]);function X(t){var c,i;S(t),D({...(c=y)==null?void 0:c[0],...(i=t.buildings)==null?void 0:i[0],index:0})}const h=g.useMemo(()=>m==null?void 0:m.find(t=>t.building_name===n.img&&t.level===((n==null?void 0:n.level)||0)+1),[m,n]),Z=g.useMemo(()=>{var c,i;const t=((n==null?void 0:n.boost_score)||0)/1e4;return B([t]),(((c=a==null?void 0:a[0])==null?void 0:c.boost_base_cost)||0)+(((i=a==null?void 0:a[0])==null?void 0:i.boost_cost_first_percent)||0)*t},[a,n]),ee=((N=a==null?void 0:a[0])==null?void 0:N.boost_base_cost)||0,ne=((E=a==null?void 0:a[0])==null?void 0:E.boost_cost_first_percent)||0,se=(n==null?void 0:n.boost_score)||0,f=Number(((q=a==null?void 0:a[0])==null?void 0:q.boost_cost_mod)||0),te=(1-Math.pow(f,x[0]+1))/(1-f),ie=(1-Math.pow(f,se/1e4+1))/(1-f),u=ee+ne*(te-ie),j=(((M=a==null?void 0:a[0])==null?void 0:M.start_boost_score)||0)/1e4;return console.log({slider:x[0],startScore:j,credit_total_cost:u,calc:u/(x[0]-j)}),e.jsxs(re,{isLandSelected:!!o,children:[e.jsxs(le,{children:[o&&(n==null?void 0:n.building_name)&&e.jsxs(K,{children:["Boost"," ",e.jsxs("div",{children:[Z.toLocaleString("en-US")," ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})," "]})]}),o&&h&&e.jsxs(K,{children:["Build ",n.name,e.jsxs("div",{children:[(P=h==null?void 0:h.cost_gem)==null?void 0:P.toLocaleString("en-US")," ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})]})]})]}),e.jsxs(ce,{isLandSelected:!o,children:[e.jsx(T,{children:"My Lands"}),e.jsxs(de,{children:[e.jsxs(pe,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(xe,{children:r==null?void 0:r.map(t=>{const c=l==null?void 0:l[t.data.planetName].find(i=>i.x===t.data.x&&i.y===t.data.y);return e.jsxs(ge,{isSelected:t.asset_id===Number(o==null?void 0:o.asset_id),onClick:()=>X({...t,...c}),children:[e.jsxs(me,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),e.jsxs("span",{children:[t.data.name," (",t.data.x,":",t.data.y,")"]})]}),e.jsxs(he,{children:[e.jsxs(v,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/dust.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(v,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(v,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(v,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:"76.1253"})]})]}),e.jsx(k,{isSide:!1,children:y.map((i,C)=>{const d=c==null?void 0:c.buildings.find(_=>_.building_name===i.name.toLowerCase()),b=((d==null?void 0:d.boost_score)||0)/1e4;return e.jsxs(Q,{disabled:!c||!d,children:[e.jsx(Y,{style:{width:`${b}%`}}),e.jsx("span",{children:d==null?void 0:d.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${i.img}.png`,alt:i.name,title:i.name})]},C)})})]},t.asset_id)})})]})]}),e.jsx(fe,{isLandSelected:!!o,children:o?e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:[(R=o==null?void 0:o.data)==null?void 0:R.name," (",o==null?void 0:o.data.x,":",o==null?void 0:o.data.y,")"]}),e.jsx(k,{isSide:!0,children:y.map((t,c)=>{var d,b;const i=(d=o==null?void 0:o.buildings)==null?void 0:d.find(_=>_.building_name===t.name.toLowerCase()),C=((i==null?void 0:i.boost_score)||0)/1e4;return e.jsxs(Q,{isSide:!0,disabled:!i,onClick:()=>D({...t,...i,index:c}),children:[e.jsx(Y,{style:{width:`${C}%`}}),e.jsx(ue,{isSelected:((b=n==null?void 0:n.name)==null?void 0:b.toLowerCase())===t.name.toLowerCase(),children:c===0&&!i?"Primary Building":t.name}),e.jsxs(je,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),c===0&&!i?e.jsx("span",{className:"question",children:"?"}):e.jsx("img",{loading:"lazy",src:`/assets/buildings/${t.img}.png`,alt:t.name,title:t.name}),e.jsxs("span",{children:[" ",(i==null?void 0:i.level)!==void 0?`Level ${i==null?void 0:i.level}`:""]})]})]},c)})}),e.jsx(be,{children:n!=null&&n.building_name?e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(z,{children:"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost."}),e.jsxs(ye,{children:[e.jsx("span",{children:"Next Level"}),e.jsx("span",{children:"Selection Frequency +20%"})]})]}),e.jsxs(ve,{children:[e.jsx(Fe,{children:"Building Boost"}),e.jsx(we,{children:"Boosting a building raises its perks, but usage and time reduce boost levels. If boost drops below 1%, the building becomes unusable."}),e.jsx(Se,{children:e.jsx(We,{onValueChange:B,value:x})})]}),e.jsxs(Ce,{children:[e.jsxs(L,{children:[e.jsx("span",{children:"Total Cost"}),e.jsxs(I,{children:[u.toFixed(2),e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(L,{children:[e.jsx("span",{children:"Cost per 1%"}),e.jsxs(I,{children:[(u/(x[0]-j||1)).toFixed(2),e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(L,{children:[e.jsx("span",{children:"Start Score"}),e.jsxs(I,{children:[j,"%"]})]})]}),e.jsx("img",{loading:"lazy",src:"/assets/mock/building.png",alt:"Land"})]}):n.index==0?e.jsxs(_e,{children:[e.jsx("h3",{children:"Select Primary Building"}),e.jsxs(Te,{children:[e.jsx("p",{children:"You can only have one primary building on your land"}),e.jsxs(ze,{children:[e.jsxs($,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs($,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs($,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]})]})]}),e.jsxs(z,{children:[e.jsxs("h3",{children:[e.jsx(W,{size:30})," ",n==null?void 0:n.name," Information"]}),"In a ",n==null?void 0:n.name," players can recruit new fighters to their team. Landowners earn ",e.jsx("span",{children:"Shards"})," each time a trainer recruits a fighter on their land."]})]}):e.jsx(H,{children:e.jsxs(z,{children:[e.jsxs("h3",{children:[e.jsx(W,{size:30})," ",n==null?void 0:n.name," Information"]}),"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost.In an ",n==null?void 0:n.name," players can ascend their fighters for",e.jsx("span",{children:" credits"})," or ",e.jsx("span",{children:"gems"}),". You will receive a portion of the spent currency."]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{children:"Select a Land"}),e.jsx(Le,{children:"Select a Land"})]})})]})};export{Ve as default};
