import{s as a,S as z,R as T,u as I,a as M,r as o,j as e,x as B,y as N,Q as w}from"./index-9d6ae1ff.js";import{u as R}from"./fightersSort-9d3ad0c2.js";import{s as E}from"./sleep-da79c358.js";import{o as P}from"./fighters-query-acafedff.js";import{u as H}from"./config-query-c473ca00.js";import{m as L}from"./markers-45cb96d1.js";import{u as O}from"./use-transaction-bf40cbe1.js";import{g as q,a as Q}from"./resStats-7c9727e3.js";import{u as W}from"./classtemps-query-0428281f.js";import{g as U}from"./dateUtils-ab03db27.js";import{S as X}from"./index-976215ae.js";import"./useQuery-fb5eddbd.js";import"./toast-options-811c3dd9.js";const V=a("div",{display:"flex",zIndex:"1",h:"175px",w:"100%",maxW:"325px",gap:"2px",position:"relative",bg:"#121212",border:"2px solid #B9B9B9",br:"6px",overflow:"hidden",variants:{isSelected:{true:{filter:"drop-shadow(0px 0px 10px #91A6FF)",borderColor:"#91A6FF"}},isDisabled:{true:{borderColor:"#FF3A3A",">div":{"&:nth-child(2) >div:nth-child(1)":{zIndex:"4"},"&:nth-child(3)":{".fighter-name":{zIndex:"4",color:"#FF3A3A"},"&::after":{content:'""',position:"absolute",top:"0",left:"0",w:"100%",h:"100%",bg:"rgba(0, 0, 0, 0.5)",zIndex:"3"}},"&:nth-child(4) span":{zIndex:"4",color:"#FF3A3A"}}}}}}),Y=a("div",{display:"flex",position:"relative",bg:"#282828",br:"6px 0px 0px 6px",w:"12px",h:"100%",span:{zIndex:"2",writingMode:"sideways-lr",textOrientation:"mixed",ml:"-2px",color:"#FFFFFF",fs:"12px",textAlign:"center",ff:"$heading",fw:"900","-webkit-text-stroke":"1px rgba(20, 20, 35, 0.4)"},div:{position:"absolute",bottom:"0",left:"0",w:"100%",bg:"linear-gradient(0deg, #d8bf00ff 0%, #d6d600ff 100%)"},variants:{isFull:{true:{div:{bg:"linear-gradient(0deg, #6CC000 0%, #ADFF00 100%)"}}}}}),G=a("div",{display:"flex",w:"70px",position:"relative",".fighter":{position:"absolute",bottom:"-10px",objectFit:"cover"},">img":{w:"100%",h:"100%"}}),J=a("div",{display:"flex",justifyContent:"space-between",alignItems:"center",w:"100%",padding:"5px 2px",">img":{w:"10px",h:"10px",objectFit:"contain",filter:"drop-shadow(0px 0px 2px #000)"},position:"absolute"}),K=a("div",{display:"flex",span:{color:"#FFB800",fs:"10px",ff:"$heading",fw:"bold",textShadow:"1px 1px 3px #000"},img:{w:"14px",h:"14px",objectFit:"contain"}}),Z=a("div",{display:"flex",direction:"column",zIndex:"2",w:"100%",br:"3px",bg:"rgba(0, 0, 0, 0.3)",padding:"4px"}),ee=a("div",{display:"flex",direction:"column",span:{ff:"$heading",fs:"10px",textShadow:"1px 1px 3px #000",color:"white",">span":{color:"#FFB800"}}}),te=a("div",{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"2px",span:{color:"white",textShadow:"1px 1px 3px #000",textTransform:"capitalize",fw:"bold",ff:"$heading",fs:"15px"}}),se=a("div",{display:"flex",justifyContent:"space-between",alignItems:"center",">span:first-child":{fw:"bold"},mt:"6px"}),ae=a("div",{display:"flex",direction:"column",mt:"6px"}),ne=a("div",{display:"flex",gap:"1px",h:"17px"}),b=a("button",{bg:"#20222B",padding:"2px 9px",color:"white",fs:"10px",ff:"$heading","&:first-of-type":{br:"3px 0px 0px 0px"},"&:last-of-type":{br:"0px 3px 0px 0px"},variants:{isActive:{true:{bg:"#272A36"}}}}),ie=a("div",{display:"flex",alignContent:"flex-start",justifyContent:"flex-start",flexWrap:"wrap",gap:"3px",w:"100%",h:"100px",mt:"1px",padding:"5px",br:"0px 3px 3px 3px",bg:"#272A36"}),re=a("div",{display:"flex",justifyContent:"space-between",w:"100%",color:"#fff",ff:"$heading",fs:"10px",textAlign:"center",textTransform:"capitalize",textShadow:"1px 1px 3px #000",">strong":{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},span:{display:"flex",alignItems:"center",gap:"5px","span:nth-child(2)":{color:"#339DFF"},">img":{w:"12px",h:"12px",objectFit:"contain"}}}),oe=a("div",{d:"flex",align:"center",justify:"space-between",gap:"3px",w:"100%",strong:{color:"#fff",ff:"$heading",fs:"10px",textAlign:"center",textTransform:"capitalize"},span:{display:"flex",alignItems:"center",gap:"10px",color:"#D5D5D5",ff:"$heading",fs:"10px",textAlign:"center",">img":{w:"12px",h:"12px",objectFit:"contain"}}}),F=a("button",{d:"flex",align:"center",justify:"center",border:"1px solid #121830",bg:"#1B213A",w:"22px",h:"22px",variants:{isSelected:{true:{borderColor:"#91A6FF",bg:"#3A4A8B"}}}}),le=a("img",{objectFit:"contain",w:"12px"}),ce=a("div",{display:"flex",position:"relative",bg:"#282828",br:"0px 6px 6px 0px",w:"12px",h:"100%",span:{zIndex:"2",writingMode:"sideways-rl",textOrientation:"mixed",ml:"-2px",color:"#FFFFFF",fs:"13px",textAlign:"center",ff:"$heading",fw:"900","-webkit-text-stroke":"1px rgba(20, 20, 35, 0.4)"},div:{position:"absolute",bottom:"0",right:"0",w:"100%",bg:"#68D2FF"}});async function pe(t,i){const{executeTransaction:p}=O(),l=xe(t,i);return!!await p(l)}function xe(t,{marker:i,fighter_id:p}){return{actions:[{account:z.battleAle,name:"setmarker",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,fighter_id:p,marker:i}}]}}const de=({fighter:t})=>{const i=t.stats,{setSelectedFighter:p,selectedFighter:l}=R(),{data:x}=H(),{data:d}=W(),h=I(M(s=>s.user)),[c,m]=o.useState("stats"),[v,j]=o.useState(!1);async function C(s){try{if(j(!0),!await pe(h,{marker:s,fighter_id:t.fighter_id}))return;if(await E(2e3),P(h.name),s==="")return w.success("Fighter marker removed!");w.success("Fighter marked!")}catch(n){console.error(n)}finally{j(!1)}}const A=o.useMemo(()=>new Date(t.next_payday).toLocaleDateString(),[t.next_payday]),S=o.useMemo(()=>{const s=Math.floor((Date.now()-new Date(t.creation_date).getTime())/864e5),n=((x==null?void 0:x.age_penaly_percent_day)??0)/100||0;return Math.floor(s*n)},[x,t.creation_date]),D=o.useMemo(()=>{const s=new Date(t.final_deletion_date),n=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),g=String(s.getDate()).padStart(2,"0"),u=String(s.getHours()).padStart(2,"0"),f=String(s.getMinutes()).padStart(2,"0");return`${g}/${r}/${n} ${u}:${f}`},[t]),_=o.useMemo(()=>t.stats.experience*100/t.stats.required_experience,[t.stats.experience,t.stats.required_experience]),$=o.useCallback((s,n)=>q(s,n,t,d),[d,t]),k=o.useCallback((s,n)=>Q(s,n,t,d),[d,t]),y=U(new Date).getTime()*100/new Date(t.last_payday).getTime();return e.jsxs(V,{isDisabled:t.is_disabled,onClick:()=>p(t),isSelected:(l==null?void 0:l.fighter_id)===t.fighter_id,children:[e.jsxs(Y,{isFull:_>100,children:[e.jsxs("span",{children:[t.stats.experience," / ",t.stats.required_experience," XP"]}),e.jsx("div",{style:{height:`${t.stats.experience*100/t.stats.required_experience}%`}})]}),e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx("span",{children:t.stats.credits}),e.jsx("img",{src:"/assets/icons/credits.png",alt:"Credits",loading:"lazy"})]}),e.jsx("img",{src:`/assets/icons/elements/${t.element}.png`,alt:t.element,loading:"lazy"})]}),e.jsx("img",{className:"fighter",src:`/assets/fighter/classes/full_${t.classname}_${t.racename}.png`,alt:"",loading:"lazy"}),e.jsx("img",{className:"background-image",src:`/assets/fighter/classes/backgrounds/full/full_background_${t.element}.jpeg`,alt:""})]}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsxs(te,{children:[e.jsxs("span",{className:"fighter-name",children:[t.racename," ",t.classname]}),e.jsx("button",{onClick:()=>m("markers"),children:t.marker?e.jsx("img",{src:`/assets/markers/${t.marker}.svg`,alt:t.marker,loading:"lazy"}):e.jsx("img",{src:"/assets/markers/empty-marker.svg",alt:"",loading:"lazy"})})]}),e.jsxs(se,{children:[e.jsxs("span",{children:["Level: ",i.level]}),e.jsxs("span",{children:["Age Penalty: ",e.jsxs("span",{children:[S,"%"]})]})]})]}),e.jsxs(ae,{children:[e.jsxs(ne,{children:[e.jsx(b,{isActive:c==="stats",onClick:()=>m("stats"),children:"Primary"}),e.jsx(b,{isActive:c==="resistance",onClick:()=>m("resistance"),children:"Resistance"}),e.jsx(b,{isActive:c==="abilities",onClick:()=>m("abilities"),children:"Abilities"})]}),e.jsxs(ie,{children:[c==="stats"&&B.map(s=>{const n=(i==null?void 0:i[`${s}_min`])??0,r=(i==null?void 0:i[`${s}_max`])??0,g=Math.floor((n+r)/2),u=Math.floor(Math.abs(r-n)/2),f=$(s,g);return e.jsxs(re,{children:[e.jsxs("strong",{children:[e.jsx("img",{src:`/assets/icons/stats/${s}.svg`,alt:s}),s,":"]}),e.jsxs("span",{children:[e.jsx("span",{children:g}),u>0&&e.jsxs("span",{children:["(+-",u,")"]}),f&&e.jsx("img",{src:`/assets/icons/arrows/${f}.png`,alt:"arrow-up",loading:"lazy"})]})]},s)}),c==="resistance"&&N.map(s=>{const n=i[s.value],r=k(s.value,Number(n));return e.jsxs(oe,{children:[e.jsx("strong",{children:s.displayname}),e.jsxs("span",{children:[Number(n),"%",r&&e.jsx("img",{src:`/assets/icons/arrows/${r}.png`,alt:r,loading:"lazy"})]})]},s.value)}),c==="markers"&&L.map(s=>v?e.jsx(F,{children:e.jsx(X,{size:"sm",colorSchema:"light"})},s):e.jsx(F,{isSelected:t.marker.includes(s),onClick:()=>C(s),children:e.jsx(le,{src:`/assets/markers/${s}.svg`,alt:s,title:s})},s))]})]})]}),e.jsxs(ce,{children:[e.jsx("span",{children:t.is_disabled?` DELETION ON ${D}`:A}),e.jsx("div",{style:{height:`${y}%`,background:t.is_disabled?"linear-gradient(0deg, #252525 0%, #000000 100%)":y>50?"linear-gradient(0deg, #00B2FF 0%, #68D2FF 100%)":"linear-gradient(0deg, #FF0000 0%, #FF6A6A 100%)"}})]})]})},Se=T.memo(de);export{Se as default};
