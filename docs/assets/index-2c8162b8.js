import{s as o,S as A,R as j,_ as $,u as R,j as e}from"./index-f8215110.js";import{u as B,b as M,o as N,a as W}from"./all-buildings-3f95eb61.js";import{f as h}from"./constants-9b21425a.js";import{u as F}from"./index-a4c83a32.js";import{u as O}from"./use-transaction-a2ae27fa.js";import{s as P}from"./sleep-da79c358.js";import{u as E}from"./land-config-ab0b0c59.js";import"./useQuery-3dcb96ff.js";import"./atomic-api-603140ca.js";import"./toast-options-434e5ef9.js";const Q=o("div",{mt:"20px","@sm":{mt:"5px"}}),k=o("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),V=o("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),H=o("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),U=o("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}}}),Y=o("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),y=o("div",{d:"flex",w:"49%",h:"100%",gap:"2px",img:{objectFit:"contain",w:"34px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto",span:{fontSize:"10px"}}}),q=o("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),G=o("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),J=o("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function K(c,r){const{executeTransaction:d}=O(),p=X(c,r);return!!await d(p)}function X(c,r){return{actions:[{account:A.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const Z=j.lazy(()=>$(()=>import("./index-d8075f1e.js"),["assets/index-d8075f1e.js","assets/index-f8215110.js","assets/index-55fec1ff.css"])),D=()=>{const c=R(s=>s.user),{data:r}=B(),{data:d}=M(),{data:p}=E(),{selectedLand:x,setBuildingBoost:_,setSelectedBuild:v,setSelectedLand:S,setIsBuildMenuOpen:T}=F(),[C,w]=j.useState(null);function L(s,t){var u,m,i,f;S(t);let a={...h[0]};if(t.buildings){a={...(u=t.buildings)==null?void 0:u[0],img:(i=(m=t.buildings)==null?void 0:m[0])==null?void 0:i.building_name};const g=((a==null?void 0:a.boost_score)||0)/1e4,n=(((f=p==null?void 0:p[0])==null?void 0:f.start_boost_score)||0)/1e4;_([g<n?n:g])}v(a),T(!0)}async function z(s,t){s.stopPropagation();try{w(t.asset_id),await K(c,{planet:t.data.planetName,x:t.data.x,y:t.data.y})&&(await P(2e3),await N(),await W())}catch(a){console.error(a)}finally{w(null)}}return e.jsxs(Q,{children:[e.jsxs(k,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(V,{children:r==null?void 0:r.map(s=>{const t=d==null?void 0:d[s.data.planetName].find(n=>n.x===s.data.x&&n.y===s.data.y),a=t==null?void 0:t.buildings.reduce((n,l)=>({credits:n.credits+l.credits,gems:n.gems+l.gems,shards:n.shards+l.shards,tlm:n.tlm+l.tlm}),{credits:0,gems:0,shards:0,tlm:0}),m=h.find(n=>{var l;return(l=t==null?void 0:t.buildings)==null?void 0:l.some(I=>{var b;return I.building_name===((b=n==null?void 0:n.building_name)==null?void 0:b.toLowerCase())})})||h[0],i=t==null?void 0:t.buildings.find(n=>n.building_name===m.building_name.toLowerCase()),f=((i==null?void 0:i.boost_score)||0)/1e4,g=((a==null?void 0:a.tlm)??0)/1e4;return e.jsxs(H,{isSelected:s.asset_id===Number(x==null?void 0:x.asset_id),onClick:n=>L(n,{...s,...t}),children:[e.jsxs(U,{children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${s.data.planetName}_row-${s.data.y}-column-${s.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[s.data.name," (",s.data.x,":",s.data.y,")"]})]}),e.jsxs(Y,{children:[e.jsxs(y,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:a==null?void 0:a.credits})]}),e.jsxs(y,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:((a==null?void 0:a.tlm)??0)/1e3})]})]}),e.jsxs(q,{children:[e.jsxs(G,{disabled:!i,children:[e.jsx(J,{style:{width:`${f}%`}}),e.jsx("span",{children:i==null?void 0:i.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${m.img}.png`,alt:i==null?void 0:i.building_name,title:i==null?void 0:i.building_name})]}),e.jsx(Z,{disabled:g<=0||C===s.asset_id,isLoading:C===s.asset_id,color:"blue",onClick:n=>z(n,{...t,...s}),children:"Claim TLM"})]})]},s.asset_id)})})]})},de=j.memo(D);export{de as default};
