import{s as r,S as g,R as f,u as h,r as b,j as t,Q as i}from"./index-70e0b2df.js";import j from"./index-7ec3138c.js";import{s as y}from"./sleep-da79c358.js";import{u as w}from"./index-13e23906.js";import{u as C}from"./use-transaction-0a64dc19.js";import{o as A}from"./offers-query-7d9c3b23.js";import"./index-e97083aa.js";import"./use-media-749bd9ca.js";import"./toast-options-37709a4b.js";import"./useQuery-7d8e5c8d.js";import"./typeToImg-98b92543.js";const v=r("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",padding:"40px 40px",gap:"13px",mt:"10px",bg:"#141423",br:"15px",w:"100%",maxW:"500px",button:{justify:"center",h:"50px",fw:"bold"},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),R=r("div",{d:"flex",align:"center",justify:"center",w:"100%",fw:"bold",ff:"$heading",fs:"20px",color:"white",mb:"50px"}),p=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",w:"100%",ff:"$heading",fs:"16px",color:"#C7C7C7",span:{textAlign:"center"},input:{d:"flex",w:"100%",br:"4px",padding:"8px"},strong:{display:"flex",align:"center",justify:"center",gap:"10px",padding:"10px",w:"100%",color:"white",bg:"#212130",br:"10px"},img:{w:"25px",h:"25px",objectFit:"contain"}}),S=r("div",{d:"flex",align:"center",justify:"center",direction:"column",mt:"60px",w:"100%",span:{ff:"$heading",fs:"15px",fw:"bold",color:"#C7C7C7",textAlign:"center"},input:{d:"flex",w:"100%",br:"4px",padding:"8px"}}),T=r("button",{display:"none",align:"flex-start",justify:"center",color:"#fff",fs:"30px",w:"50px",h:"50px",top:"0px",right:"0px",position:"absolute","@xmd":{d:"flex"}}),z=r(j,{display:"inline-flex",align:"center",justify:"center",gap:"5px",zIndex:"3",w:"100%",h:"40px",br:"2px !important",bg:"#6750A4 !important",border:"1px solid #36B9EA !important",fw:"bold",ff:"$heading",fs:"14px",color:"white"});async function $(e,o,n){const{executeTransaction:s}=C(),a=k(e,o,n);return!!await s(a)}function k(e,o,n){return{actions:[{account:g.recoveryAle,name:"contribute",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,offer_id:o,gems:n}}]}}const B=()=>{var d;const{user:e,updatePlayerData:o}=h(),{selectedItem:n,setSelectedItem:s}=w(),a=f.useRef(null),[c,u]=b.useState(!1);async function m(){var x;if(!e)return i.error("You need to be logged in to buy items");if(!n)return i.error("You need to select an item to buy");u(!0);try{const l=(x=a.current)==null?void 0:x.value;if(!l)return i.error("Please enter the amount of gems you want to contribute");await $(e,n.offer_id,parseInt(l))&&(await y(5e3),await A(),await o(),i.success("Item bought successfully"))}catch{i.error("Error buying item")}finally{u(!1),s(null)}}return t.jsxs(v,{children:[t.jsx(T,{onClick:()=>s(null),children:"x"}),t.jsx(R,{children:"Contribute gems to mission"}),t.jsxs(p,{children:[t.jsxs("span",{children:["At the end of a mission the rewards are being distributed based on gem contribution."," "]}),t.jsxs("strong",{children:[n==null?void 0:n.reward_amount," ",t.jsx("img",{loading:"lazy",src:`/assets/icons/${n==null?void 0:n.rewardImg}`,alt:""})]})]}),t.jsxs(p,{children:[t.jsx("span",{children:"Current total contributions"}),t.jsxs("strong",{children:[t.jsx("img",{loading:"lazy",src:"/assets/icons/gems.png",alt:""}),(n==null?void 0:n.total_gems)||0]})]}),t.jsxs(p,{children:[t.jsx("span",{children:"Your current contributions"}),t.jsxs("strong",{children:[t.jsx("img",{loading:"lazy",src:"/assets/icons/gems.png",alt:""}),((d=n==null?void 0:n.contribution)==null?void 0:d.amount)||0]})]}),t.jsxs(S,{children:[t.jsx("span",{children:"Add more gems to this mission"}),t.jsx("input",{type:"number",ref:a})]}),t.jsx(z,{isLoading:c,disabled:c,onClick:m,color:"blue",children:"Confirm exchange"})]})},N=f.memo(B);export{N as default};
