import{s,Q as j,u as g,g as se,i as U,S as G,T as J,R as X,_ as Z,r as S,j as e}from"./index-b68297c9.js";import{u as b}from"./useQuery-3ccebb81.js";import{A as te}from"./atomic-api-f42fec59.js";import{f}from"./constants-06470205.js";import{F as Q}from"./index.esm-62c1818f.js";import"./toast-options-bf0eb520.js";import"./iconBase-8f556a80.js";const ie=s("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main side"
  `,gridTemplateRows:"auto 1fr",gap:"10px",br:"15px",w:"100%",h:"100%",maxH:"calc(100vh - 160px)",variants:{isLandSelected:{true:{"@xmd":{gridTemplateAreas:`
            "header header header"
            "side side side"
          `}},false:{"@xmd":{gridTemplateAreas:`
              "header header header"
              "main main main"
            `}}}},"@lg":{gridTemplateColumns:"1fr 1fr 2fr"},"@xmd":{gap:"8px"},"@sm":{}}),ae=s("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),re=s("div",{gridArea:"main",padding:"0px 18px",br:"15px",bg:"#141423",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}}}),C=s("div",{w:"100%",h:"45px",bg:"#201D2C",padding:"10px 20px",fontSize:"16px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@sm":{h:"initial",fontSize:"14px"}}),oe=s("div",{mt:"20px","@sm":{mt:"5px"}}),le=s("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),ce=s("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),de=s("button",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px"}}),pe=s("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"69px",h:"69px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"100%",h:"auto"}}}),xe=s("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"100%",mt:"10px","@sm":{}}),u=s("div",{d:"flex",w:"49%",h:"34px",gap:"2px",img:{objectFit:"contain",w:"34px",h:"34px",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@md":{w:"100%",span:{fontSize:"10px"}}}),Y=s("div",{d:"flex",w:"100%",gap:"3px",mt:"6px",variants:{isSide:{true:{mt:"0px","@sm":{mt:"8px"}},false:{h:"100%"}}},"@sm":{gap:"3px",flexWrap:"wrap"}}),H=s("button",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"100%",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"45px"},variants:{isSide:{true:{justifyContent:"space-between",span:{position:"relative",top:"0px",left:"0px"},"&:first-child":{br:"0 0 0 15px",img:{br:"0 0 0 15px"}},"&:last-child":{br:"0 0 15px 0",img:{br:"0 0 15px 0"}},"@sm":{w:"24%"}}},disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),K=s("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}}),ge=s("div",{display:"flex",flexDirection:"column",gridArea:"side",padding:"0px 18px",br:"15px",bg:"#141423",overflowY:"auto",maxHeight:"calc(100vh - 160px)",minW:"500px",variants:{isLandSelected:{false:{"@xmd":{display:"none"}}}},"@lg":{minW:"initial"},"@sm":{mt:"5px"}}),me=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",h:"45px",w:"100%",padding:"0px 18px",bg:"#242438",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{h:"initial",padding:"5px 10px",fs:"12px"}}),he=s("div",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",fs:"16px",ff:"$heading",fw:"bold",color:"rgba(255, 255, 255, 0.56)",position:"relative",w:"100%",h:"125px",">img":{zIndex:1,objectFit:"contain",w:"80px","&:first-child":{w:"105%",h:"100%",objectFit:"cover",left:"-4px",top:"0px",position:"absolute"},"&:last-child":{br:"0 0 15px 0"}},span:{zIndex:2,textStroke:"2px #000",textShadow:"1px 1px 3px #000"},".question":{fs:"44px"},variants:{isSelected:{true:{bg:"#5DC3E8",color:"rgba(0, 0, 0, 0.83)"}}},"@sm":{">img":{h:"60px","&:first-child":{left:"-3px"}}}}),fe=s("div",{d:"flex",w:"100%",direction:"column",img:{my:"20px",objectFit:"contain",w:"100%"},h3:{d:"flex",alignItems:"center",gap:"10px",fs:"16px",color:"#FFFFFF",mb:"15px"},"@sm":{pb:"20px",">img":{d:"none"}}}),O=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),_=s("div",{ff:"$heading",fs:"16px",color:"#FFFFFF",padding:"10px",br:"3px",bg:"#201D2C",mb:"10px",span:{color:"#FFB800"},"@sm":{fs:"12px"}}),ue=s("div",{d:"flex",gap:"3px",span:{w:"50%",ff:"$heading",fs:"13px",color:"#FFFFFF",padding:"5px 10px",br:"3px",bg:"#201D2C","&:last-child":{w:"100%"},"@sm":{fs:"10px"}}}),je=s("div",{d:"flex",direction:"column",mt:"30px"}),be=s("h3",{color:"#FFFFFF","@sm":{fs:"12px"}}),ye=s("p",{color:"#FFFFFF",ff:"$heading",fs:"16px",mt:"5px",padding:"5px 10px",br:"3px",bg:"#201D2C","@sm":{fs:"10px"}}),ve=s("div",{d:"flex",direction:"column",mt:"20px","@sm":{div:{top:"20px",left:"5px",fs:"10px"}}}),Fe=s("div",{d:"flex",gap:"5px",mt:"30px"}),T=s("div",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",direction:"column",span:{d:"flex",alignItems:"center",justifyContent:"center",padding:"5px 10px",w:"100%",br:"5px 5px 0 0 ",color:"#FFFFFF",ff:"$heading",fs:"10px",fw:"$thin",bg:"#201D2C"}}),z=s("div",{d:"flex",alignItems:"center",justifyContent:"center",gap:"5px",padding:"5px",br:"0 0 5px 5px",w:"100%",color:"#FFFFFF",ff:"$heading",fs:"12px",fw:"normal",bg:"#1C1A26",img:{objectFit:"contain",w:"20px",my:"0px"}}),we=s("div",{d:"flex",gap:"3px",direction:"column",mt:"10px"}),Se=s("div",{d:"flex",direction:"column",w:"100%",">p":{ff:"$heading",fs:"16px",color:"#FFFFFF",w:"100%",padding:"10px",br:"3px",bg:"#201D2C","@sm":{fs:"12px"}}}),Ce=s("div",{d:"flex",gap:"10px",w:"100%"}),I=s("button",{d:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative",w:"100%",h:"200px",span:{color:"#FFFFFF",ff:"$heading",fs:"16px",fw:"bold",zIndex:2},img:{objectFit:"contain",w:"80px",zIndex:2,"&:last-child":{zIndex:1,objectFit:"cover",w:"100%",h:"100%",my:"0px",top:0,left:0,position:"absolute"}}}),_e=s("h4",{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",h:"100%",color:"#FFFFFF",ff:"$heading",fs:"24px",fw:"normal"}),Te=()=>b({queryKey:[j.myLandsState],queryFn:()=>ze(),staleTime:1e3*60*60,enabled:!!g.getState().user});async function ze(){var r;try{const{getAssets:o}=new te,l=await o({collection_name:"alien.worlds",schema_name:"land.worlds",owner:(r=g.getState().user)==null?void 0:r.name,page:1,limit:1e3,order:"desc",sort:"asset_id"});return Ie(l)}catch(o){return console.log(o),null}}function Ie(r){return r.map(o=>({...o,asset_id:Number(o.asset_id),data:{...o.data,planetName:o.data.name.split("on ")[1].toLowerCase()}}))}const L=["eyeke","kavian","veles","magor","neri","naron"],Le=()=>b({queryKey:[j.allBuildingsState],queryFn:()=>$e(),staleTime:1e3*60*60,enabled:!!g.getState().user});async function $e(){try{const r={};for(let o=0;o<L.length;o++){const l=await se(L[o]);if(l){const x=(l==null?void 0:l.filter(y=>{var i;return!!((i=y.buildings)!=null&&i.length)}))||[];r[L[o]]=x}}return r}catch(r){return console.log(r),null}}const Ae=async r=>await U({options:{code:G.landsAle,index_position:1,limit:"1000",scope:r,table:J.buildingcost}}),De=r=>b({queryFn:()=>Be(r),queryKey:[j.buildingConfigState],staleTime:1e3*60*60,enabled:!!g.getState().user});async function Be(r){try{return await Ae(r)}catch(o){return console.log(o),null}}const Ne=async()=>await U({options:{code:G.landsAle,index_position:1,limit:"1000",scope:"lands.ale",table:J.CONFIG}}),Ee=()=>b({queryFn:()=>qe(),queryKey:[j.landConfigState],staleTime:1e3*60*60,enabled:!!g.getState().user});async function qe(){try{return await Ne()}catch(r){return console.log(r),null}}const V=X.lazy(()=>Z(()=>import("./index-74c0fe3b.js"),["assets/index-74c0fe3b.js","assets/index-b68297c9.js","assets/index-55fec1ff.css"])),Re=X.lazy(()=>Z(()=>import("./index-928937d3.js"),["assets/index-928937d3.js","assets/index-b68297c9.js","assets/index-55fec1ff.css","assets/index-fb772a0b.js"])),Ke=()=>{var R,W,P,M,k;const{data:r}=Te(),{data:o}=Le(),{data:l}=Ee();g(t=>t.user);const[x,y]=S.useState([0]),[i,ee]=S.useState(null),[n,$]=S.useState({...f[0],index:0}),{data:v}=De((n==null?void 0:n.img)||"");function ne(t){var c,a;ee(t),$({...(c=f)==null?void 0:c[0],...(a=t.buildings)==null?void 0:a[0],index:0})}const p=v==null?void 0:v.find(t=>t.building_name===n.img&&t.level===((n==null?void 0:n.level)||0)+1),A=((R=l==null?void 0:l[0])==null?void 0:R.boost_base_cost)||0,D=((W=l==null?void 0:l[0])==null?void 0:W.boost_cost_first_percent)||0,B=(n==null?void 0:n.boost_score)||0,m=(p==null?void 0:p.cost_credits)||0,N=(1-Math.pow(m,x[0]/1e4+1))/(1-m),E=(1-Math.pow(m,B/1e4+1))/(1-m),q=A+D*(N-E);return console.log({boost_base_cost:A,boost_cost_first_percent:D,current_boost:B,term1:N,term2:E,config_cost:m,sliderValue:x[0],credit_total_cost:q}),e.jsxs(ie,{isLandSelected:!!i,children:[e.jsxs(ae,{children:[i&&(n==null?void 0:n.building_name)&&e.jsxs(V,{children:["Boost"," ",e.jsxs("div",{children:["1223 ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})," "]})]}),i&&p&&e.jsxs(V,{children:["Build ",n.name,e.jsxs("div",{children:[p==null?void 0:p.cost_gem," ",e.jsx("img",{src:"/assets/icons/shard.png",alt:"Land"})," "]})]})]}),e.jsxs(re,{isLandSelected:!i,children:[e.jsx(C,{children:"My Lands"}),e.jsxs(oe,{children:[e.jsxs(le,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(ce,{children:r==null?void 0:r.map(t=>{const c=o==null?void 0:o[t.data.planetName].find(a=>a.x===t.data.x&&a.y===t.data.y);return e.jsxs(de,{isSelected:t.asset_id===Number(i==null?void 0:i.asset_id),onClick:()=>ne({...t,...c}),children:[e.jsxs(pe,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),e.jsxs("span",{children:[t.data.name," (",t.data.x,":",t.data.y,")"]})]}),e.jsxs(xe,{children:[e.jsxs(u,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/dust.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(u,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(u,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""}),e.jsx("span",{children:"76.1253"})]}),e.jsxs(u,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:"76.1253"})]})]}),e.jsx(Y,{isSide:!1,children:f.map((a,F)=>{const d=c==null?void 0:c.buildings.find(w=>w.building_name===a.name.toLowerCase()),h=((d==null?void 0:d.boost_score)||0)/1e4;return e.jsxs(H,{disabled:!c||!d,children:[e.jsx(K,{style:{width:`${h}%`}}),e.jsx("span",{children:d==null?void 0:d.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${a.img}.png`,alt:a.name,title:a.name})]},F)})})]},t.asset_id)})})]})]}),e.jsx(ge,{isLandSelected:!!i,children:i?e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[(P=i==null?void 0:i.data)==null?void 0:P.name," (",i==null?void 0:i.data.x,":",i==null?void 0:i.data.y,")"]}),e.jsx(Y,{isSide:!0,children:f.map((t,c)=>{var d,h;const a=(d=i==null?void 0:i.buildings)==null?void 0:d.find(w=>w.building_name===t.name.toLowerCase()),F=((a==null?void 0:a.boost_score)||0)/1e4;return e.jsxs(H,{isSide:!0,disabled:!a,onClick:()=>$({...t,...a,index:c}),children:[e.jsx(K,{style:{width:`${F}%`}}),e.jsx(me,{isSelected:((h=n==null?void 0:n.name)==null?void 0:h.toLowerCase())===t.name.toLowerCase(),children:c===0&&!a?"Primary Building":t.name}),e.jsxs(he,{children:[e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"}),c===0&&!a?e.jsx("span",{className:"question",children:"?"}):e.jsx("img",{loading:"lazy",src:`/assets/buildings/${t.img}.png`,alt:t.name,title:t.name}),e.jsxs("span",{children:[" ",(a==null?void 0:a.level)!==void 0?`Level ${a==null?void 0:a.level}`:""]})]})]},c)})}),e.jsx(fe,{children:n!=null&&n.building_name?e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsx(_,{children:"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost."}),e.jsxs(ue,{children:[e.jsx("span",{children:"Next Level"}),e.jsx("span",{children:"Selection Frequency +20%"})]})]}),e.jsxs(je,{children:[e.jsx(be,{children:"Building Boost"}),e.jsx(ye,{children:"Boosting a building raises its perks, but usage and time reduce boost levels. If boost drops below 1%, the building becomes unusable."}),e.jsx(ve,{children:e.jsx(Re,{onValueChange:y,value:x})})]}),e.jsxs(Fe,{children:[e.jsxs(T,{children:[e.jsx("span",{children:"Total Cost"}),e.jsxs(z,{children:[q,e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(T,{children:[e.jsx("span",{children:"Cost per 1%"}),e.jsxs(z,{children:[Number((M=l==null?void 0:l[0])==null?void 0:M.boost_cost_mod).toFixed(2)||0,e.jsx("img",{loading:"lazy",src:"/assets/icons/shard.png",alt:""})]})]}),e.jsxs(T,{children:[e.jsx("span",{children:"Start Score"}),e.jsxs(z,{children:[(((k=l==null?void 0:l[0])==null?void 0:k.start_boost_score)||0)/1e4,"%"]})]})]}),e.jsx("img",{loading:"lazy",src:"/assets/mock/building.png",alt:"Land"})]}):n.index==0?e.jsxs(we,{children:[e.jsx("h3",{children:"Select Primary Building"}),e.jsxs(Se,{children:[e.jsx("p",{children:"You can only have one primary building on your land"}),e.jsxs(Ce,{children:[e.jsxs(I,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs(I,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]}),e.jsxs(I,{children:[e.jsx("span",{children:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/buildings/tavern.png",alt:"Tavern",title:"Tavern"}),e.jsx("img",{loading:"lazy",src:"/assets/lands/vulcano.png",alt:"Land"})]})]})]}),e.jsxs(_,{children:[e.jsxs("h3",{children:[e.jsx(Q,{size:30})," ",n==null?void 0:n.name," Information"]}),"In a ",n==null?void 0:n.name," players can recruit new fighters to their team. Landowners earn ",e.jsx("span",{children:"Shards"})," each time a trainer recruits a fighter on their land."]})]}):e.jsx(O,{children:e.jsxs(_,{children:[e.jsxs("h3",{children:[e.jsx(Q,{size:30})," ",n==null?void 0:n.name," Information"]}),"This building currently gets selected 5.4 times more often than a level 1 tavern at 100% boost.In an ",n==null?void 0:n.name," players can ascend their fighters for",e.jsx("span",{children:" credits"})," or ",e.jsx("span",{children:"gems"}),". You will receive a portion of the spent currency."]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{children:"Select a Land"}),e.jsx(_e,{children:"Select a Land"})]})})]})};export{Ke as default};
