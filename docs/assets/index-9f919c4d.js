import{s as o,S as I,R as u,_ as A,u as $,j as e}from"./index-41d3dae2.js";import{u as R,b as B,o as M,a as N}from"./all-buildings-53abaf63.js";import{f as g}from"./constants-da06ccb0.js";import{u as W}from"./index-30d20751.js";import{u as F}from"./use-transaction-3c62e870.js";import{s as O}from"./sleep-da79c358.js";import"./useQuery-5922338e.js";import"./atomic-api-2adf8789.js";import"./toast-options-85dc2973.js";const P=o("div",{mt:"20px","@sm":{mt:"5px"}}),E=o("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),k=o("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),Q=o("button",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),V=o("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}}}),H=o("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),y=o("div",{d:"flex",w:"49%",h:"100%",gap:"2px",img:{objectFit:"contain",w:"34px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto",span:{fontSize:"10px"}}}),U=o("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),Y=o("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),q=o("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function D(c,r){const{executeTransaction:d}=F(),p=G(c,r);return!!await d(p)}function G(c,r){return{actions:[{account:I.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const J=u.lazy(()=>A(()=>import("./index-6a2fce6d.js"),["assets/index-6a2fce6d.js","assets/index-41d3dae2.js","assets/index-55fec1ff.css"])),K=()=>{const c=$(s=>s.user),{data:r}=R(),{data:d}=B(),{selectedLand:p,setBuildingBoost:h,setSelectedBuild:_,setSelectedLand:v,setIsBuildMenuOpen:S}=W(),[j,C]=u.useState(null);function T(s,t){var x,m,a;v(t);let i={...g[0]};if(t.buildings){i={...(x=t.buildings)==null?void 0:x[0],img:(a=(m=t.buildings)==null?void 0:m[0])==null?void 0:a.building_name};const f=((i==null?void 0:i.boost_score)||0)/1e4;h([f])}_(i),S(!0)}async function L(s,t){s.stopPropagation();try{C(t.asset_id),await D(c,{planet:t.data.planetName,x:t.data.x,y:t.data.y})&&(await O(2e3),await M(),await N())}catch(i){console.error(i)}finally{C(null)}}return e.jsxs(P,{children:[e.jsxs(E,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(k,{children:r==null?void 0:r.map(s=>{const t=d==null?void 0:d[s.data.planetName].find(n=>n.x===s.data.x&&n.y===s.data.y),i=t==null?void 0:t.buildings.reduce((n,l)=>({credits:n.credits+l.credits,gems:n.gems+l.gems,shards:n.shards+l.shards,tlm:n.tlm+l.tlm}),{credits:0,gems:0,shards:0,tlm:0}),m=g.find(n=>{var l;return(l=t==null?void 0:t.buildings)==null?void 0:l.some(z=>{var b;return z.building_name===((b=n==null?void 0:n.building_name)==null?void 0:b.toLowerCase())})})||g[0],a=t==null?void 0:t.buildings.find(n=>n.building_name===m.building_name.toLowerCase()),f=((a==null?void 0:a.boost_score)||0)/1e4,w=((i==null?void 0:i.tlm)??0)/1e4;return e.jsxs(Q,{isSelected:s.asset_id===Number(p==null?void 0:p.asset_id),onClick:n=>T(n,{...s,...t}),children:[e.jsxs(V,{children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${s.data.planetName}_row-${s.data.y}-column-${s.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[s.data.name," (",s.data.x,":",s.data.y,")"]})]}),e.jsxs(H,{children:[e.jsxs(y,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/credit.png",alt:""}),e.jsx("span",{children:i==null?void 0:i.credits})]}),e.jsxs(y,{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/tlm.png",alt:""}),e.jsx("span",{children:w})]})]}),e.jsxs(U,{children:[e.jsxs(Y,{disabled:!a,children:[e.jsx(q,{style:{width:`${f}%`}}),e.jsx("span",{children:a==null?void 0:a.level}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${m.img}.png`,alt:a==null?void 0:a.building_name,title:a==null?void 0:a.building_name})]}),e.jsx(J,{disabled:w<=0||j===s.asset_id,isLoading:j===s.asset_id,color:"blue",onClick:n=>L(n,{...t,...s}),children:"Claim TLM"})]})]},s.asset_id)})})]})},re=u.memo(K);export{re as default};
