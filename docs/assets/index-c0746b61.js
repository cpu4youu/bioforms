import{s as d,i as fe,K as xe,S as y,T as ee,Q as te,u as z,M as ue,R as ne,_ as ge,r as v,j as e,a as G}from"./index-ae214071.js";import{u as he}from"./index-4b70bbda.js";import{u as me}from"./inventory-query-a835b454.js";import{u as se}from"./useQuery-38d22e3d.js";import{u as ae}from"./use-transaction-83ac81c5.js";import"./sleep-da79c358.js";import"./atomic-api-4825be7a.js";import"./toast-options-64873d26.js";const ve=d("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",w:"100%"}),ye=d("div",{d:"flex",align:"flex-end",justify:"flex-end",gap:"10px",position:"relative",w:"100%",button:{d:"flex",align:"center",justify:"center",maxW:"188px",h:"70px",svg:{fill:"#00BAFF"},span:{d:"flex",align:"center",justify:"center",gap:"5px",color:"#828282"},img:{maxW:"35px",maxH:"30px"}},"@sm":{button:{justify:"center",gap:"2px",padding:"0",maxW:"33%",h:"45px",fs:"12px",span:{gap:"0px"},svg:{display:"none"}}}}),je=d("div",{d:"grid",gridTemplateAreas:`
    "title title title"
    "objectivesLeft content objectivesRight"
    "objectivesLeft inventory objectivesRight"
    "objectivesLeft inventory objectivesRight"
    "objectivesLeft inventory objectivesRight"
  `,gridTemplateColumns:"1fr 5fr 1fr",gap:"20px",mt:"10px",padding:"15px 10px",bg:"#141423",br:"15px",w:"100%",minH:"calc(100vh - 160px)","@sm":{gridTemplateAreas:`
    "title title title"
    "content content content"
    "objectivesLeft objectivesLeft objectivesLeft"
    "objectivesRight objectivesRight objectivesRight"
    "inventory inventory inventory"
  `}}),be=d("h2",{gridArea:"title",w:"100%",textAlign:"center",fs:"24px",color:"#fff"}),J=d("div",{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"5px",mb:"auto",w:"100%","&.left":{gridArea:"objectivesLeft"},"&.right":{gridArea:"objectivesRight"},"@sm":{flexDirection:"row"}}),X=d("div",{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",w:"100%",maxW:"82px",h:"85px",padding:"5px 0px 0px",bg:"#358CAC",br:"3px",span:{color:"#fff",ff:"$heading",fs:"12px","&:first-child":{color:"#07445A",mb:"12px"}},variants:{disabled:{true:{filter:"grayscale(100%)"}}}}),Z=d("div",{display:"flex",alignItems:"center",gap:"5px",mt:"auto",padding:"5px 10px",color:"#fff",ff:"$heading",fs:"14px",br:"3px",bg:"#17566D",w:"100%"}),we=d("div",{gridArea:"content",display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"35px",w:"100%","@sm":{gap:"10px",img:{maxW:"85px"}},"@xsm":{gap:"5px",img:{maxW:"65px"}}}),_e=d("div",{gridArea:"content",img:{"&:hover":{transform:"scale(1.05)",zIndex:"4","-webkit-filter":"drop-shadow(0px 0px 8px #00BAFF)",filter:"drop-shadow(0px 0px 5px #00BAFF)"},"&:nth-of-type(1)":{transform:"translate(30px,20px) rotate(-20deg)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(30px,20px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"translate(-30px,20px) rotate(20deg)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(-30px,20px) rotate(20deg)",zIndex:"4"}},"@sm":{"&:nth-of-type(1)":{transform:"translate(20px,9px) rotate(-20deg)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(20px,9px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"translate(-20px,9px) rotate(20deg)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(-20px,9px) rotate(20deg)",zIndex:"4"}}}},variants:{cardSelected:{0:{img:{"&:nth-of-type(1)":{zIndex:"3"},"&:nth-of-type(2)":{opacity:"0.2"},"&:nth-of-type(3)":{opacity:"0.2"}}},1:{img:{"&:nth-of-type(1)":{opacity:"0.2"},"&:nth-of-type(2)":{},"&:nth-of-type(3)":{opacity:"0.2"}}},2:{img:{"&:nth-of-type(1)":{opacity:"0.2"},"&:nth-of-type(2)":{opacity:"0.2"},"&:nth-of-type(3)":{}}}}}}),w=d("img",{cursor:"pointer",transition:"all 0.2s ease-in-out",w:"120px",h:"170px",zIndex:"2","@lg":{w:"100px",h:"150px"},"@sm":{width:"80px",height:"initial"},"@xsm":{width:"70px",height:"initial"}}),Ce=d("div",{gridArea:"inventory",display:"flex",direction:"column",w:"100%",span:{ff:"$heading",fs:"16px",fw:"bold",color:"#fff",textAlign:"center"},"@sm":{mt:"0px"}}),Le=d("div",{d:"flex",align:"center",justify:"center",gap:"20px",mb:"20px","@sm":{m:"0px 0 20px",gap:"10px"}}),_=d("button",{d:"flex",align:"center",justify:"center",fs:"20px",ff:"$heading",fw:"$bold",color:"$white500",variants:{isSelected:{true:{textUnderlineOffset:"0.5em",textDecoration:"underline"}}},"@sm":{fs:"14px"}}),Te=d("div",{d:"flex",flexWrap:"wrap",gap:"10px",overflow:"auto",w:"100%",maxH:"calc(100vh - 520px)"}),Ae=fe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Ie=d("div",{w:"120px",h:"170px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.25) ,rgba(255, 255, 255, 0.15))",br:"10px",backgroundSize:"400% 400%",animation:`${Ae} 1.2s ease-in-out infinite`,"@sm":{width:"70px",height:"100px"}}),ze=async()=>{var u,h;let s=!1,r;const o=[];for(;!s;){const g=await xe.get_table_rows({code:y.ADVENTURE_MC,index_position:1,limit:"10000",scope:y.ADVENTURE_MC,table:ee.ADV_TEMPLATES,show_payer:!1,json:!0,lower_bound:r});s=!g.more,o.push(...g.rows.slice(0,-1)),r=((h=(u=g.rows)==null?void 0:u[g.rows.length-1])==null?void 0:h.templateid)??""}return o},Se=()=>se({queryKey:[te.tavernDataState],queryFn:()=>Re(),staleTime:1e3*60*60,enabled:!!z.getState().user});async function Re(){try{const s=await ze();return s?ke(s):null}catch(s){return console.log(s),null}}function ke(s){return s.map(r=>({...r,"nft.mp":r.nft_mp,"tlm.mp":r.tlm_mp}))}const Fe=async()=>await ue({options:{code:y.tavernAle,index_position:1,limit:"1000",scope:y.tavernAle,table:ee.CONFIG}}),Ee=()=>se({queryKey:[te.tavernConfigState],queryFn:()=>$e(),staleTime:1e3*60*60,enabled:!!z.getState().user});async function $e(){try{const s=await Fe();return s||null}catch(s){return console.log(s),null}}async function De(s,r){const{executeTransaction:o}=ae(),u=He(s,r);return!!await o(u)}function He(s,r){return{actions:[{account:y.tavernAle,name:"reveal",authorization:[{actor:s.name,permission:s.authorization.permission}],data:{wallet:s.name,use_gems:r}}]}}async function We(s){const{executeTransaction:r}=ae(),o=Be(s);return!!await r(o)}function Be(s){return{actions:[{account:y.tavernAle,name:"travel",authorization:[{actor:s.name,permission:s.authorization.permission}],data:{wallet:s.name}}]}}const I=ne.lazy(()=>ge(()=>import("./index-0a39ed3f.js"),["assets/index-0a39ed3f.js","assets/index-ae214071.js","assets/index-55fec1ff.css"])),Me=()=>{var W,B,M,P,N,O,Q,U,V,q,K,Y;const{setAreaSelected:s,areaSelected:r}=he(),{user:o}=z(),[u,h]=v.useState("level.worlds"),[g,j]=v.useState(-1),[m,re]=v.useState({}),[f,S]=v.useState([void 0,void 0,void 0]),[R,k]=v.useState(!1),[F,E]=v.useState(!1),{data:C,isLoading:ie}=me(u),{data:L}=Se(),{data:l}=Ee();function oe(){s(null)}function le(t){return f.some(n=>(n==null?void 0:n.asset_id)!==t.asset_id)}function T(t){if(t===g){j(-1);return}j(t)}function $(t){if(!t){const i=f.map((a,p)=>{if(p!==g)return a});D(i),j(-1),S(i);return}if(f.some(i=>(i==null?void 0:i.asset_id)===(t==null?void 0:t.asset_id))){j(-1);return}const n=f.map((i,a)=>a===g?t:i);D(n),j(-1),S(n)}function D(t){let n={};t.forEach(i=>{const a=L==null?void 0:L.find(x=>(x==null?void 0:x.templateid)===Number(i==null?void 0:i.template.template_id));if(!a||!(r!=null&&r.objectives))return;const p=r.objectives.reduce((x,c,A)=>{if(c.objective_value!==99999&&c.objective_value===(a==null?void 0:a[c.objective_type])){const b=c==null?void 0:c.mod_value;return x[A]=b,x}if(c.objective_type==="element"&&(c.objective_string.toLocaleLowerCase()===(a==null?void 0:a.element.toLocaleLowerCase())||c.objective_string.toLocaleLowerCase()===(a==null?void 0:a.weaponclass.toLocaleLowerCase()))){const b=c==null?void 0:c.mod_value;return x[A]=b,x}if(c.objective_string!=="-"&&c.objective_string.toLocaleLowerCase()===String(a==null?void 0:a[c.objective_type]).toLocaleLowerCase()){const b=c==null?void 0:c.mod_value;return x[A]=b,x}return x},{});n={...n,...p}}),re(n)}function H(){var t,n,i,a,p,x;return!l||!o?null:((t=o==null?void 0:o.activestats)==null?void 0:t.gems)>=((n=l==null?void 0:l[0])==null?void 0:n.cost_reveal_gem)?(i=l==null?void 0:l[0])==null?void 0:i.cost_reveal_gem:((a=o==null?void 0:o.activestats)==null?void 0:a.credits)>=((p=l==null?void 0:l[0])==null?void 0:p.cost_reveal_credits)?(x=l==null?void 0:l[0])==null?void 0:x.cost_reveal_credits:null}async function ce(t){if(o){k(!0);try{await De(o,t)&&G.success("Reveal success")}catch{}finally{k(!1)}}}async function pe(){if(o){E(!0);try{await We(o)&&G.success("Hire success")}catch{}finally{E(!1)}}}function de(){var n;const t=new Array(10).fill(0).map((i,a)=>a).reduce((i,a,p)=>m[p]?i+=m[p]:i,0);return(((n=l==null?void 0:l[0])==null?void 0:n.cost_hire_ap)||0)-t}return e.jsxs(ve,{children:[e.jsxs(ye,{children:[e.jsxs(I,{disabled:F,isLoading:F,color:"black",onClick:pe,children:["Hire",e.jsxs("span",{children:[de(),e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]}),e.jsxs(I,{color:"black",isLoading:R,onClick:()=>{var t,n;return ce((((t=o==null?void 0:o.activestats)==null?void 0:t.gems)||0)>=(((n=l==null?void 0:l[0])==null?void 0:n.cost_reveal_gem)||0))},disabled:H()===null||R,children:["Reveal",e.jsxs("span",{children:[H(),e.jsx("img",{loading:"lazy",src:"/assets/icons/dust.png",alt:""})]})]}),e.jsx(I,{color:"black",onClick:oe,children:"Back"})]}),e.jsxs(je,{children:[e.jsx(be,{children:"Unknown Fighter"}),e.jsx(J,{className:"left",children:(W=r==null?void 0:r.objectives)==null?void 0:W.slice(0,5).map(({objective_string:t,objective_type:n,objective_value:i,mod_value:a},p)=>e.jsxs(X,{disabled:!(m!=null&&m[p]),children:[e.jsx("span",{children:n}),e.jsx("span",{children:t==="-"?i:t}),e.jsxs(Z,{children:[a,e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]},p))}),e.jsxs(we,{children:[e.jsx("img",{loading:"lazy",src:"/assets/default-avatar.jpg",alt:""}),e.jsxs(_e,{cardSelected:g,children:[e.jsx(w,{onClick:()=>T(0),loading:"lazy",src:f[0]?`/assets/aw-nft-images/${(B=f[0])==null?void 0:B.template.template_id}.webp`:"/assets/default-card.png",alt:(P=(M=f[0])==null?void 0:M.data)==null?void 0:P.name}),e.jsx(w,{onClick:()=>T(1),loading:"lazy",src:f[1]?`/assets/aw-nft-images/${(N=f[1])==null?void 0:N.template.template_id}.webp`:"/assets/default-card.png",alt:(Q=(O=f[1])==null?void 0:O.data)==null?void 0:Q.name}),e.jsx(w,{onClick:()=>T(2),loading:"lazy",src:f[2]?`/assets/aw-nft-images/${(U=f[2])==null?void 0:U.template.template_id}.webp`:"/assets/default-card.png",alt:(q=(V=f[2])==null?void 0:V.data)==null?void 0:q.name})]})]}),e.jsx(Ce,{children:f.length!==0&&g===-1?e.jsx("span",{children:"Select a card"}):e.jsxs(e.Fragment,{children:[e.jsxs(Le,{children:[e.jsx(_,{isSelected:u==="crew.worlds",onClick:()=>h("crew.worlds"),children:"Minions"}),e.jsx(_,{isSelected:u==="arms.worlds",onClick:()=>h("arms.worlds"),children:"Weapons"}),e.jsx(_,{isSelected:u==="tool.worlds",onClick:()=>h("tool.worlds"),children:"Tools"}),e.jsx(_,{isSelected:u==="level.worlds",onClick:()=>h("level.worlds"),children:"Levels"}),e.jsx(_,{isSelected:u==="faces.worlds",onClick:()=>h("faces.worlds"),children:"Avatars"})]}),e.jsx(Te,{children:ie?new Array(10).fill(0).map((t,n)=>e.jsx(Ie,{},n)):e.jsxs(e.Fragment,{children:[e.jsx(w,{onClick:()=>$(void 0),src:"/assets/default-card.png",alt:"default card"}),(K=C==null?void 0:C.filter(le))==null?void 0:K.map(t=>{var n;return e.jsx(w,{onClick:()=>$(t),loading:"lazy",src:`/assets/aw-nft-images/${t==null?void 0:t.template.template_id}.webp`,alt:(n=t==null?void 0:t.data)==null?void 0:n.name},t==null?void 0:t.asset_id)})]})})]})}),e.jsx(J,{className:"right",children:(Y=r==null?void 0:r.objectives)==null?void 0:Y.slice(5,10).map(({objective_string:t,objective_type:n,objective_value:i,mod_value:a},p)=>e.jsxs(X,{disabled:!(m!=null&&m[p+5]),children:[e.jsx("span",{children:n}),e.jsx("span",{children:t==="-"?i:t}),e.jsxs(Z,{children:[a,e.jsx("img",{loading:"lazy",src:"/assets/icons/potion.png",alt:""})]})]},p))})]})]})},Ye=ne.memo(Me);export{Ye as default};
