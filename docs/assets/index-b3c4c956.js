import{s as r,g as y,S as p,e as h,u as m,R as f,_ as b,j as e,r as j,Q as i}from"./index-ca74bd17.js";import{u as w}from"./index-113f842d.js";import T from"./index-360d8f26.js";import{u as S}from"./useQuery-727d4ce0.js";import{u as g}from"./use-transaction-cb845e53.js";import{v as C}from"./v4-4a60fe23.js";import"./toast-options-683ab7d7.js";const _=r("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",padding:"40px 40px",gap:"10px",mt:"10px",bg:"#141423",br:"15px",w:"100%",maxW:"510px",button:{justify:"center",h:"50px",fw:"bold"},variants:{isHidden:{true:{"@sm":{display:"none"}}}}}),v=r("div",{d:"flex",fw:"bold",ff:"$heading",fs:"16px",color:"white",mb:"50px"}),u=r("div",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"16px",color:"white",strong:{display:"flex",align:"center",justify:"center",gap:"10px"},img:{w:"25px",h:"25px",objectFit:"contain"},"&:last-of-type":{my:"50px"}}),z=r("button",{display:"none",align:"flex-start",justify:"center",color:"#fff",fs:"30px",w:"50px",h:"50px",top:"0px",right:"0px",position:"absolute","@xmd":{d:"flex"}}),A=async n=>{const o=await y({options:{code:p.eosioToken,index_position:1,key_type:"i64",limit:"1000",scope:n,table:"accounts"}});return(o==null?void 0:o[0])||null},W=()=>S({queryKey:[h.WaxCoinsState],queryFn:()=>Y(),staleTime:1e3*60*60,enabled:!!m.getState().user});async function Y(){const n=m.getState().user;if(!n)return null;try{const o=await A(n.name);return o?{balance:parseFloat(o.balance),currency:o.balance.split(" ")[1]}:null}catch(o){return console.log(o),null}}async function E(n,o){const{executeTransaction:t}=g(),s=F(n,o);return!!await t(s)}function F(n,o){return{actions:[{account:p.shopAle,name:"buyshopitem",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{wallet:n.name,item:o}}]}}async function R(n,o,t){const{executeTransaction:s}=g(),a=G(n,o,t);return!!await s(a)}function G(n,o,t){return{actions:[{account:p.eosioToken,name:"transfer",authorization:[{actor:n.name,permission:n.authorization.permission}],data:{from:n.name,to:"shop.ale",memo:`purchase,${o}`,quantity:t}}]}}const I=f.lazy(()=>b(()=>import("./index-57b73661.js"),["assets/index-57b73661.js","assets/index-ca74bd17.js","assets/index-55fec1ff.css","assets/index-113f842d.js","assets/useQuery-727d4ce0.js"])),L=f.memo(({list:n})=>e.jsx(e.Fragment,{children:n==null?void 0:n.map(o=>e.jsx(I,{...o},C()))})),$=f.memo(()=>{const{user:n,updatePlayerData:o}=m(),{selectedPack:t,setSelectedPack:s}=w(),{data:a}=W(),[c,x]=j.useState(!1);async function d(){if(!n)return i.error("You need to be logged in to buy items");if(!t)return i.error("You need to select a pack to buy items");x(!0);let l=!1;try{((t==null?void 0:t.category)==="credits"||(t==null?void 0:t.category)==="flasks")&&(l=await E(n,t.item)),(t==null?void 0:t.imageCost)==="wax-coin"&&(l=await R(n,t.item,t.cost_wax)),l&&(await o(),i.success("Item bought successfully"))}catch{i.error("Error buying item")}finally{x(!1),s(null)}}return e.jsxs(_,{children:[e.jsx(z,{onClick:()=>s(null),children:"x"}),e.jsx(v,{children:e.jsxs("span",{children:["Your selection: ",t==null?void 0:t.offer_name]})}),e.jsxs(u,{children:[e.jsx("span",{children:"You will receive: "}),e.jsxs("strong",{children:[e.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageGain}.png`,alt:""}),t==null?void 0:t.gain]})]}),e.jsxs(u,{children:[e.jsx("span",{children:"You will pay:"}),e.jsxs("strong",{children:[e.jsx("img",{loading:"lazy",src:`/assets/icons/${t==null?void 0:t.imageCost}.png`,alt:""}),t==null?void 0:t.cost,(t==null?void 0:t.imageCost)==="wax-coin"?" WAX":""]})]}),e.jsxs(u,{children:[e.jsx("span",{children:"Your current WAX balance:"}),e.jsxs("strong",{children:[e.jsx("img",{loading:"lazy",src:"/assets/icons/wax-coin.png",alt:""}),a==null?void 0:a.balance.toLocaleString("en-US",{maximumFractionDigits:2})]})]}),e.jsx(T,{isLoading:c,disabled:c,onClick:d,color:"blue",children:"Purchase now"})]})});L.displayName="GemList";$.displayName="GemSelection";export{L as GemList,$ as GemSelection};
