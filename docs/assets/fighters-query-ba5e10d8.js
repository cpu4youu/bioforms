import{g as h,S as u,e as o,u as m,v as i,N as _}from"./index-255dedfe.js";import{u as d}from"./useQuery-b58a3143.js";const p=async t=>await h({options:{code:u.battleAle,index_position:2,key_type:"i64",limit:"1000",scope:u.battleAle,table:"fighters",lower_bound:t,upper_bound:t}}),b=t=>d({queryKey:[o.fightersState,t],queryFn:()=>S(t),staleTime:1e3*60*60,enabled:!!m.getState().user});async function x(t){return await i.invalidateQueries([o.fightersState,t])}async function S(t){try{const e=await p(t);return e?w(e):null}catch(e){return console.log(e),null}}function w(t){return t.map(e=>{console.log("fighter",e);const a=v(e);console.log("calculatedStats",a);const s=_({...e,stats:a}),l=new Date().getTime(),n=new Date(e.next_payday).getTime();return{...e,stats:{...e.stats,...s},is_disabled:l>n}})}function v(t){const e=i.getQueryData(o.BattleConfigState),a=Math.floor((Date.now()-new Date(t.creation_date).getTime())/(1e3*60*60*24));let s=1;e!=null&&e.age_penaly_percent_day&&(s=e==null?void 0:e.age_penaly_percent_day);const l=s/100,n=a*l,y=["health_max","health_min","damage_max","damage_min"],r={...t.stats};return console.log({agePenalty:n,"Math.pow(1.1, fighter.stats.level)":Math.pow(1.1,t.stats.level),"fighter.stats.level":t.stats.level,health_max:t.stats.health_max}),y.forEach(c=>{const g=Math.max(0,100-n);r[c]=t.stats[c]*Math.pow(1.1,t.stats.level)*g/100}),{...t.stats,...r}}export{x as o,b as u};
