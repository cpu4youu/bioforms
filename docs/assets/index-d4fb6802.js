import{s as o,S,R as f,_ as m,u as C,a as A,r as d,j as e,Q as E}from"./index-9d6ae1ff.js";import{u as Q,o as R}from"./activequests-query-df3e157c.js";import{s as q}from"./sleep-da79c358.js";import{u as z}from"./use-transaction-bf40cbe1.js";import{c as v}from"./calculateTImeLeft-3fbd33a3.js";import{v as D}from"./v4-4a60fe23.js";import"./useQuery-fb5eddbd.js";import"./toast-options-811c3dd9.js";const L=o("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main main"
  `,gridTemplateRows:"70px 1fr",gridTemplateColumns:"1fr 1fr .5fr",gap:"10px",br:"15px",w:"100%",h:"100%"}),I=o("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),H=o("div",{gridArea:"main",d:"flex",position:"relative",minH:"calc(100vh - 160px)",maxH:"calc(100vh - 160px)",padding:"10px",br:"0 15px 15px 15px",bg:"#141423",backgroundImage:"url(/assets/background/bg-quests.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}),F=o("div",{d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-start",position:"absolute",top:"-40px",left:"0px"}),u=o("button",{d:"flex",align:"center",justify:"center",gap:"5px",h:"40px",padding:"10px 15px",color:"#fff",bg:"#141423",fs:"12px",img:{w:"20px",h:"20px",objectFit:"contain"},"&:first-child":{br:"15px 0px 0px 0px"},"&:last-child":{br:"0 15px 0 0"},variants:{isSelected:{true:{bg:"#19192D"}}}}),M=o("div",{d:"flex",align:"center",justify:"center",w:"100%",gap:"10px",maxH:"calc(100vh - 175px)",overflowY:"auto","@md":{flexDirection:"column",gap:"25px"}});o("span",{color:"#fff",fw:"bold",fs:"28px",ff:"$heading"});async function N(a){const{executeTransaction:t}=z(),i=O(a);return!!await t(i)}function O(a){return{actions:[{account:S.questAle,name:"getquests",authorization:[{actor:a.name,permission:a.authorization.permission}],data:{wallet:a.name}}]}}const P=f.lazy(()=>m(()=>import("./index-4dcbe72a.js"),["assets/index-4dcbe72a.js","assets/index-9d6ae1ff.js","assets/index-55fec1ff.css","assets/index-976215ae.js"])),V=f.lazy(()=>m(()=>import("./index-d76a221e.js"),["assets/index-d76a221e.js","assets/index-9d6ae1ff.js","assets/index-55fec1ff.css","assets/index-4dcbe72a.js","assets/index-976215ae.js","assets/use-transaction-bf40cbe1.js","assets/toast-options-811c3dd9.js","assets/sleep-da79c358.js","assets/activequests-query-df3e157c.js","assets/useQuery-fb5eddbd.js","assets/calculateTImeLeft-3fbd33a3.js"])),x=f.lazy(()=>m(()=>import("./index-02ff1c84.js"),["assets/index-02ff1c84.js","assets/index-9d6ae1ff.js","assets/index-55fec1ff.css"])),Z=()=>{var y,b,_;const a=C(A(s=>s.user)),{data:t}=Q(),[i,g]=d.useState("day"),[c,h]=d.useState(!1),l=d.useMemo(()=>{const s={day:!1,week:!1,month:!1};return t==null||t.quests.forEach(n=>{const r=a.permstats.find(k=>k.first===n.task_type),T=((r==null?void 0:r.second)||0)-n.task_start_value;v(new Date(n.expiry_date))!==null&&T>=n.task_end_value&&(s[n.quest_scope]=!0)}),s},[a,t]);function p(s){g(s)}async function j(){h(!0);try{if(!await N(a)){console.log("Failed to get new quests");return}await q(7e3),await R(),E.success("New quests generated successfully!")}catch(s){console.log(s)}finally{h(!1)}}const w=(y=t==null?void 0:t.quests)==null?void 0:y.some(s=>{const n=new Date(s.expiry_date);return v(n)===null});return e.jsxs(L,{children:[e.jsx(I,{children:(!t||w)&&e.jsx(P,{isLoading:c,disabled:c,onClick:j,children:"New Quests"})}),e.jsxs(H,{children:[e.jsxs(F,{children:[e.jsxs(u,{isSelected:i==="day",onClick:()=>p("day"),children:["Daily",l.day&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]}),e.jsxs(u,{isSelected:i==="week",onClick:()=>p("week"),children:["Weekly",l.week&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]}),e.jsxs(u,{isSelected:i==="month",onClick:()=>p("month"),children:["Monthly",l.month&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]})]}),e.jsx(M,{children:t?(_=(b=t==null?void 0:t.quests)==null?void 0:b.filter(s=>s.quest_scope===i))==null?void 0:_.map(s=>e.jsx(V,{item:s,isItemLoading:c},D())):e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx(x,{}),e.jsx(x,{})]})})]})]})};export{Z as default};
