import{s as i,S as R,R as f,_,u as $,j as e}from"./index-c43343c7.js";import{a as B,u as M,o as W}from"./land-config-2dcaf6d2.js";import{u as E,o as O}from"./all-buildings-32b790e1.js";import{f as C}from"./constants-9b21425a.js";import{u as P}from"./index-5130eb57.js";import{u as N}from"./use-transaction-f8785654.js";import{s as V}from"./sleep-da79c358.js";import"./useQuery-5d538c17.js";import"./atomic-api-c8f1e2fe.js";import"./toast-options-205b7f7e.js";const k=i("div",{mt:"20px","@sm":{mt:"5px"}}),D=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",w:"100%",bg:"#242438",padding:"10px 20px",fontSize:"14px",fontWeight:"bold",ff:"$heading",color:"#C9C9C9","@md":{gap:"10px",fontSize:"12px",padding:"10px 10px",span:{textAlign:"center"}}}),Q=i("div",{d:"flex",direction:"column",gap:"10px",overflowY:"auto",h:"calc(100vh - 280px)",pb:"20px"}),H=i("div",{d:"grid",gridTemplateColumns:"1fr 1fr 1fr",bg:"#201D2C",padding:"8px",gap:"3px",variants:{isSelected:{true:{bg:"rgb(255 255 255 / 17%)"}}},"@sm":{gap:"3px",alignItems:"center"}}),U=i("div",{d:"flex",w:"100%",h:"100%",mt:"10px",img:{objectFit:"contain",w:"70px",h:"70px"},span:{ml:"10px",fontSize:"14px",ff:"$heading",color:"#C9C9C9"},"@md":{span:{fontSize:"12px"}},"@sm":{direction:"column-reverse",alignItems:"center",justify:"flex-end",gap:"10px",img:{w:"50px",h:"auto"}},variants:{rarity:{common:{span:{color:"#C9C9C9"}},rare:{span:{color:"#4DCFFF"}},epic:{span:{color:"#B84FFF"}},legendary:{span:{color:"#FFD700"}}}}}),Y=i("div",{d:"flex",flexWrap:"wrap",gap:"2px 3px",w:"100%",h:"77px"}),b=i("div",{d:"flex",w:"49%",h:"100%",gap:"2px","img, svg":{px:"5px",objectFit:"contain",minW:"54px",maxW:"54px",h:"100%",bg:"#242438"},span:{d:"flex",alignItems:"center",justifyContent:"center",w:"100%",fontSize:"14px",ff:"$heading",fw:"bold",color:"#C9C9C9",bg:"#242438"},"@sm":{w:"100%",h:"auto","img, svg":{minW:"34px",maxW:"34px"},span:{fontSize:"10px"}}}),q=i("div",{d:"flex",alignItems:"center",w:"100%",gap:"3px",button:{d:"flex",alignItems:"center",justifyContent:"center",fw:"bold",maxW:"150px",w:"100%",h:"40px",mx:"auto"},"@sm":{justifyContent:"center",gap:"3px",flexWrap:"wrap"}}),G=i("div",{d:"flex",justifyContent:"center",alignItems:"center",direction:"column",position:"relative",bg:"#242438",w:"70px",h:"77px",overflow:"hidden",span:{position:"absolute",top:"8px",left:"5px",ff:"$heading",fw:"bold",fs:"16px",color:"#D9CA9A"},img:{objectFit:"contain",w:"77px",h:"100%"},variants:{disabled:{true:{"img, span":{filter:"grayscale(100%)"}}}},"@md":{span:{fontSize:"12px"}},"@sm":{maxW:"48%",span:{fontSize:"12px"},img:{objectFit:"contain",w:"50px"}}}),J=i("div",{position:"absolute",w:"100%",h:"7px",top:0,left:0,bg:"red","@sm":{h:"3px"}});async function K(c,r){const{executeTransaction:l}=N(),m=X(c,r);return!!await l(m)}function X(c,r){return{actions:[{account:R.landsAle,name:"claimlndrwrd",authorization:[{actor:c.name,permission:c.authorization.permission}],data:{wallet:c.name,planet:r.planet,x:r.x,y:r.y}}]}}const Z=f.lazy(()=>_(()=>import("./index-810fc098.js"),["assets/index-810fc098.js","assets/index-c43343c7.js","assets/index-55fec1ff.css","assets/index-4a789fe5.js"])),ee=f.lazy(()=>_(()=>import("./shards-2b99f36c.js"),["assets/shards-2b99f36c.js","assets/index-c43343c7.js","assets/index-55fec1ff.css"])),te=f.lazy(()=>_(()=>import("./tlm-c17ffc83.js"),["assets/tlm-c17ffc83.js","assets/index-c43343c7.js","assets/index-55fec1ff.css"])),se=()=>{const c=$(t=>t.user),{data:r}=B(),{data:l}=E(),{data:m}=M(),{selectedLand:g,setBuildingBoost:v,setSelectedBuild:L,setSelectedLand:S,setIsBuildMenuOpen:T,setIsDestroying:I}=P(),[y,w]=f.useState(null);function z(t,s){var h,x,o,d;S(s);let a={...C[0]};if(s.buildings){a={...(h=s.buildings)==null?void 0:h[0],img:(o=(x=s.buildings)==null?void 0:x[0])==null?void 0:o.building_name};const u=((a==null?void 0:a.boost_score)||0)/1e4,n=(((d=m==null?void 0:m[0])==null?void 0:d.start_boost_score)||0)/1e4;v([u<n?n:u])}L(a),I(!1),T(!0)}async function A(t,s){t.stopPropagation();try{w(s.asset_id),await K(c,{planet:s.data.planetName,x:s.data.x,y:s.data.y})&&(await V(2e3),await W(),await O())}catch(a){console.error(a)}finally{w(null)}}return e.jsxs(k,{children:[e.jsxs(D,{children:[e.jsx("span",{children:"Land"}),e.jsx("span",{children:"Income since last claim"}),e.jsx("span",{children:"Buildings"})]}),e.jsx(Q,{children:r==null?void 0:r.map(t=>{const s=l==null?void 0:l[t.data.planetName].find(n=>n.x===t.data.x&&n.y===t.data.y),a=s==null?void 0:s.buildings.reduce((n,p)=>({credits:n.credits+p.credits,gems:n.gems+p.gems,shards:n.shards+p.shards,tlm:n.tlm+p.tlm}),{credits:0,gems:0,shards:0,tlm:0}),x=C.find(n=>{var p;return(p=s==null?void 0:s.buildings)==null?void 0:p.some(F=>{var j;return F.building_name===((j=n==null?void 0:n.building_name)==null?void 0:j.toLowerCase())})})||C[0],o=s==null?void 0:s.buildings.find(n=>n.building_name===x.building_name.toLowerCase()),d=((o==null?void 0:o.boost_score)||0)/1e4,u=((a==null?void 0:a.tlm)??0)/1e4;return e.jsxs(H,{isSelected:t.asset_id===Number(g==null?void 0:g.asset_id),onClick:n=>z(n,{...t,...s}),children:[e.jsxs(U,{rarity:t.data.rarity.toLocaleLowerCase(),children:[e.jsx("img",{loading:"lazy",src:`/assets/lands/map_${t.data.planetName}_row-${t.data.y}-column-${t.data.x}.jpg`,alt:"Land"}),e.jsxs("span",{children:[t.data.name," (",t.data.x,":",t.data.y,")"]})]}),e.jsxs(Y,{children:[e.jsxs(b,{children:[e.jsx(ee,{}),e.jsx("span",{children:a==null?void 0:a.credits})]}),e.jsxs(b,{children:[e.jsx(te,{}),e.jsx("span",{children:((a==null?void 0:a.tlm)??0)/1e3})]})]}),e.jsxs(q,{children:[e.jsxs(G,{disabled:!o,children:[e.jsx(J,{style:{width:`${d}%`,backgroundColor:d>80?"green":d>50?"yellow":"red"}}),e.jsx("img",{loading:"lazy",src:`/assets/buildings/${x.img}.png`,alt:o==null?void 0:o.building_name,title:o==null?void 0:o.building_name})]}),e.jsx(Z,{disabled:u<=0||y===t.asset_id,isLoading:y===t.asset_id,color:"blue",onClick:n=>A(n,{...s,...t}),children:"Claim TLM"})]})]},t.asset_id)})})]})},xe=f.memo(se);export{xe as default};
