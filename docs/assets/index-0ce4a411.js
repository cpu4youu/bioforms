import{s as n,S as T,R as f,_ as m,u as k,a as S,r as d,j as e,Q as C}from"./index-95badb9d.js";import{u as A,o as E}from"./activequests-query-29a7a13d.js";import{s as Q}from"./sleep-da79c358.js";import{u as R}from"./use-transaction-24f280e0.js";import{c as q}from"./calculateTImeLeft-3fbd33a3.js";import{v as z}from"./v4-4a60fe23.js";import"./useQuery-f88ad52f.js";import"./toast-options-be3620b7.js";const L=n("div",{d:"grid",gridTemplateAreas:`
    "empty empty header"
    "main main main"
  `,gridTemplateRows:"70px 1fr",gridTemplateColumns:"1fr 1fr .5fr",gap:"10px",br:"15px",w:"100%",h:"100%"}),D=n("div",{gridArea:"header",d:"flex",justifyContent:"flex-end",gap:"10px",minHeight:"65px",button:{padding:"20px",w:"100%",maxW:"100%",div:{d:"flex",alignItems:"center",gap:"5px",color:"#828282",img:{objectFit:"contain",w:"24px"}}},"@sm":{gap:"5px",button:{fs:"12px",padding:"10px",div:{img:{w:"20px"}}}},"@xsm":{button:{gap:"3px",justify:"space-between",padding:"9px 0px 9px 3px",fs:"10px"}}}),I=n("div",{gridArea:"main",d:"flex",position:"relative",minH:"calc(100vh - 160px)",maxH:"calc(100vh - 160px)",padding:"10px",br:"0 15px 15px 15px",bg:"#141423",backgroundImage:"url(/assets/background/bg-quests.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}),H=n("div",{d:"flex",align:"flex-start",alignContent:"flex-start",justify:"flex-start",position:"absolute",top:"-40px",left:"0px"}),u=n("button",{d:"flex",align:"center",justify:"center",gap:"5px",h:"40px",padding:"10px 15px",color:"#fff",bg:"#141423",fs:"12px",img:{w:"20px",h:"20px",objectFit:"contain"},"&:first-child":{br:"15px 0px 0px 0px"},"&:last-child":{br:"0 15px 0 0"},variants:{isSelected:{true:{bg:"#19192D"}}}}),F=n("div",{d:"flex",align:"center",justify:"center",w:"100%",gap:"10px",maxH:"calc(100vh - 175px)",overflowY:"auto","@md":{flexDirection:"column",gap:"25px"}});n("span",{color:"#fff",fw:"bold",fs:"28px",ff:"$heading"});async function M(a){const{executeTransaction:t}=R(),o=N(a);return!!await t(o)}function N(a){return{actions:[{account:T.questAle,name:"getquests",authorization:[{actor:a.name,permission:a.authorization.permission}],data:{wallet:a.name}}]}}const O=f.lazy(()=>m(()=>import("./index-1d0508ce.js"),["assets/index-1d0508ce.js","assets/index-95badb9d.js","assets/index-55fec1ff.css","assets/index-3664244c.js"])),P=f.lazy(()=>m(()=>import("./index-ea2014ba.js"),["assets/index-ea2014ba.js","assets/index-95badb9d.js","assets/index-55fec1ff.css","assets/index-1d0508ce.js","assets/index-3664244c.js","assets/use-transaction-24f280e0.js","assets/toast-options-be3620b7.js","assets/sleep-da79c358.js","assets/activequests-query-29a7a13d.js","assets/useQuery-f88ad52f.js","assets/calculateTImeLeft-3fbd33a3.js"])),x=f.lazy(()=>m(()=>import("./index-65adcf2c.js"),["assets/index-65adcf2c.js","assets/index-95badb9d.js","assets/index-55fec1ff.css"])),X=()=>{var y,b,v;const a=k(S(s=>s.user)),{data:t}=A(),[o,g]=d.useState("day"),[c,h]=d.useState(!1),l=d.useMemo(()=>{const s={day:!1,week:!1,month:!1};return t==null||t.quests.forEach(i=>{const r=a.permstats.find(w=>w.first===i.task_type);((r==null?void 0:r.second)||0)-i.task_start_value>=i.task_end_value&&(s[i.quest_scope]=!0)}),s},[a,t]);function p(s){g(s)}async function _(){h(!0);try{if(!await M(a)){console.log("Failed to get new quests");return}await Q(7e3),await E(),C.success("New quests generated successfully!")}catch(s){console.log(s)}finally{h(!1)}}const j=(y=t==null?void 0:t.quests)==null?void 0:y.some(s=>{const i=new Date(s.expiry_date);return q(i)===null});return e.jsxs(L,{children:[e.jsx(D,{children:(!t||j)&&e.jsx(O,{isLoading:c,disabled:c,onClick:_,children:"New Quests"})}),e.jsxs(I,{children:[e.jsxs(H,{children:[e.jsxs(u,{isSelected:o==="day",onClick:()=>p("day"),children:["Daily",l.day&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]}),e.jsxs(u,{isSelected:o==="week",onClick:()=>p("week"),children:["Weekly",l.week&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]}),e.jsxs(u,{isSelected:o==="month",onClick:()=>p("month"),children:["Monthly",l.month&&e.jsx("img",{loading:"lazy",src:"/assets/icons/question.svg",alt:""})]})]}),e.jsx(F,{children:t?(v=(b=t==null?void 0:t.quests)==null?void 0:b.filter(s=>s.quest_scope===o))==null?void 0:v.map(s=>e.jsx(P,{item:s,isItemLoading:c},z())):e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx(x,{}),e.jsx(x,{})]})})]})]})};export{X as default};
