import{R as M,r as W,s as L,j as g,u as U,a as _i,b as Wi,e as Di,p as re,g as ne,S as wi,q as ae}from"./index-2fbd3250.js";import{g as Si,a as yi}from"./constants-308cd0ac.js";import{u as Oi}from"./useQuery-5fcd8aa9.js";var D=function(i,n){return Number(i.toFixed(n))},te=function(i,n){return typeof i=="number"?i:n},b=function(i,n,e){e&&typeof e=="function"&&e(i,n)},oe=function(i){return-Math.cos(i*Math.PI)/2+.5},se=function(i){return i},le=function(i){return i*i},ue=function(i){return i*(2-i)},de=function(i){return i<.5?2*i*i:-1+(4-2*i)*i},fe=function(i){return i*i*i},pe=function(i){return--i*i*i+1},ve=function(i){return i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},me=function(i){return i*i*i*i},ce=function(i){return 1- --i*i*i*i},he=function(i){return i<.5?8*i*i*i*i:1-8*--i*i*i*i},ge=function(i){return i*i*i*i*i},we=function(i){return 1+--i*i*i*i*i},Se=function(i){return i<.5?16*i*i*i*i*i:1+16*--i*i*i*i*i},ki={easeOut:oe,linear:se,easeInQuad:le,easeOutQuad:ue,easeInOutQuad:de,easeInCubic:fe,easeOutCubic:pe,easeInOutCubic:ve,easeInQuart:me,easeOutQuart:ce,easeInOutQuart:he,easeInQuint:ge,easeOutQuint:we,easeInOutQuint:Se},Bi=function(i){typeof i=="number"&&cancelAnimationFrame(i)},k=function(i){i.mounted&&(Bi(i.animation),i.animate=!1,i.animation=null,i.velocity=null)};function Ni(i,n,e,r){if(i.mounted){var a=new Date().getTime(),t=1;k(i),i.animation=function(){if(!i.mounted)return Bi(i.animation);var o=new Date().getTime()-a,s=o/e,l=ki[n],d=l(s);o>=e?(r(t),i.animation=null):i.animation&&(r(d),requestAnimationFrame(i.animation))},requestAnimationFrame(i.animation)}}function ye(i){var n=i.scale,e=i.positionX,r=i.positionY;return!(Number.isNaN(n)||Number.isNaN(e)||Number.isNaN(r))}function x(i,n,e,r){var a=ye(n);if(!(!i.mounted||!a)){var t=i.setTransformState,o=i.transformState,s=o.scale,l=o.positionX,d=o.positionY,u=n.scale-s,f=n.positionX-l,p=n.positionY-d;e===0?t(n.scale,n.positionX,n.positionY):Ni(i,r,e,function(v){var m=s+u*v,c=l+f*v,S=d+p*v;t(m,c,S)})}}function be(i,n,e){var r=i.offsetWidth,a=i.offsetHeight,t=n.offsetWidth,o=n.offsetHeight,s=t*e,l=o*e,d=r-s,u=a-l;return{wrapperWidth:r,wrapperHeight:a,newContentWidth:s,newDiffWidth:d,newContentHeight:l,newDiffHeight:u}}var Pe=function(i,n,e,r,a,t,o){var s=i>n?e*(o?1:.5):0,l=r>a?t*(o?1:.5):0,d=i-n-s,u=s,f=r-a-l,p=l;return{minPositionX:d,maxPositionX:u,minPositionY:f,maxPositionY:p}},ui=function(i,n){var e=i.wrapperComponent,r=i.contentComponent,a=i.setup.centerZoomedOut;if(!e||!r)throw new Error("Components are not mounted");var t=be(e,r,n),o=t.wrapperWidth,s=t.wrapperHeight,l=t.newContentWidth,d=t.newDiffWidth,u=t.newContentHeight,f=t.newDiffHeight,p=Pe(o,l,d,s,u,f,!!a);return p},ti=function(i,n,e,r){return r?i<n?D(n,2):i>e?D(e,2):D(i,2):D(i,2)},F=function(i,n){var e=ui(i,n);return i.bounds=e,e};function Q(i,n,e,r,a,t,o){var s=e.minPositionX,l=e.minPositionY,d=e.maxPositionX,u=e.maxPositionY,f=0,p=0;o&&(f=a,p=t);var v=ti(i,s-f,d+f,r),m=ti(n,l-p,u+p,r);return{x:v,y:m}}function G(i,n,e,r,a,t){var o=i.transformState,s=o.scale,l=o.positionX,d=o.positionY,u=r-s;if(typeof n!="number"||typeof e!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:d};var f=l-n*u,p=d-e*u,v=Q(f,p,a,t,0,0,null);return v}function R(i,n,e,r,a){var t=a?r:0,o=n-t;return!Number.isNaN(e)&&i>=e?e:!Number.isNaN(n)&&i<=o?o:i}var bi=function(i,n){var e=i.setup.panning.excluded,r=i.isInitialized,a=i.wrapperComponent,t=n.target,o="shadowRoot"in t&&"composedPath"in n,s=o?n.composedPath().some(function(u){return u instanceof Element?a==null?void 0:a.contains(u):!1}):a==null?void 0:a.contains(t),l=r&&t&&s;if(!l)return!1;var d=J(t,e);return!d},Pi=function(i){var n=i.isInitialized,e=i.isPanning,r=i.setup,a=r.panning.disabled,t=n&&e&&!a;return!!t},Ce=function(i,n){var e=i.transformState,r=e.positionX,a=e.positionY;i.isPanning=!0;var t=n.clientX,o=n.clientY;i.startCoords={x:t-r,y:o-a}},Ye=function(i,n){var e=n.touches,r=i.transformState,a=r.positionX,t=r.positionY;i.isPanning=!0;var o=e.length===1;if(o){var s=e[0].clientX,l=e[0].clientY;i.startCoords={x:s-a,y:l-t}}};function Te(i){var n=i.transformState,e=n.positionX,r=n.positionY,a=n.scale,t=i.setup,o=t.disabled,s=t.limitToBounds,l=t.centerZoomedOut,d=i.wrapperComponent;if(!(o||!d||!i.bounds)){var u=i.bounds,f=u.maxPositionX,p=u.minPositionX,v=u.maxPositionY,m=u.minPositionY,c=e>f||e<p,S=r>v||r<m,C=e>f?d.offsetWidth:i.setup.minPositionX||0,Y=r>v?d.offsetHeight:i.setup.minPositionY||0,h=G(i,C,Y,a,i.bounds,s||l),z=h.x,P=h.y;return{scale:a,positionX:c?z:e,positionY:S?P:r}}}function ji(i,n,e,r,a){var t=i.setup.limitToBounds,o=i.wrapperComponent,s=i.bounds,l=i.transformState,d=l.scale,u=l.positionX,f=l.positionY;if(!(o===null||s===null||n===u&&e===f)){var p=Q(n,e,s,t,r,a,o),v=p.x,m=p.y;i.setTransformState(d,v,m)}}var Xe=function(i,n,e){var r=i.startCoords,a=i.transformState,t=i.setup.panning,o=t.lockAxisX,s=t.lockAxisY,l=a.positionX,d=a.positionY;if(!r)return{x:l,y:d};var u=n-r.x,f=e-r.y,p=o?l:u,v=s?d:f;return{x:p,y:v}},Z=function(i,n){var e=i.setup,r=i.transformState,a=r.scale,t=e.minScale,o=e.disablePadding;return n>0&&a>=t&&!o?n:0},Ae=function(i){var n=i.mounted,e=i.setup,r=e.disabled,a=e.velocityAnimation,t=i.transformState.scale,o=a.disabled,s=!o||t>1||!r||n;return!!s},ze=function(i){var n=i.mounted,e=i.velocity,r=i.bounds,a=i.setup,t=a.disabled,o=a.velocityAnimation,s=i.transformState.scale,l=o.disabled,d=!l||s>1||!t||n;return!(!d||!e||!r)};function Ee(i,n){var e=i.setup.velocityAnimation,r=e.equalToMove,a=e.animationTime,t=e.sensitivity;return r?a*n*t:a}function Ci(i,n,e,r,a,t,o,s,l,d){if(a){if(n>o&&e>o){var u=o+(i-o)*d;return u>l?l:u<o?o:u}if(n<t&&e<t){var u=t+(i-t)*d;return u<s?s:u>t?t:u}}return r?n:ti(i,t,o,a)}function _e(i,n){var e=1;return n?Math.min(e,i.offsetWidth/window.innerWidth):e}function We(i,n){var e=Ae(i);if(e){var r=i.lastMousePosition,a=i.velocityTime,t=i.setup,o=i.wrapperComponent,s=t.velocityAnimation.equalToMove,l=Date.now();if(r&&a&&o){var d=_e(o,s),u=n.x-r.x,f=n.y-r.y,p=u/d,v=f/d,m=l-a,c=u*u+f*f,S=Math.sqrt(c)/m;i.velocity={velocityX:p,velocityY:v,total:S}}i.lastMousePosition=n,i.velocityTime=l}}function De(i){var n=i.velocity,e=i.bounds,r=i.setup,a=i.wrapperComponent,t=ze(i);if(!(!t||!n||!e||!a)){var o=n.velocityX,s=n.velocityY,l=n.total,d=e.maxPositionX,u=e.minPositionX,f=e.maxPositionY,p=e.minPositionY,v=r.limitToBounds,m=r.alignmentAnimation,c=r.zoomAnimation,S=r.panning,C=S.lockAxisY,Y=S.lockAxisX,h=c.animationType,z=m.sizeX,P=m.sizeY,X=m.velocityAlignmentTime,T=X,A=Ee(i,l),_=Math.max(A,T),O=Z(i,z),B=Z(i,P),N=O*a.offsetWidth/100,H=B*a.offsetHeight/100,w=d+N,E=u-N,K=f+H,I=p-H,vi=i.transformState,qi=new Date().getTime();Ni(i,h,_,function($i){var ii=i.transformState,Ui=ii.scale,ei=ii.positionX,ri=ii.positionY,Gi=new Date().getTime()-qi,Ji=Gi/T,Ii=ki[m.animationType],mi=1-Ii(Math.min(1,Ji)),ci=1-$i,hi=ei+o*ci,gi=ri+s*ci,ie=Ci(hi,vi.positionX,ei,Y,v,u,d,E,w,mi),ee=Ci(gi,vi.positionY,ri,C,v,p,f,I,K,mi);(ei!==hi||ri!==gi)&&i.setTransformState(Ui,ie,ee)})}}function Yi(i,n){var e=i.transformState.scale;k(i),F(i,e),window.TouchEvent!==void 0&&n instanceof TouchEvent?Ye(i,n):Ce(i,n)}function di(i,n){var e=i.transformState.scale,r=i.setup,a=r.minScale,t=r.alignmentAnimation,o=t.disabled,s=t.sizeX,l=t.sizeY,d=t.animationTime,u=t.animationType,f=o||e<a||!s&&!l;if(!f){var p=Te(i);p&&x(i,p,n??d,u)}}function Ti(i,n,e){var r=i.startCoords,a=i.setup,t=a.alignmentAnimation,o=t.sizeX,s=t.sizeY;if(r){var l=Xe(i,n,e),d=l.x,u=l.y,f=Z(i,o),p=Z(i,s);We(i,{x:d,y:u}),ji(i,d,u,f,p)}}function Oe(i){if(i.isPanning){var n=i.setup.panning.velocityDisabled,e=i.velocity,r=i.wrapperComponent,a=i.contentComponent;i.isPanning=!1,i.animate=!1,i.animation=null;var t=r==null?void 0:r.getBoundingClientRect(),o=a==null?void 0:a.getBoundingClientRect(),s=(t==null?void 0:t.width)||0,l=(t==null?void 0:t.height)||0,d=(o==null?void 0:o.width)||0,u=(o==null?void 0:o.height)||0,f=s<d||l<u,p=!n&&e&&(e==null?void 0:e.total)>.1&&f;p?De(i):di(i)}}function fi(i,n,e,r){var a=i.setup,t=a.minScale,o=a.maxScale,s=a.limitToBounds,l=R(D(n,2),t,o,0,!1),d=F(i,l),u=G(i,e,r,l,d,s),f=u.x,p=u.y;return{scale:l,positionX:f,positionY:p}}function Mi(i,n,e){var r=i.transformState.scale,a=i.wrapperComponent,t=i.setup,o=t.minScale,s=t.limitToBounds,l=t.zoomAnimation,d=l.disabled,u=l.animationTime,f=l.animationType,p=d||r>=o;if((r>=1||s)&&di(i),!(p||!a||!i.mounted)){var v=n||a.offsetWidth/2,m=e||a.offsetHeight/2,c=fi(i,o,v,m);c&&x(i,c,u,f)}}var j=function(){return j=Object.assign||function(n){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}return n},j.apply(this,arguments)};function Xi(i,n,e){if(e||arguments.length===2)for(var r=0,a=n.length,t;r<a;r++)(t||!(r in n))&&(t||(t=Array.prototype.slice.call(n,0,r)),t[r]=n[r]);return i.concat(t||Array.prototype.slice.call(n))}var q={previousScale:1,scale:1,positionX:0,positionY:0},V={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},oi={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Zi=function(i){var n,e,r,a;return{previousScale:(n=i.initialScale)!==null&&n!==void 0?n:q.scale,scale:(e=i.initialScale)!==null&&e!==void 0?e:q.scale,positionX:(r=i.initialPositionX)!==null&&r!==void 0?r:q.positionX,positionY:(a=i.initialPositionY)!==null&&a!==void 0?a:q.positionY}},Ai=function(i){var n=j({},V);return Object.keys(i).forEach(function(e){var r=typeof i[e]<"u",a=typeof V[e]<"u";if(a&&r){var t=Object.prototype.toString.call(V[e]),o=t==="[object Object]",s=t==="[object Array]";o?n[e]=j(j({},V[e]),i[e]):s?n[e]=Xi(Xi([],V[e],!0),i[e],!0):n[e]=i[e]}}),n},Li=function(i,n,e){var r=i.transformState.scale,a=i.wrapperComponent,t=i.setup,o=t.maxScale,s=t.minScale,l=t.zoomAnimation,d=t.smooth,u=l.size;if(!a)throw new Error("Wrapper is not mounted");var f=d?r*Math.exp(n*e):r+n*e,p=R(D(f,3),s,o,u,!1);return p};function xi(i,n,e,r,a){var t=i.wrapperComponent,o=i.transformState,s=o.scale,l=o.positionX,d=o.positionY;if(!t)return console.error("No WrapperComponent found");var u=t.offsetWidth,f=t.offsetHeight,p=(u/2-l)/s,v=(f/2-d)/s,m=Li(i,n,e),c=fi(i,m,p,v);if(!c)return console.error("Error during zoom event. New transformation state was not calculated.");x(i,c,r,a)}function Hi(i,n,e,r){var a=i.setup,t=i.wrapperComponent,o=a.limitToBounds,s=Zi(i.props),l=i.transformState,d=l.scale,u=l.positionX,f=l.positionY;if(t){var p=ui(i,s.scale),v=Q(s.positionX,s.positionY,p,o,0,0,t),m={scale:s.scale,positionX:v.x,positionY:v.y};d===s.scale&&u===s.positionX&&f===s.positionY||(r==null||r(),x(i,m,n,e))}}function ke(i,n,e,r){var a=i.getBoundingClientRect(),t=n.getBoundingClientRect(),o=e.getBoundingClientRect(),s=t.x*r.scale,l=t.y*r.scale;return{x:(a.x-o.x+s)/r.scale,y:(a.y-o.y+l)/r.scale}}function Be(i,n,e){var r=i.wrapperComponent,a=i.contentComponent,t=i.transformState,o=i.setup,s=o.limitToBounds,l=o.minScale,d=o.maxScale;if(!r||!a)return t;var u=r.getBoundingClientRect(),f=n.getBoundingClientRect(),p=ke(n,r,a,t),v=p.x,m=p.y,c=f.width/t.scale,S=f.height/t.scale,C=r.offsetWidth/c,Y=r.offsetHeight/S,h=R(e||Math.min(C,Y),l,d,0,!1),z=(u.width-c*h)/2,P=(u.height-S*h)/2,X=(u.left-v)*h+z,T=(u.top-m)*h+P,A=ui(i,h),_=Q(X,T,A,s,0,0,r),O=_.x,B=_.y;return{positionX:O,positionY:B,scale:h}}var Ne=function(i){return function(n,e,r){n===void 0&&(n=.5),e===void 0&&(e=300),r===void 0&&(r="easeOut"),xi(i,1,n,e,r)}},je=function(i){return function(n,e,r){n===void 0&&(n=.5),e===void 0&&(e=300),r===void 0&&(r="easeOut"),xi(i,-1,n,e,r)}},Me=function(i){return function(n,e,r,a,t){a===void 0&&(a=300),t===void 0&&(t="easeOut");var o=i.transformState,s=o.positionX,l=o.positionY,d=o.scale,u=i.wrapperComponent,f=i.contentComponent,p=i.setup.disabled;if(!(p||!u||!f)){var v={positionX:Number.isNaN(n)?s:n,positionY:Number.isNaN(e)?l:e,scale:Number.isNaN(r)?d:r};x(i,v,a,t)}}},Ze=function(i){return function(n,e){n===void 0&&(n=200),e===void 0&&(e="easeOut"),Hi(i,n,e)}},Le=function(i){return function(n,e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut");var a=i.transformState,t=i.wrapperComponent,o=i.contentComponent;if(t&&o){var s=Fi(n||a.scale,t,o);x(i,s,e,r)}}},xe=function(i){return function(n,e,r,a){r===void 0&&(r=600),a===void 0&&(a="easeOut"),k(i);var t=i.wrapperComponent,o=typeof n=="string"?document.getElementById(n):n;if(t&&o&&t.contains(o)){var s=Be(i,o,e);x(i,s,r,a)}}},si=function(i){return{instance:i,zoomIn:Ne(i),zoomOut:je(i),setTransform:Me(i),resetTransform:Ze(i),centerView:Le(i),zoomToElement:xe(i)}},He=function(i){return{instance:i,state:i.transformState}},y=function(i){var n={};return Object.assign(n,He(i)),Object.assign(n,si(i)),n},ni=!1;function ai(){try{var i={get passive(){return ni=!0,!1}};return i}catch{return ni=!1,ni}}var $=".".concat(oi.wrapperClass),J=function(i,n){return n.some(function(e){return i.matches("".concat($," ").concat(e,", ").concat($," .").concat(e,", ").concat($," ").concat(e," *, ").concat($," .").concat(e," *"))})},li=function(i){i&&clearTimeout(i)},Fe=function(i,n,e){return"translate(".concat(i,"px, ").concat(n,"px) scale(").concat(e,")")},Fi=function(i,n,e){var r=e.offsetWidth*i,a=e.offsetHeight*i,t=(n.offsetWidth-r)/2,o=(n.offsetHeight-a)/2;return{scale:i,positionX:t,positionY:o}};function Ke(i){return function(n){i.forEach(function(e){typeof e=="function"?e(n):e!=null&&(e.current=n)})}}var Ve=function(i,n){var e=i.setup.wheel,r=e.disabled,a=e.wheelDisabled,t=e.touchPadDisabled,o=e.excluded,s=i.isInitialized,l=i.isPanning,d=n.target,u=s&&!l&&!r&&d;if(!u||a&&!n.ctrlKey||t&&n.ctrlKey)return!1;var f=J(d,o);return!f},Qe=function(i){return i?i.deltaY<0?1:-1:0};function Re(i,n){var e=Qe(i),r=te(n,e);return r}function Ki(i,n,e){var r=n.getBoundingClientRect(),a=0,t=0;if("clientX"in i)a=(i.clientX-r.left)/e,t=(i.clientY-r.top)/e;else{var o=i.touches[0];a=(o.clientX-r.left)/e,t=(o.clientY-r.top)/e}return(Number.isNaN(a)||Number.isNaN(t))&&console.error("No mouse or touch offset found"),{x:a,y:t}}var qe=function(i,n,e,r,a){var t=i.transformState.scale,o=i.wrapperComponent,s=i.setup,l=s.maxScale,d=s.minScale,u=s.zoomAnimation,f=s.disablePadding,p=u.size,v=u.disabled;if(!o)throw new Error("Wrapper is not mounted");var m=t+n*e;if(a)return m;var c=r?!1:!v,S=R(D(m,3),d,l,p,c&&!f);return S},$e=function(i,n){var e=i.previousWheelEvent,r=i.transformState.scale,a=i.setup,t=a.maxScale,o=a.minScale;return e?r<t||r>o||Math.sign(e.deltaY)!==Math.sign(n.deltaY)||e.deltaY>0&&e.deltaY<n.deltaY||e.deltaY<0&&e.deltaY>n.deltaY||Math.sign(e.deltaY)!==Math.sign(n.deltaY):!1},Ue=function(i,n){var e=i.setup.pinch,r=e.disabled,a=e.excluded,t=i.isInitialized,o=n.target,s=t&&!r&&o;if(!s)return!1;var l=J(o,a);return!l},Ge=function(i){var n=i.setup.pinch.disabled,e=i.isInitialized,r=i.pinchStartDistance,a=e&&!n&&r;return!!a},Je=function(i,n,e){var r=e.getBoundingClientRect(),a=i.touches,t=D(a[0].clientX-r.left,5),o=D(a[0].clientY-r.top,5),s=D(a[1].clientX-r.left,5),l=D(a[1].clientY-r.top,5);return{x:(t+s)/2/n,y:(o+l)/2/n}},Vi=function(i){return Math.sqrt(Math.pow(i.touches[0].pageX-i.touches[1].pageX,2)+Math.pow(i.touches[0].pageY-i.touches[1].pageY,2))},Ie=function(i,n){var e=i.pinchStartScale,r=i.pinchStartDistance,a=i.setup,t=a.maxScale,o=a.minScale,s=a.zoomAnimation,l=a.disablePadding,d=s.size,u=s.disabled;if(!e||r===null||!n)throw new Error("Pinch touches distance was not provided");if(n<0)return i.transformState.scale;var f=n/r,p=f*e;return R(D(p,2),o,t,d,!u&&!l)},ir=160,er=100,rr=function(i,n){var e=i.props,r=e.onWheelStart,a=e.onZoomStart;i.wheelStopEventTimer||(k(i),b(y(i),n,r),b(y(i),n,a))},nr=function(i,n){var e=i.props,r=e.onWheel,a=e.onZoom,t=i.contentComponent,o=i.setup,s=i.transformState,l=s.scale,d=o.limitToBounds,u=o.centerZoomedOut,f=o.zoomAnimation,p=o.wheel,v=o.disablePadding,m=o.smooth,c=f.size,S=f.disabled,C=p.step,Y=p.smoothStep;if(!t)throw new Error("Component not mounted");n.preventDefault(),n.stopPropagation();var h=Re(n,null),z=m?Y*Math.abs(n.deltaY):C,P=qe(i,h,z,!n.ctrlKey);if(l!==P){var X=F(i,P),T=Ki(n,t,l),A=S||c===0||u||v,_=d&&A,O=G(i,T.x,T.y,P,X,_),B=O.x,N=O.y;i.previousWheelEvent=n,i.setTransformState(P,B,N),b(y(i),n,r),b(y(i),n,a)}},ar=function(i,n){var e=i.props,r=e.onWheelStop,a=e.onZoomStop;li(i.wheelAnimationTimer),i.wheelAnimationTimer=setTimeout(function(){i.mounted&&(Mi(i,n.x,n.y),i.wheelAnimationTimer=null)},er);var t=$e(i,n);t&&(li(i.wheelStopEventTimer),i.wheelStopEventTimer=setTimeout(function(){i.mounted&&(i.wheelStopEventTimer=null,b(y(i),n,r),b(y(i),n,a))},ir))},Qi=function(i){for(var n=0,e=0,r=0;r<2;r+=1)n+=i.touches[r].clientX,e+=i.touches[r].clientY;var a=n/2,t=e/2;return{x:a,y:t}},tr=function(i,n){var e=Vi(n);i.pinchStartDistance=e,i.lastDistance=e,i.pinchStartScale=i.transformState.scale,i.isPanning=!1;var r=Qi(n);i.pinchLastCenterX=r.x,i.pinchLastCenterY=r.y,k(i)},or=function(i,n){var e=i.contentComponent,r=i.pinchStartDistance,a=i.wrapperComponent,t=i.transformState.scale,o=i.setup,s=o.limitToBounds,l=o.centerZoomedOut,d=o.zoomAnimation,u=o.alignmentAnimation,f=d.disabled,p=d.size;if(!(r===null||!e)){var v=Je(n,t,e);if(!(!Number.isFinite(v.x)||!Number.isFinite(v.y))){var m=Vi(n),c=Ie(i,m),S=Qi(n),C=S.x-(i.pinchLastCenterX||0),Y=S.y-(i.pinchLastCenterY||0);if(!(c===t&&C===0&&Y===0)){i.pinchLastCenterX=S.x,i.pinchLastCenterY=S.y;var h=F(i,c),z=f||p===0||l,P=s&&z,X=G(i,v.x,v.y,c,h,P),T=X.x,A=X.y;i.pinchMidpoint=v,i.lastDistance=m;var _=u.sizeX,O=u.sizeY,B=Z(i,_),N=Z(i,O),H=T+C,w=A+Y,E=Q(H,w,h,s,B,N,a),K=E.x,I=E.y;i.setTransformState(c,K,I)}}}},sr=function(i){var n=i.pinchMidpoint;i.velocity=null,i.lastDistance=null,i.pinchMidpoint=null,i.pinchStartScale=null,i.pinchStartDistance=null,Mi(i,n==null?void 0:n.x,n==null?void 0:n.y)},Ri=function(i,n){var e=i.props.onZoomStop,r=i.setup.doubleClick.animationTime;li(i.doubleClickStopEventTimer),i.doubleClickStopEventTimer=setTimeout(function(){i.doubleClickStopEventTimer=null,b(y(i),n,e)},r)},lr=function(i,n){var e=i.props,r=e.onZoomStart,a=e.onZoom,t=i.setup.doubleClick,o=t.animationTime,s=t.animationType;b(y(i),n,r),Hi(i,o,s,function(){return b(y(i),n,a)}),Ri(i,n)};function ur(i,n){return i==="toggle"?n===1?1:-1:i==="zoomOut"?-1:1}function dr(i,n){var e=i.setup,r=i.doubleClickStopEventTimer,a=i.transformState,t=i.contentComponent,o=a.scale,s=i.props,l=s.onZoomStart,d=s.onZoom,u=e.doubleClick,f=u.disabled,p=u.mode,v=u.step,m=u.animationTime,c=u.animationType;if(!f&&!r){if(p==="reset")return lr(i,n);if(!t)return console.error("No ContentComponent found");var S=ur(p,i.transformState.scale),C=Li(i,S,v);if(o!==C){b(y(i),n,l);var Y=Ki(n,t,o),h=fi(i,C,Y.x,Y.y);if(!h)return console.error("Error during zoom event. New transformation state was not calculated.");b(y(i),n,d),x(i,h,m,c),Ri(i,n)}}}var fr=function(i,n){var e=i.isInitialized,r=i.setup,a=i.wrapperComponent,t=r.doubleClick,o=t.disabled,s=t.excluded,l=n.target,d=a==null?void 0:a.contains(l),u=e&&l&&d&&!o;if(!u)return!1;var f=J(l,s);return!f},pr=function(){function i(n){var e=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){e.initializeWindowEvents()},this.unmount=function(){e.cleanupWindowEvents()},this.update=function(r){e.props=r,F(e,e.transformState.scale),e.setup=Ai(r)},this.initializeWindowEvents=function(){var r,a,t=ai(),o=(r=e.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,s=o==null?void 0:o.defaultView;(a=e.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",e.onWheelPanning,t),s==null||s.addEventListener("mousedown",e.onPanningStart,t),s==null||s.addEventListener("mousemove",e.onPanning,t),s==null||s.addEventListener("mouseup",e.onPanningStop,t),o==null||o.addEventListener("mouseleave",e.clearPanning,t),s==null||s.addEventListener("keyup",e.setKeyUnPressed,t),s==null||s.addEventListener("keydown",e.setKeyPressed,t)},this.cleanupWindowEvents=function(){var r,a,t=ai(),o=(r=e.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,s=o==null?void 0:o.defaultView;s==null||s.removeEventListener("mousedown",e.onPanningStart,t),s==null||s.removeEventListener("mousemove",e.onPanning,t),s==null||s.removeEventListener("mouseup",e.onPanningStop,t),o==null||o.removeEventListener("mouseleave",e.clearPanning,t),s==null||s.removeEventListener("keyup",e.setKeyUnPressed,t),s==null||s.removeEventListener("keydown",e.setKeyPressed,t),document.removeEventListener("mouseleave",e.clearPanning,t),k(e),(a=e.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(r){var a=ai();r.addEventListener("wheel",e.onWheelZoom,a),r.addEventListener("dblclick",e.onDoubleClick,a),r.addEventListener("touchstart",e.onTouchPanningStart,a),r.addEventListener("touchmove",e.onTouchPanning,a),r.addEventListener("touchend",e.onTouchPanningStop,a)},this.handleInitialize=function(r,a){var t=!1,o=e.setup.centerOnInit,s=function(l,d){for(var u=0,f=l;u<f.length;u++){var p=f[u];if(p.target===d)return!0}return!1};e.applyTransformation(),e.onInitCallbacks.forEach(function(l){l(y(e))}),e.observer=new ResizeObserver(function(l){if(s(l,r)||s(l,a))if(o&&!t){var d=a.offsetWidth,u=a.offsetHeight;(d>0||u>0)&&(t=!0,e.setCenter())}else k(e),F(e,e.transformState.scale),di(e,0)}),e.observer.observe(r),e.observer.observe(a)},this.onWheelZoom=function(r){var a=e.setup.disabled;if(!a){var t=Ve(e,r);if(t){var o=e.isPressingKeys(e.setup.wheel.activationKeys);o&&(rr(e,r),nr(e,r),ar(e,r))}}},this.onWheelPanning=function(r){var a=e.setup,t=a.disabled,o=a.wheel,s=a.panning;if(!(!e.wrapperComponent||!e.contentComponent||t||!o.wheelDisabled||s.disabled||!s.wheelPanning||r.ctrlKey)){r.preventDefault(),r.stopPropagation();var l=e.transformState,d=l.positionX,u=l.positionY,f=d-r.deltaX,p=u-r.deltaY,v=s.lockAxisX?d:f,m=s.lockAxisY?u:p,c=e.setup.alignmentAnimation,S=c.sizeX,C=c.sizeY,Y=Z(e,S),h=Z(e,C);v===d&&m===u||ji(e,v,m,Y,h)}},this.onPanningStart=function(r){var a=e.setup.disabled,t=e.props.onPanningStart;if(!a){var o=bi(e,r);if(o){var s=e.isPressingKeys(e.setup.panning.activationKeys);s&&(r.button===0&&!e.setup.panning.allowLeftClickPan||r.button===1&&!e.setup.panning.allowMiddleClickPan||r.button===2&&!e.setup.panning.allowRightClickPan||(r.preventDefault(),r.stopPropagation(),k(e),Yi(e,r),b(y(e),r,t)))}}},this.onPanning=function(r){var a=e.setup.disabled,t=e.props.onPanning;if(!a){var o=Pi(e);if(o){var s=e.isPressingKeys(e.setup.panning.activationKeys);s&&(r.preventDefault(),r.stopPropagation(),Ti(e,r.clientX,r.clientY),b(y(e),r,t))}}},this.onPanningStop=function(r){var a=e.props.onPanningStop;e.isPanning&&(Oe(e),b(y(e),r,a))},this.onPinchStart=function(r){var a=e.setup.disabled,t=e.props,o=t.onPinchingStart,s=t.onZoomStart;if(!a){var l=Ue(e,r);l&&(tr(e,r),k(e),b(y(e),r,o),b(y(e),r,s))}},this.onPinch=function(r){var a=e.setup.disabled,t=e.props,o=t.onPinching,s=t.onZoom;if(!a){var l=Ge(e);l&&(r.preventDefault(),r.stopPropagation(),or(e,r),b(y(e),r,o),b(y(e),r,s))}},this.onPinchStop=function(r){var a=e.props,t=a.onPinchingStop,o=a.onZoomStop;e.pinchStartScale&&(sr(e),b(y(e),r,t),b(y(e),r,o))},this.onTouchPanningStart=function(r){var a=e.setup.disabled,t=e.props.onPanningStart;if(!a){var o=bi(e,r);if(o){var s=e.lastTouch&&+new Date-e.lastTouch<200&&r.touches.length===1;if(!s){e.lastTouch=+new Date,k(e);var l=r.touches,d=l.length===1,u=l.length===2;d&&(k(e),Yi(e,r),b(y(e),r,t)),u&&e.onPinchStart(r)}}}},this.onTouchPanning=function(r){var a=e.setup.disabled,t=e.props.onPanning;if(e.isPanning&&r.touches.length===1){if(a)return;var o=Pi(e);if(!o)return;r.preventDefault(),r.stopPropagation();var s=r.touches[0];Ti(e,s.clientX,s.clientY),b(y(e),r,t)}else r.touches.length>1&&e.onPinch(r)},this.onTouchPanningStop=function(r){e.onPanningStop(r),e.onPinchStop(r)},this.onDoubleClick=function(r){var a=e.setup.disabled;if(!a){var t=fr(e,r);t&&dr(e,r)}},this.clearPanning=function(r){e.isPanning&&e.onPanningStop(r)},this.setKeyPressed=function(r){e.pressedKeys[r.key]=!0},this.setKeyUnPressed=function(r){e.pressedKeys[r.key]=!1},this.isPressingKeys=function(r){return r.length?!!r.find(function(a){return e.pressedKeys[a]}):!0},this.setTransformState=function(r,a,t){var o=e.props.onTransformed;if(!Number.isNaN(r)&&!Number.isNaN(a)&&!Number.isNaN(t)){r!==e.transformState.scale&&(e.transformState.previousScale=e.transformState.scale,e.transformState.scale=r),e.transformState.positionX=a,e.transformState.positionY=t,e.applyTransformation();var s=y(e);e.onChangeCallbacks.forEach(function(l){return l(s)}),b(s,{scale:r,positionX:a,positionY:t},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(e.wrapperComponent&&e.contentComponent){var r=Fi(e.transformState.scale,e.wrapperComponent,e.contentComponent);e.setTransformState(r.scale,r.positionX,r.positionY)}},this.handleTransformStyles=function(r,a,t){return e.props.customTransform?e.props.customTransform(r,a,t):Fe(r,a,t)},this.applyTransformation=function(){if(!(!e.mounted||!e.contentComponent)){var r=e.transformState,a=r.scale,t=r.positionX,o=r.positionY,s=e.handleTransformStyles(t,o,a);e.contentComponent.style.transform=s}},this.getContext=function(){return y(e)},this.onChange=function(r){return e.onChangeCallbacks.has(r)||e.onChangeCallbacks.add(r),function(){e.onChangeCallbacks.delete(r)}},this.onInit=function(r){return e.onInitCallbacks.has(r)||e.onInitCallbacks.add(r),function(){e.onInitCallbacks.delete(r)}},this.init=function(r,a){e.cleanupWindowEvents(),e.wrapperComponent=r,e.contentComponent=a,F(e,e.transformState.scale),e.handleInitializeWrapperEvents(r),e.handleInitialize(r,a),e.initializeWindowEvents(),e.isInitialized=!0;var t=y(e);b(t,void 0,e.props.onInit)},this.props=n,this.setup=Ai(this.props),this.transformState=Zi(this.props)}return i}(),pi=M.createContext(null),vr=function(i,n){return typeof i=="function"?i(n):i},mr=M.forwardRef(function(i,n){var e=W.useRef(new pr(i)).current,r=vr(i.children,si(e));return W.useImperativeHandle(n,function(){return si(e)},[e]),W.useEffect(function(){e.update(i)},[e,i]),M.createElement(pi.Provider,{value:e},r)});M.forwardRef(function(i,n){var e=W.useRef(null),r=W.useContext(pi);return W.useEffect(function(){return r.onChange(function(a){if(e.current){var t=0,o=0;e.current.style.transform=r.handleTransformStyles(t,o,1/a.instance.transformState.scale)}})},[r]),M.createElement("div",j({},i,{ref:Ke([e,n])}))});function cr(i,n){n===void 0&&(n={});var e=n.insertAt;if(!(!i||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",e==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=i:a.appendChild(document.createTextNode(i))}}var hr=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,zi={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};cr(hr);var gr=function(i){var n=i.children,e=i.wrapperClass,r=e===void 0?"":e,a=i.contentClass,t=a===void 0?"":a,o=i.wrapperStyle,s=i.contentStyle,l=i.wrapperProps,d=l===void 0?{}:l,u=i.contentProps,f=u===void 0?{}:u,p=W.useContext(pi),v=p.init,m=p.cleanupWindowEvents,c=W.useRef(null),S=W.useRef(null);return W.useEffect(function(){var C=c.current,Y=S.current;return C!==null&&Y!==null&&v&&(v==null||v(C,Y)),function(){m==null||m()}},[]),M.createElement("div",j({},d,{ref:c,className:"".concat(oi.wrapperClass," ").concat(zi.wrapper," ").concat(r),style:o}),M.createElement("div",j({},f,{ref:S,className:"".concat(oi.contentClass," ").concat(zi.content," ").concat(t),style:s}),n))};const wr=L("div",{d:"flex",w:"100%",px:"10px",".react-transform-wrapper":{maxH:"calc(100vh - 250px)"},"@sm":{".react-transform-wrapper":{maxH:"calc(100vh - 190px)"}},"@media (max-width: 768px) and (max-height: 500px)":{".react-transform-wrapper":{maxH:"calc(100vh)"}}}),Sr=L("div",{d:"flex",w:"1920px",h:"1080px",position:"relative",img:{w:"1920px",h:"1080px"}});L("div",{d:"flex",align:"center",flexWrap:"wrap",gap:"20px",mt:"10px",pl:"20px",w:"100%"});L("div",{d:"flex",align:"center",justify:"center",gap:"5px",color:"#fff",ff:"$heading",fs:"10px",svg:{w:"17px",h:"17px"},"&:nth-child(1)":{fill:"#80FF00"},"&:nth-child(2)":{fill:"#EB094D"},"&:nth-child(3)":{fill:"#FFB800"}});const yr=L("button",{position:"absolute",border:"1px solid rgba(0,0,0,0.6)",zIndex:1,w:"calc(100% / 40)",h:"calc(100% / 20)"}),br=L("div",{d:"flex",align:"center",justify:"center",w:"100%",h:"100%",svg:{w:"20px",h:"20px"},variants:{isSelected:{true:{bg:"rgba(0, 186, 255, 0.58)"}},type:{miningEvent:{zIndex:2},portal:{zIndex:2}}}}),Pr=L("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",zIndex:999,img:{w:"35px",h:"35px"},span:{position:"absolute",top:"-8px",left:"50%",transform:"translate(-50%, -50%)",textTransform:"capitalize",padding:"2px 5px",bg:"#333333",color:"#fff",ff:"$heading",fs:"10px",br:"5px"}}),Cr=L("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",zIndex:999,span:{position:"absolute",top:"-8px",left:"50%",transform:"translate(-50%, -50%)",color:"#fff",fw:900,ff:"$heading",fs:"16px",br:"5px","-webkit-text-stroke":"1px #000"}}),Ei=({text:i,type:n})=>{switch(n){case"arena":return g.jsxs("svg",{fill:"rgba(235, 9, 77, 0.67)",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("circle",{cx:"50",cy:"50",r:"50"}),g.jsx("text",{x:"50",y:"75",fontSize:"5em",textAnchor:"middle",style:{fill:"white",stroke:"#000",strokeWidth:5,fontWeight:"bold",fontFamily:"Orbitron, sans-serif"},children:i})]});case"dungeon":return g.jsx("div",{children:g.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("rect",{width:"17.6777",height:"17.6777",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 0 12.5)",fill:"rgba(0, 184, 251, 1)"}),g.jsx("rect",{width:"12.8565",height:"12.8565",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 3.37476 12.5)",fill:"#141423"}),g.jsx("rect",{width:"8.03534",height:"8.03534",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 6.83008 12.5)",fill:"rgba(0, 184, 251, 1)"})]})});case"youControl":return g.jsxs("svg",{fill:"rgba(173, 255, 0, 0.65)",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("circle",{cx:"50",cy:"50",r:"50"}),g.jsx("text",{x:"50",y:"75",fontSize:"5em",textAnchor:"middle",style:{fill:"white",stroke:"#000",strokeWidth:5,fontWeight:"bold",fontFamily:"Orbitron, sans-serif"},children:i})]});case"miningEvent":return g.jsxs(Cr,{children:[g.jsx("span",{children:i}),g.jsxs("svg",{fill:"#FFB800",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 490 490",children:[g.jsx("text",{x:"50",y:"75",fontSize:"5em",textAnchor:"middle",style:{fill:"white",stroke:"#000",strokeWidth:5,fontWeight:"bold",fontFamily:"Orbitron, sans-serif"},children:i}),g.jsx("polygon",{points:"245,456.701 490,33.299 0,33.299 "})]})]});case"portal":return g.jsxs(Pr,{children:[g.jsx("span",{children:i}),g.jsx("img",{loading:"lazy",src:"./assets/maps/portal.webp",alt:"portal"})]});case"flag":return g.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:999,width:"14px",height:"14px"},children:[g.jsx("circle",{cx:"11",cy:"11",r:"11",fill:"#DB4447"}),g.jsx("circle",{cx:"11",cy:"11",r:"9",fill:"#141423"}),g.jsx("circle",{cx:"11",cy:"11",r:"7",fill:"#DB4447"})]});case"tavern":return g.jsx("div",{children:g.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("rect",{width:"17.6777",height:"17.6777",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 0 12.5)",fill:"#FFB800"}),g.jsx("rect",{width:"12.8565",height:"12.8565",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 3.37476 12.5)",fill:"#141423"}),g.jsx("rect",{width:"8.03534",height:"8.03534",transform:"matrix(0.707104 -0.70711 0.707104 0.70711 6.83008 12.5)",fill:"#FFB800"})]})});default:return null}},Yr=({columnIndex:i,rowIndex:n,style:e,onClick:r})=>{const a=U(_i(f=>f.user)),{allAreas:t,selectedMap:o,selectedCoordinates:s}=Wi(),l=`${i},${n}`,d=t[l],u=a.planet===o.value&&a.mapX===i&&a.mapY===n;return g.jsx(yr,{style:e,onClick:r,children:g.jsxs(br,{isSelected:(s==null?void 0:s.x)===i&&(s==null?void 0:s.y)===n,type:(d==null?void 0:d.type)||"empty",children:[!!d&&Ei({text:d.text||"",type:d.type}),u&&Ei({text:"",type:"flag"})]})})},Tr=i=>Oi({queryKey:[Di.playerDataState,i],queryFn:()=>Xr(i),staleTime:1e3*60*20,enabled:!!U.getState().user});async function Xr(i){try{const n=await re(i);return n||null}catch(n){return console.log(n),null}}const Ar=async()=>{const i=await ne({options:{code:wi.playersAle,index_position:1,limit:"1000",scope:wi.playersAle,table:ae.config}});return(i==null?void 0:i[0])||null},zr=()=>Oi({queryKey:[Di.PlayerConfigState],queryFn:()=>Er(),staleTime:1e3*60*60,enabled:!!U.getState().user});async function Er(){try{return await Ar()}catch(i){return console.log(i),null}}const _r=()=>{const i=U(_i(h=>h.user)),{allAreas:n,selectedMap:e,selectedCoordinates:r,setSelectedCoordinates:a,setSelectedTypes:t,setAllAreas:o,setAllTypes:s,setBuildingsOnSelectedLand:l,setMoveCost:d}=Wi(),[u,f]=W.useState([]),[p,v]=W.useState(8),{data:m}=Tr((e==null?void 0:e.value)||""),{data:c}=zr(),S=W.useCallback(()=>{var O,B,N,H;if(!i)return null;const h=((O=m==null?void 0:m.filter(w=>!!w.special_effect))==null?void 0:O.map(w=>({x:w.x-1,y:w.y-1,type:"portal",text:w.special_effect.slice(2,1/0)})))||[],z=((B=[...i.active_taverns,i.last_tavern].filter(w=>w.planet===(e==null?void 0:e.value)))==null?void 0:B.map(w=>({x:w.x-1,y:w.y-1,type:"tavern"})))||[],P=((N=m==null?void 0:m.filter(w=>w.buildings.some(E=>E.building_name==="dungeon")))==null?void 0:N.map(w=>({x:w.x-1,y:w.y-1,type:"dungeon"})))||[],X=[...h,...z,...P],T=X.reduce((w,E)=>(w.some(({value:K})=>K===E.type)||w.push({label:E.type.charAt(0).toUpperCase()+E.type.slice(1),value:E.type}),w),[]),A=(H=(m==null?void 0:m.filter(w=>{var E;return!!((E=w.buildings)!=null&&E.length)}))||[])==null?void 0:H.flatMap(w=>w.buildings);l(A),s(T),t(T);const _={};X==null||X.forEach(w=>{T.some(E=>E.value!=="mixed"?E.value===w.type:!0)&&(_[`${w.x},${w.y}`]=w)}),o(_)},[i,m,e]);W.useEffect(()=>{const P=1920/Si,X=1080/yi,T=[];for(let A=0;A<Si;A++){T[A]=[];for(let _=0;_<yi;_++)T[A][_]={x:A*P,y:_*X,type:""}}f(T),S()},[S]);const C=W.useCallback(h=>{if(!i)return;if((r==null?void 0:r.x)===h.clientX&&(r==null?void 0:r.y)===h.clientY){a(null);return}if(a({x:h.clientX,y:h.clientY,type:h.type}),i.mapX===h.clientX&&i.mapY===h.clientY){d(0);return}const z=Math.sqrt(Math.pow(i.mapX-h.clientX,2)+Math.pow(i.mapY-h.clientY,2));let P=Math.ceil(z)+((c==null?void 0:c.travel_base_cost)||0);h.type==="portal"&&(P+=(c==null?void 0:c.travel_portal_cost)||0),d(P)},[i,r,c]),Y=W.useMemo(()=>u.map((h,z)=>h.map((P,X)=>{const T=`${z},${X}`,A=n[T];return g.jsx(Yr,{columnIndex:z,rowIndex:X,onClick:()=>C({clientX:z,clientY:X,type:(A==null?void 0:A.type)||""}),style:{top:P.y,left:P.x}},T)})),[u,n,C]);return g.jsx(wr,{children:g.jsx(mr,{disablePadding:!0,initialScale:1,maxScale:2,doubleClick:{step:p},onPanningStop:h=>{h.state.scale!==1?v(-8):v(8)},children:g.jsx(gr,{children:g.jsxs(Sr,{children:[g.jsx("img",{loading:"lazy",src:`/assets/maps/${e==null?void 0:e.value}.jpg`,alt:""}),Y]})})})})},kr=M.memo(_r);export{kr as default};
